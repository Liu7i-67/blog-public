{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/file-utils.ts"],"sourcesContent":["'use client'\r\n\r\nexport function readFileAsText(file: File): Promise<string> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst reader = new FileReader()\r\n\t\treader.onload = () => resolve(String(reader.result || ''))\r\n\t\treader.onerror = reject\r\n\t\treader.readAsText(file)\r\n\t})\r\n}\r\n\r\nexport function fileToBase64NoPrefix(file: File): Promise<string> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst reader = new FileReader()\r\n\t\treader.onload = () => {\r\n\t\t\tconst dataUrl = String(reader.result || '')\r\n\t\t\tresolve(dataUrl.replace(/^data:[^;]+;base64,/, ''))\r\n\t\t}\r\n\t\treader.onerror = reject\r\n\t\treader.readAsDataURL(file)\r\n\t})\r\n}\r\n\r\nexport async function hashFileSHA256(file: File): Promise<string> {\r\n\tconst buf = await file.arrayBuffer()\r\n\tconst digest = await crypto.subtle.digest('SHA-256', buf)\r\n\tconst bytes = new Uint8Array(digest)\r\n\tlet hex = ''\r\n\tfor (let i = 0; i < bytes.length; i++) {\r\n\t\tconst h = bytes[i].toString(16).padStart(2, '0')\r\n\t\thex += h\r\n\t}\r\n\treturn hex.slice(0, 16)\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AAEO,SAAS,eAAe,IAAU;IACxC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG,IAAM,QAAQ,OAAO,OAAO,MAAM,IAAI;QACtD,OAAO,OAAO,GAAG;QACjB,OAAO,UAAU,CAAC;IACnB;AACD;AAEO,SAAS,qBAAqB,IAAU;IAC9C,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG;YACf,MAAM,UAAU,OAAO,OAAO,MAAM,IAAI;YACxC,QAAQ,QAAQ,OAAO,CAAC,uBAAuB;QAChD;QACA,OAAO,OAAO,GAAG;QACjB,OAAO,aAAa,CAAC;IACtB;AACD;AAEO,eAAe,eAAe,IAAU;IAC9C,MAAM,MAAM,MAAM,KAAK,WAAW;IAClC,MAAM,SAAS,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,WAAW;IACrD,MAAM,QAAQ,IAAI,WAAW;IAC7B,IAAI,MAAM;IACV,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;QACtC,MAAM,IAAI,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG;QAC5C,OAAO;IACR;IACA,OAAO,IAAI,KAAK,CAAC,GAAG;AACrB","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/load-blog.ts"],"sourcesContent":["export type BlogConfig = {\r\n\ttitle?: string\r\n\ttags?: string[]\r\n\tdate?: string\r\n\tsummary?: string\r\n\tcover?: string\r\n}\r\n\r\nexport type LoadedBlog = {\r\n\tslug: string\r\n\tconfig: BlogConfig\r\n\tmarkdown: string\r\n\tcover?: string\r\n}\r\n\r\n/**\r\n * Load blog data from public/blogs/{slug}\r\n * Used by both view page and edit page\r\n */\r\nexport async function loadBlog(slug: string): Promise<LoadedBlog> {\r\n\tif (!slug) {\r\n\t\tthrow new Error('Slug is required')\r\n\t}\r\n\r\n\t// Load config.json\r\n\tlet config: BlogConfig = {}\r\n\tconst configRes = await fetch(`/blogs/${encodeURIComponent(slug)}/config.json`)\r\n\tif (configRes.ok) {\r\n\t\ttry {\r\n\t\t\tconfig = await configRes.json()\r\n\t\t} catch {\r\n\t\t\tconfig = {}\r\n\t\t}\r\n\t}\r\n\r\n\t// Load index.md\r\n\tconst mdRes = await fetch(`/blogs/${encodeURIComponent(slug)}/index.md`)\r\n\tif (!mdRes.ok) {\r\n\t\tthrow new Error('Blog not found')\r\n\t}\r\n\tconst markdown = await mdRes.text()\r\n\r\n\treturn {\r\n\t\tslug,\r\n\t\tconfig,\r\n\t\tmarkdown,\r\n\t\tcover: config.cover\r\n\t}\r\n}\r\n"],"names":[],"mappings":";;;;AAmBO,eAAe,SAAS,IAAY;IAC1C,IAAI,CAAC,MAAM;QACV,MAAM,IAAI,MAAM;IACjB;IAEA,mBAAmB;IACnB,IAAI,SAAqB,CAAC;IAC1B,MAAM,YAAY,MAAM,MAAM,CAAC,OAAO,EAAE,mBAAmB,MAAM,YAAY,CAAC;IAC9E,IAAI,UAAU,EAAE,EAAE;QACjB,IAAI;YACH,SAAS,MAAM,UAAU,IAAI;QAC9B,EAAE,OAAM;YACP,SAAS,CAAC;QACX;IACD;IAEA,gBAAgB;IAChB,MAAM,QAAQ,MAAM,MAAM,CAAC,OAAO,EAAE,mBAAmB,MAAM,SAAS,CAAC;IACvE,IAAI,CAAC,MAAM,EAAE,EAAE;QACd,MAAM,IAAI,MAAM;IACjB;IACA,MAAM,WAAW,MAAM,MAAM,IAAI;IAEjC,OAAO;QACN;QACA;QACA;QACA,OAAO,OAAO,KAAK;IACpB;AACD","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/app/write/stores/write-store.ts"],"sourcesContent":["import { create } from 'zustand'\r\nimport { toast } from 'sonner'\r\nimport { hashFileSHA256 } from '@/lib/file-utils'\r\nimport { loadBlog } from '@/lib/load-blog'\r\nimport type { PublishForm, ImageItem } from '../types'\r\n\r\ntype WriteStore = {\r\n\t// Mode state\r\n\tmode: 'create' | 'edit'\r\n\toriginalSlug: string | null\r\n\tsetMode: (mode: 'create' | 'edit', originalSlug?: string) => void\r\n\r\n\t// Form state\r\n\tform: PublishForm\r\n\tupdateForm: (updates: Partial<PublishForm>) => void\r\n\tsetForm: (form: PublishForm) => void\r\n\r\n\t// Image state\r\n\timages: ImageItem[]\r\n\taddUrlImage: (url: string) => void\r\n\taddFiles: (files: FileList | File[]) => Promise<ImageItem[]>\r\n\tdeleteImage: (id: string) => void\r\n\r\n\t// Cover state\r\n\tcover: ImageItem | null\r\n\tsetCover: (cover: ImageItem | null) => void\r\n\r\n\t// Publish state\r\n\tloading: boolean\r\n\tsetLoading: (loading: boolean) => void\r\n\r\n\t// Load blog for editing\r\n\tloadBlogForEdit: (slug: string) => Promise<void>\r\n\r\n\t// Reset to create mode\r\n\treset: () => void\r\n}\r\n\r\nconst initialForm: PublishForm = {\r\n\tslug: '',\r\n\ttitle: '',\r\n\tmd: '',\r\n\ttags: [],\r\n\tdate: new Date().toISOString().slice(0, 10),\r\n\tsummary: ''\r\n}\r\n\r\nexport const useWriteStore = create<WriteStore>((set, get) => ({\r\n\t// Mode state\r\n\tmode: 'create',\r\n\toriginalSlug: null,\r\n\tsetMode: (mode, originalSlug) => set({ mode, originalSlug: originalSlug || null }),\r\n\r\n\t// Form state\r\n\tform: { ...initialForm },\r\n\tupdateForm: updates => set(state => ({ form: { ...state.form, ...updates } })),\r\n\tsetForm: form => set({ form }),\r\n\r\n\t// Image state\r\n\timages: [],\r\n\taddUrlImage: url => {\r\n\t\tconst { images } = get()\r\n\t\tconst exists = images.some(it => it.type === 'url' && it.url === url)\r\n\t\tif (exists) {\r\n\t\t\ttoast.info('该图片已在列表中')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst id = Math.random().toString(36).slice(2, 10)\r\n\t\tset(state => ({ images: [{ id, type: 'url', url }, ...state.images] }))\r\n\t},\r\n\taddFiles: async (files: FileList | File[]) => {\r\n\t\tconst { images } = get()\r\n\t\tconst arr = Array.from(files).filter(f => f.type.startsWith('image/'))\r\n\t\tif (arr.length === 0) return []\r\n\r\n\t\tconst existingHashes = new Map<string, ImageItem>(\r\n\t\t\timages\r\n\t\t\t\t.filter((it): it is Extract<ImageItem, { type: 'file'; hash?: string }> => it.type === 'file' && (it as any).hash)\r\n\t\t\t\t.map(it => [(it as any).hash as string, it])\r\n\t\t)\r\n\r\n\t\tconst computed = await Promise.all(\r\n\t\t\tarr.map(async file => {\r\n\t\t\t\tconst hash = await hashFileSHA256(file)\r\n\t\t\t\treturn { file, hash }\r\n\t\t\t})\r\n\t\t)\r\n\r\n\t\tconst seen = new Set<string>()\r\n\t\tconst unique = computed.filter(({ hash }) => {\r\n\t\t\tif (existingHashes.has(hash)) return false\r\n\t\t\tif (seen.has(hash)) return false\r\n\t\t\tseen.add(hash)\r\n\t\t\treturn true\r\n\t\t})\r\n\r\n\t\tconst resultImages: ImageItem[] = []\r\n\r\n\t\t// 处理已存在的图片\r\n\t\tfor (const { hash } of computed) {\r\n\t\t\tif (existingHashes.has(hash)) {\r\n\t\t\t\tresultImages.push(existingHashes.get(hash)!)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 处理新图片\r\n\t\tif (unique.length > 0) {\r\n\t\t\tconst newItems: ImageItem[] = unique.map(({ file, hash }) => {\r\n\t\t\t\tconst id = Math.random().toString(36).slice(2, 10)\r\n\t\t\t\tconst previewUrl = URL.createObjectURL(file)\r\n\t\t\t\tconst filename = file.name\r\n\t\t\t\treturn { id, type: 'file', file, previewUrl, filename, hash }\r\n\t\t\t})\r\n\r\n\t\t\tset(state => ({ images: [...newItems, ...state.images] }))\r\n\t\t\tresultImages.push(...newItems)\r\n\t\t} else if (resultImages.length === 0) {\r\n\t\t\ttoast.info('图片已存在，不重复添加')\r\n\t\t}\r\n\r\n\t\treturn resultImages\r\n\t},\r\n\tdeleteImage: id =>\r\n\t\tset(state => {\r\n\t\t\tfor (const it of state.images) {\r\n\t\t\t\tif (it.type === 'file' && it.id === id) {\r\n\t\t\t\t\tURL.revokeObjectURL(it.previewUrl)\r\n\r\n\t\t\t\t\tif (it.id === state.cover?.id) {\r\n\t\t\t\t\t\tset({ cover: null })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn { images: state.images.filter(it => it.id !== id) }\r\n\t\t}),\r\n\r\n\t// Cover state\r\n\tcover: null,\r\n\tsetCover: cover => set({ cover }),\r\n\r\n\t// Publish state\r\n\tloading: false,\r\n\tsetLoading: loading => set({ loading }),\r\n\r\n\t// Load blog for editing\r\n\tloadBlogForEdit: async (slug: string) => {\r\n\t\ttry {\r\n\t\t\tset({ loading: true })\r\n\t\t\tconst blog = await loadBlog(slug)\r\n\r\n\t\t\t// Parse images from markdown\r\n\t\t\tconst images: ImageItem[] = []\r\n\t\t\tconst imageRegex = /!\\[.*?\\]\\((.*?)\\)/g\r\n\t\t\tlet match\r\n\t\t\twhile ((match = imageRegex.exec(blog.markdown)) !== null) {\r\n\t\t\t\tconst url = match[1]\r\n\t\t\t\t// Skip cover image and only collect content images\r\n\t\t\t\tif (url && url !== blog.cover && !url.startsWith('local-image:')) {\r\n\t\t\t\t\t// Check if already added\r\n\t\t\t\t\tif (!images.some(img => img.type === 'url' && img.url === url)) {\r\n\t\t\t\t\t\tconst id = Math.random().toString(36).slice(2, 10)\r\n\t\t\t\t\t\timages.push({ id, type: 'url', url })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Set cover\r\n\t\t\tlet cover: ImageItem | null = null\r\n\t\t\tif (blog.cover) {\r\n\t\t\t\tconst coverId = Math.random().toString(36).slice(2, 10)\r\n\t\t\t\tcover = { id: coverId, type: 'url', url: blog.cover }\r\n\t\t\t}\r\n\r\n\t\t\t// Set form\r\n\t\t\tset({\r\n\t\t\t\tmode: 'edit',\r\n\t\t\t\toriginalSlug: slug,\r\n\t\t\t\tform: {\r\n\t\t\t\t\tslug,\r\n\t\t\t\t\ttitle: blog.config.title || '',\r\n\t\t\t\t\tmd: blog.markdown,\r\n\t\t\t\t\ttags: blog.config.tags || [],\r\n\t\t\t\t\tdate: blog.config.date || new Date().toISOString().slice(0, 10),\r\n\t\t\t\t\tsummary: blog.config.summary || ''\r\n\t\t\t\t},\r\n\t\t\t\timages,\r\n\t\t\t\tcover,\r\n\t\t\t\tloading: false\r\n\t\t\t})\r\n\r\n\t\t\ttoast.success('博客加载成功')\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error('Failed to load blog:', err)\r\n\t\t\ttoast.error(err?.message || '加载博客失败')\r\n\t\t\tset({ loading: false })\r\n\t\t\tthrow err\r\n\t\t}\r\n\t},\r\n\r\n\t// Reset to create mode\r\n\treset: () => {\r\n\t\t// Revoke object URLs\r\n\t\tconst { images, cover } = get()\r\n\t\tfor (const img of images) {\r\n\t\t\tif (img.type === 'file') {\r\n\t\t\t\tURL.revokeObjectURL(img.previewUrl)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (cover?.type === 'file') {\r\n\t\t\tURL.revokeObjectURL(cover.previewUrl)\r\n\t\t}\r\n\r\n\t\tset({\r\n\t\t\tmode: 'create',\r\n\t\t\toriginalSlug: null,\r\n\t\t\tform: { ...initialForm, date: new Date().toISOString().slice(0, 10) },\r\n\t\t\timages: [],\r\n\t\t\tcover: null\r\n\t\t})\r\n\t}\r\n}))\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 324, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/app/write/stores/preview-store.ts"],"sourcesContent":["import { create } from 'zustand'\r\n\r\ntype PreviewStore = {\r\n\tisPreview: boolean\r\n\topenPreview: () => void\r\n\tclosePreview: () => void\r\n\ttogglePreview: () => void\r\n}\r\n\r\nexport const usePreviewStore = create<PreviewStore>(set => ({\r\n\tisPreview: false,\r\n\topenPreview: () => set({ isPreview: true }),\r\n\tclosePreview: () => set({ isPreview: false }),\r\n\ttogglePreview: () => set(state => ({ isPreview: !state.isPreview }))\r\n}))\r\n"],"names":[],"mappings":";;;;AAAA;;AASO,MAAM,kBAAkB,IAAA,iQAAM,EAAe,CAAA,MAAO,CAAC;QAC3D,WAAW;QACX,aAAa,IAAM,IAAI;gBAAE,WAAW;YAAK;QACzC,cAAc,IAAM,IAAI;gBAAE,WAAW;YAAM;QAC3C,eAAe,IAAM,IAAI,CAAA,QAAS,CAAC;oBAAE,WAAW,CAAC,MAAM,SAAS;gBAAC,CAAC;IACnE,CAAC","debugId":null}},
    {"offset": {"line": 349, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/editor.tsx"],"sourcesContent":["import { motion } from 'motion/react'\r\nimport { useWriteStore } from '../stores/write-store'\r\nimport { INIT_DELAY } from '@/consts'\r\nimport { useRef } from 'react'\r\n\r\nconst defaultText = 'text'\r\n\r\nexport function WriteEditor() {\r\n\tconst { form, updateForm, images, addFiles } = useWriteStore()\r\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null)\r\n\r\n\tconst insertText = (text: string) => {\r\n\t\tconst textarea = textareaRef.current\r\n\t\tif (!textarea) return\r\n\r\n\t\ttextarea.focus()\r\n\t\t// Use execCommand to preserve undo/redo stack\r\n\t\tconst success = document.execCommand('insertText', false, text)\r\n\r\n\t\tif (!success) {\r\n\t\t\t// Fallback for browsers that don't support execCommand\r\n\t\t\tconst { selectionStart, selectionEnd, value } = textarea\r\n\t\t\tconst before = value.substring(0, selectionStart)\r\n\t\t\tconst after = value.substring(selectionEnd)\r\n\t\t\tupdateForm({ md: before + text + after })\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\ttextarea.setSelectionRange(selectionStart + text.length, selectionStart + text.length)\r\n\t\t\t\ttextarea.focus()\r\n\t\t\t}, 0)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n\t\tconst textarea = textareaRef.current\r\n\t\tif (!textarea) return\r\n\r\n\t\tconst { selectionStart, selectionEnd, value } = textarea\r\n\t\tconst selectedText = value.substring(selectionStart, selectionEnd)\r\n\r\n\t\t// Ctrl/Cmd + B: Toggle Bold\r\n\t\tif ((e.ctrlKey || e.metaKey) && e.key === 'b') {\r\n\t\t\te.preventDefault()\r\n\t\t\tconst before = value.substring(0, selectionStart)\r\n\t\t\tconst after = value.substring(selectionEnd)\r\n\r\n\t\t\t// Check if already bold\r\n\t\t\tconst isBold = before.endsWith('**') && after.startsWith('**')\r\n\r\n\t\t\tif (isBold && selectedText) {\r\n\t\t\t\t// Remove bold - select including markers and replace\r\n\t\t\t\ttextarea.setSelectionRange(selectionStart - 2, selectionEnd + 2)\r\n\t\t\t\tinsertText(selectedText)\r\n\t\t\t} else {\r\n\t\t\t\t// Add bold\r\n\t\t\t\tconst text = selectedText || defaultText\r\n\t\t\t\tinsertText(`**${text}**`)\r\n\t\t\t\tif (!selectedText) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\ttextarea.setSelectionRange(selectionStart + 2, selectionStart + 2 + defaultText.length)\r\n\t\t\t\t\t}, 0)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Ctrl/Cmd + I: Toggle Italic\r\n\t\tif ((e.ctrlKey || e.metaKey) && e.key === 'i') {\r\n\t\t\te.preventDefault()\r\n\t\t\tconst before = value.substring(0, selectionStart)\r\n\t\t\tconst after = value.substring(selectionEnd)\r\n\r\n\t\t\t// Check if already italic\r\n\t\t\tconst isItalic = before.endsWith('*') && after.startsWith('*') && !(before.endsWith('**') && after.startsWith('**'))\r\n\r\n\t\t\tif (isItalic && selectedText) {\r\n\t\t\t\t// Remove italic and replace\r\n\t\t\t\ttextarea.setSelectionRange(selectionStart - 1, selectionEnd + 1)\r\n\t\t\t\tinsertText(selectedText)\r\n\t\t\t} else {\r\n\t\t\t\t// Add italic\r\n\t\t\t\tconst text = selectedText || defaultText\r\n\t\t\t\tinsertText(`*${text}*`)\r\n\t\t\t\tif (!selectedText) {\r\n\t\t\t\t\t// Select the default text\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\ttextarea.setSelectionRange(selectionStart + 1, selectionStart + 1 + defaultText.length)\r\n\t\t\t\t\t}, 0)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Ctrl/Cmd + K: Link\r\n\t\tif ((e.ctrlKey || e.metaKey) && e.key === 'k') {\r\n\t\t\te.preventDefault()\r\n\t\t\tconst text = selectedText || defaultText\r\n\t\t\tinsertText(`[${text}](url)`)\r\n\t\t\t// Select 'url' part\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconst urlStart = selectionStart + text.length + 3\r\n\t\t\t\ttextarea.setSelectionRange(urlStart, urlStart + 3)\r\n\t\t\t}, 0)\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Tab: Indent\r\n\t\tif (e.key === 'Tab' && !e.shiftKey) {\r\n\t\t\te.preventDefault()\r\n\t\t\tinsertText('\\t')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Shift + Tab: Outdent\r\n\t\tif (e.key === 'Tab' && e.shiftKey) {\r\n\t\t\te.preventDefault()\r\n\t\t\tconst lineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1\r\n\t\t\tconst line = value.substring(lineStart, value.indexOf('\\n', selectionStart))\r\n\r\n\t\t\tif (line.startsWith('\\t')) {\r\n\t\t\t\ttextarea.setSelectionRange(lineStart, lineStart + 1)\r\n\t\t\t\tinsertText('')\r\n\t\t\t} else if (line.startsWith('  ')) {\r\n\t\t\t\ttextarea.setSelectionRange(lineStart, lineStart + 2)\r\n\t\t\t\tinsertText('')\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\r\n\tconst handlePaste = async (e: React.ClipboardEvent<HTMLTextAreaElement>) => {\r\n\t\tconst items = e.clipboardData.items\r\n\t\tif (!items) return\r\n\r\n\t\tconst imageFiles: File[] = []\r\n\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\tconst item = items[i]\r\n\t\t\tif (item.type.startsWith('image/')) {\r\n\t\t\t\tconst file = item.getAsFile()\r\n\t\t\t\tif (file) {\r\n\t\t\t\t\timageFiles.push(file)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (imageFiles.length > 0) {\r\n\t\t\te.preventDefault()\r\n\r\n\t\t\tconst resultImages = await addFiles(imageFiles).catch(() => [])\r\n\r\n\t\t\tif (resultImages && resultImages.length > 0) {\r\n\t\t\t\t// 为所有处理后的图片（包括新添加和已存在的）生成 markdown\r\n\t\t\t\tconst markdowns = resultImages.map(item => (item.type === 'url' ? `![](${item.url})` : `![](local-image:${item.id})`)).join('\\n')\r\n\t\t\t\tinsertText(markdowns)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<motion.div\r\n\t\t\tinitial={{ opacity: 0, scale: 0.8 }}\r\n\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\ttransition={{ delay: INIT_DELAY }}\r\n\t\t\tclassName='flex min-h-[800px] w-[800px] flex-col rounded-[40px] border bg-white/60 p-6 shadow'>\r\n\t\t\t<div className='mb-3 flex gap-3'>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tplaceholder='标题'\r\n\t\t\t\t\tclassName='flex-1 rounded-lg border bg-white/60 px-3 py-2 text-sm'\r\n\t\t\t\t\tvalue={form.title}\r\n\t\t\t\t\tonChange={e => updateForm({ title: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tplaceholder='slug（xx-xx）'\r\n\t\t\t\t\tclassName='w-[200px] rounded-lg border bg-white/60 px-3 py-2 text-sm'\r\n\t\t\t\t\tvalue={form.slug}\r\n\t\t\t\t\tonChange={e => updateForm({ slug: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<textarea\r\n\t\t\t\tref={textareaRef}\r\n\t\t\t\tplaceholder='Markdown 内容'\r\n\t\t\t\tclassName='h-[650px] w-full flex-1 resize-none rounded-xl border bg-white/60 p-4 text-sm'\r\n\t\t\t\tvalue={form.md}\r\n\t\t\t\tonChange={e => updateForm({ md: e.target.value })}\r\n\t\t\t\tonKeyDown={handleKeyDown}\r\n\t\t\t\tonPaste={handlePaste}\r\n\t\t\t/>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["motion","useWriteStore","INIT_DELAY","useRef","defaultText","WriteEditor","$","_c","$i","Symbol","for","form","updateForm","addFiles","textareaRef","t0","text","textarea","current","focus","success","document","execCommand","selectionStart","selectionEnd","value","before","substring","after","md","setTimeout","WriteEditor[insertText > setTimeout()]","setSelectionRange","length","insertText","t1","e","textarea_0","selectionStart_0","selectionEnd_0","value_0","selectedText","ctrlKey","metaKey","key","preventDefault","before_0","after_0","isBold","endsWith","startsWith","text_0","WriteEditor[handleKeyDown > setTimeout()]","before_1","after_1","isItalic","text_1","text_2","urlStart","shiftKey","lineStart","lastIndexOf","line","indexOf","handleKeyDown","t2","e_0","items","clipboardData","imageFiles","i","item","type","file","getAsFile","push","resultImages","catch","_WriteEditorHandlePasteAnonymous","markdowns","map","_WriteEditorHandlePasteResultImagesMap","join","handlePaste","t3","t4","t5","opacity","scale","delay","t6","e_1","title","target","t7","t8","e_2","slug","t9","t10","t11","e_3","t12","t13","item_0","url","id"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 721, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/sections/cover-section.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useRef } from 'react'\r\nimport { motion } from 'motion/react'\r\nimport { toast } from 'sonner'\r\nimport { useWriteStore } from '../../stores/write-store'\r\n\r\ntype CoverSectionProps = {\r\n\tdelay?: number\r\n}\r\n\r\nexport function CoverSection({ delay = 0 }: CoverSectionProps) {\r\n\tconst { images, setCover, cover, addFiles } = useWriteStore()\r\n\tconst fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n\tconst coverPreviewUrl = cover ? (cover.type === 'url' ? cover.url : cover.previewUrl) : null\r\n\r\n\tconst handleCoverDrop = async (e: React.DragEvent<HTMLDivElement>) => {\r\n\t\te.preventDefault()\r\n\r\n\t\t// 处理从图片列表中拖入的情况\r\n\t\tconst md = e.dataTransfer.getData('text/markdown') || e.dataTransfer.getData('text/plain') || ''\r\n\t\tconst m = /!\\[\\]\\(([^)]+)\\)/.exec(md.trim())\r\n\t\tif (m) {\r\n\t\t\tconst target = m[1]\r\n\t\t\tlet foundItem\r\n\r\n\t\t\tif (target.startsWith('local-image:')) {\r\n\t\t\t\tconst id = target.replace(/^local-image:/, '')\r\n\t\t\t\tfoundItem = images.find(it => it.id === id)\r\n\t\t\t} else {\r\n\t\t\t\tfoundItem = images.find(it => it.type === 'url' && it.url === target)\r\n\t\t\t}\r\n\r\n\t\t\tif (foundItem) {\r\n\t\t\t\tsetCover(foundItem)\r\n\t\t\t\ttoast.success('已设置封面')\r\n\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 处理直接拖入文件的情况\r\n\t\tconst files = e.dataTransfer.files\r\n\t\tif (files && files.length > 0) {\r\n\t\t\tconst imageFiles = Array.from(files).filter(file => file.type.startsWith('image/'))\r\n\t\t\tif (imageFiles.length === 0) {\r\n\t\t\t\ttoast.error('请拖入图片文件')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tconst resultImages = await addFiles(imageFiles as unknown as FileList)\r\n\t\t\tif (resultImages && resultImages.length > 0) {\r\n\t\t\t\t// 使用第一个图片作为封面\r\n\t\t\t\tsetCover(resultImages[0])\r\n\t\t\t\ttoast.success('已设置封面')\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleClickUpload = () => {\r\n\t\tfileInputRef.current?.click()\r\n\t}\r\n\r\n\tconst handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst files = e.target.files\r\n\t\tif (!files || files.length === 0) return\r\n\r\n\t\tconst resultImages = await addFiles(files)\r\n\t\tif (resultImages && resultImages.length > 0) {\r\n\t\t\t// 使用第一个图片作为封面\r\n\t\t\tsetCover(resultImages[0])\r\n\t\t\ttoast.success('已设置封面')\r\n\t\t}\r\n\r\n\t\t// 重置 input 以便可以选择相同的文件\r\n\t\te.target.value = ''\r\n\t}\r\n\r\n\treturn (\r\n\t\t<motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay }} className='card relative'>\r\n\t\t\t<h2 className='text-sm'>封面</h2>\r\n\t\t\t<input ref={fileInputRef} type='file' accept='image/*' className='hidden' onChange={handleFileChange} />\r\n\t\t\t<div\r\n\t\t\t\tclassName='mt-3 h-[150px] overflow-hidden rounded-xl border bg-white/60'\r\n\t\t\t\tonDragOver={e => {\r\n\t\t\t\t\te.preventDefault()\r\n\t\t\t\t}}\r\n\t\t\t\tonDrop={handleCoverDrop}>\r\n\t\t\t\t{!!coverPreviewUrl ? (\r\n\t\t\t\t\t<img src={coverPreviewUrl} alt='cover preview' className='h-full w-full rounded-2xl object-cover' />\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className='grid h-full w-full cursor-pointer place-items-center transition-colors hover:bg-white/60' onClick={handleClickUpload}>\r\n\t\t\t\t\t\t<span className='text-3xl leading-none text-neutral-400'>+</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["c","_c","useRef","motion","toast","useWriteStore","CoverSectionProps","delay","CoverSection","t0","$","$i","Symbol","for","t1","undefined","images","setCover","cover","addFiles","fileInputRef","coverPreviewUrl","type","url","previewUrl","t2","e","preventDefault","md","dataTransfer","getData","m","exec","trim","target","foundItem","startsWith","id","replace","find","it","it_0","success","files","length","imageFiles","Array","from","filter","_CoverSectionHandleCoverDropAnonymous","error","resultImages","FileList","handleCoverDrop","t3","CoverSection[handleClickUpload]","current","click","handleClickUpload","t4","e_0","files_0","resultImages_0","value","handleFileChange","t5","t6","opacity","scale","t7","t8","t9","t10","t11","_CoverSectionDivOnDragOver","t12","e_1","file"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 993, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/ui/tag-input.tsx"],"sourcesContent":["import { useState } from 'react'\r\n\r\ntype TagInputProps = {\r\n\ttags: string[]\r\n\tonChange: (tags: string[]) => void\r\n}\r\n\r\nexport function TagInput({ tags, onChange }: TagInputProps) {\r\n\tconst [tagInput, setTagInput] = useState<string>('')\r\n\r\n\tconst handleAddTag = () => {\r\n\t\tif (tagInput.trim() && !tags.includes(tagInput.trim())) {\r\n\t\t\tonChange([...tags, tagInput.trim()])\r\n\t\t\tsetTagInput('')\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleRemoveTag = (index: number) => {\r\n\t\tonChange(tags.filter((_, i) => i !== index))\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='w-full rounded-lg border bg-white/70 px-3 py-2'>\r\n\t\t\t{tags.length > 0 && (\r\n\t\t\t\t<div className='mb-2 flex flex-wrap gap-2'>\r\n\t\t\t\t\t{tags.map((tag, index) => (\r\n\t\t\t\t\t\t<span key={index} className='flex items-center gap-1.5 rounded-md bg-blue-100 px-2 py-1 text-sm text-blue-700'>\r\n\t\t\t\t\t\t\t#{tag}\r\n\t\t\t\t\t\t\t<button type='button' onClick={() => handleRemoveTag(index)} className='text-secondary'>\r\n\t\t\t\t\t\t\t\t×\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<input\r\n\t\t\t\ttype='text'\r\n\t\t\t\tplaceholder='添加标签（按回车）'\r\n\t\t\t\tclassName='w-full bg-transparent text-sm outline-none'\r\n\t\t\t\tvalue={tagInput}\r\n\t\t\t\tonChange={e => setTagInput(e.target.value)}\r\n\t\t\t\tonKeyDown={e => {\r\n\t\t\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\thandleAddTag()\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n"],"names":["useState","TagInputProps","tags","onChange","TagInput","t0","$","_c","$i","Symbol","for","tagInput","setTagInput","t1","TagInput[handleAddTag]","trim","includes","handleAddTag","t2","index","filter","TagInput[handleRemoveTag > tags.filter()]","_","i","handleRemoveTag","t3","length","map","TagInput[tags.map()]","tag","index_0","TagInput[tags.map() > <button>.onClick]","t4","e","target","value","t5","e_0","key","preventDefault","t6","t7"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1168, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/sections/meta-section.tsx"],"sourcesContent":["import { motion } from 'motion/react'\r\nimport { useWriteStore } from '../../stores/write-store'\r\nimport { TagInput } from '../ui/tag-input'\r\n\r\ntype MetaSectionProps = {\r\n\tdelay?: number\r\n}\r\n\r\nexport function MetaSection({ delay = 0 }: MetaSectionProps) {\r\n\tconst { form, updateForm } = useWriteStore()\r\n\treturn (\r\n\t\t<motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay }} className='card relative'>\r\n\t\t\t<h2 className='text-sm'>元信息</h2>\r\n\r\n\t\t\t<div className='mt-3 space-y-2'>\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tplaceholder='为这篇文章写一段简短摘要'\r\n\t\t\t\t\trows={2}\r\n\t\t\t\t\tclassName='block w-full resize-none rounded-xl border bg-white/60 p-3 text-sm'\r\n\t\t\t\t\tvalue={form.summary}\r\n\t\t\t\t\tonChange={e => updateForm({ summary: e.target.value })}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<TagInput tags={form.tags} onChange={tags => updateForm({ tags })} />\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='date'\r\n\t\t\t\t\tplaceholder='日期'\r\n\t\t\t\t\tclassName='w-full rounded-lg border bg-white/60 px-3 py-2 text-sm'\r\n\t\t\t\t\tvalue={form.date}\r\n\t\t\t\t\tonChange={e => updateForm({ date: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["motion","useWriteStore","TagInput","MetaSectionProps","delay","MetaSection","t0","$","_c","$i","Symbol","for","t1","undefined","form","updateForm","t2","t3","opacity","scale","t4","t5","t6","e","summary","target","value","t7","t8","tags","t9","t10","e_0","date","t11","t12","t13"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1386, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/sections/images-section.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMemo, useRef, useState } from 'react'\r\nimport { motion } from 'motion/react'\r\nimport { useWriteStore } from '../../stores/write-store'\r\nimport Link from 'next/link'\r\n\r\ntype ImagesSectionProps = {\r\n\tdelay?: number\r\n}\r\n\r\nexport function ImagesSection({ delay = 0 }: ImagesSectionProps) {\r\n\tconst { images, cover, addUrlImage, addFiles, deleteImage } = useWriteStore()\r\n\tconst [urlInput, setUrlInput] = useState<string>('')\r\n\tconst fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n\tconst coverId = cover?.id ?? null\r\n\r\n\treturn (\r\n\t\t<motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay }} className='card relative'>\r\n\t\t\t<div className='flex items-center justify-between'>\r\n\t\t\t\t<h2 className='text-sm'>图片管理</h2>\r\n\t\t\t\t<Link href='/image-toolbox' target='_blank' className='text-xs hover:underline'>\r\n\t\t\t\t\t压缩工具\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='mt-3 flex items-center gap-2'>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tplaceholder='https://...'\r\n\t\t\t\t\tclassName='flex-1 rounded-lg border bg-white/70 px-3 py-2 text-sm'\r\n\t\t\t\t\tvalue={urlInput}\r\n\t\t\t\t\tonChange={e => setUrlInput(e.target.value)}\r\n\t\t\t\t/>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName='rounded-lg border bg-white/70 px-3 py-2 text-sm'\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tconst v = urlInput.trim()\r\n\t\t\t\t\t\tif (!v) return\r\n\t\t\t\t\t\taddUrlImage(v)\r\n\t\t\t\t\t\tsetUrlInput('')\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t添加\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<input\r\n\t\t\t\tref={fileInputRef}\r\n\t\t\t\ttype='file'\r\n\t\t\t\taccept='image/*'\r\n\t\t\t\tmultiple\r\n\t\t\t\tclassName='hidden'\r\n\t\t\t\tonChange={e => {\r\n\t\t\t\t\tconst files = e.target.files\r\n\t\t\t\t\tif (files && files.length > 0) {\r\n\t\t\t\t\t\taddFiles(files)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (e.currentTarget) e.currentTarget.value = ''\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<div className='mt-3 grid grid-cols-4 gap-2'>\r\n\t\t\t\t{/* plus tile */}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName='group relative grid aspect-square cursor-pointer place-items-center rounded-lg border bg-white/50 hover:bg-white/70'\r\n\t\t\t\t\tonClick={() => fileInputRef.current?.click()}\r\n\t\t\t\t\tonDragOver={e => {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonDrop={e => {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\tconst files = e.dataTransfer.files\r\n\t\t\t\t\t\tif (files && files.length) addFiles(files)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<span className='text-2xl leading-none text-neutral-400'>+</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{images.map(item => {\r\n\t\t\t\t\tconst isUrl = item.type === 'url'\r\n\t\t\t\t\tconst src = isUrl ? item.url : item.previewUrl\r\n\t\t\t\t\tconst markdown = isUrl ? `![](${item.url})` : `![](local-image:${item.id})`\r\n\t\t\t\t\tconst isCover = coverId === item.id\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={item.id}\r\n\t\t\t\t\t\t\tclassName={`group relative aspect-square overflow-hidden rounded-lg border bg-white/50 text-xs ${isCover ? 'ring-2 ring-blue-500' : ''}`}>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={src}\r\n\t\t\t\t\t\t\t\tclassName='h-full w-full object-cover'\r\n\t\t\t\t\t\t\t\tdraggable\r\n\t\t\t\t\t\t\t\tonDragStart={e => {\r\n\t\t\t\t\t\t\t\t\te.dataTransfer.setData('text/plain', markdown)\r\n\t\t\t\t\t\t\t\t\te.dataTransfer.setData('text/markdown', markdown)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{isCover && <div className='absolute top-1 left-1 rounded-md bg-blue-500 px-1.5 py-0.5 text-white shadow'>封面</div>}\r\n\t\t\t\t\t\t\t<div className='absolute top-1 right-1 hidden group-hover:flex'>\r\n\t\t\t\t\t\t\t\t<button type='button' className='rounded-md bg-white/80 px-1.5 py-0.5 shadow hover:bg-white' onClick={() => deleteImage(item.id)}>\r\n\t\t\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["c","_c","useMemo","useRef","useState","motion","useWriteStore","Link","ImagesSectionProps","delay","ImagesSection","t0","$","$i","Symbol","for","t1","undefined","images","cover","addUrlImage","addFiles","deleteImage","urlInput","setUrlInput","fileInputRef","coverId","id","t2","t3","opacity","scale","t4","t5","t6","e","target","value","t7","t8","ImagesSection[<button>.onClick]","v","trim","t9","t10","e_0","files","length","currentTarget","t11","ImagesSection[<div>.onClick]","current","click","t12","e_2","preventDefault","files_0","dataTransfer","t13","t14","_ImagesSectionDivOnDragOver","t15","t16","item","isUrl","type","src","url","previewUrl","markdown","isCover","e_3","setData","ImagesSection[images.map() > <button>.onClick]","map","t17","e_1"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1779, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/sidebar.tsx"],"sourcesContent":["import { CoverSection } from './sections/cover-section'\r\nimport { MetaSection } from './sections/meta-section'\r\nimport { ImagesSection } from './sections/images-section'\r\nimport { ANIMATION_DELAY, INIT_DELAY } from '@/consts'\r\n\r\nexport function WriteSidebar() {\r\n\treturn (\r\n\t\t<div className='w-[320px] space-y-6'>\r\n\t\t\t<CoverSection delay={INIT_DELAY + ANIMATION_DELAY * 0} />\r\n\t\t\t<MetaSection delay={INIT_DELAY + ANIMATION_DELAY * 1} />\r\n\t\t\t<ImagesSection delay={INIT_DELAY + ANIMATION_DELAY * 2} />\r\n\t\t</div>\r\n\t)\r\n}\r\n"],"names":["CoverSection","MetaSection","ImagesSection","ANIMATION_DELAY","INIT_DELAY","WriteSidebar","$","_c","$i","Symbol","for","t0"],"mappings":";;;;;;AAAA,SAASA,YAAY,QAAQ,0BAA0B;AACvD,SAASC,WAAW,QAAQ,yBAAyB;AACrD,SAASC,aAAa,QAAQ,2BAA2B;AACzD,SAASC,eAAe,EAAEC,UAAU,QAAQ,UAAU;;;;;;;AAE/C;IAAA,MAAAE,CAAA,OAAAC,+RAAA,EAAA;IAAA,IAAAD,CAAA,CAAA,EAAA,KAAA,oEAAA;QAAA,IAAA,IAAAE,EAAA,GAAA,GAAAA,EAAA,GAAA,GAAAA,EAAA,IAAA,EAAA;YAAAF,CAAA,CAAAE,EAAA,CAAA,GAAAC,MAAA,CAAAC,GAAA,CAAA;QAAA;QAAAJ,CAAA,CAAA,EAAA,GAAA;IAAA;IAAA,IAAAK,EAAA;IAAA,IAAAL,CAAA,CAAA,EAAA,KAAAG,MAAA,CAAAC,GAAA,CAAA,8BAAA;QAELC,EAAA,iBAAA,4SAAA,GAIM;YAJS,SAAqB,EAArB,qBAAqB;;8BACnC,4SAAC,qLAAY;oBAAQ,KAAgC,CAAhC,CAAAP,8HAAU,GAAGD,mIAAe,GAAG,EAAC;;;;;;8BACrD,4SAAC,mLAAW;oBAAQ,KAAgC,CAAhC,CAAAC,8HAAU,GAAGD,mIAAe,GAAG,EAAC;;;;;;8BACpD,4SAAC,uLAAa;oBAAQ,KAAgC,CAAhC,CAAAC,8HAAU,GAAGD,mIAAe,GAAG,EAAC,GACvD,EAJA,GAIM;;;;;;;;;;;;QAAAG,CAAA,CAAA,EAAA,GAAAK,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAL,CAAA,CAAA,EAAA;IAAA;IAAA,OAJNK,EAIM;AAAA;KANDN,aAAA","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1851, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/auth.ts"],"sourcesContent":["import { createInstallationToken, getInstallationId, signAppJwt } from './github-client'\r\nimport { GITHUB_CONFIG } from '@/consts'\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\nimport { toast } from 'sonner'\r\n\r\nconst GITHUB_TOKEN_CACHE_KEY = 'github_token'\r\n\r\nfunction getTokenFromCache(): string | null {\r\n\tif (typeof sessionStorage === 'undefined') return null\r\n\ttry {\r\n\t\treturn sessionStorage.getItem(GITHUB_TOKEN_CACHE_KEY)\r\n\t} catch {\r\n\t\treturn null\r\n\t}\r\n}\r\n\r\nfunction saveTokenToCache(token: string): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tsessionStorage.setItem(GITHUB_TOKEN_CACHE_KEY, token)\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to save token to cache:', error)\r\n\t}\r\n}\r\n\r\nfunction clearTokenCache(): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tsessionStorage.removeItem(GITHUB_TOKEN_CACHE_KEY)\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to clear token cache:', error)\r\n\t}\r\n}\r\n\r\nexport function clearAllAuthCache(): void {\r\n\tclearTokenCache()\r\n}\r\n\r\nexport function hasAuth(): boolean {\r\n\treturn !!getTokenFromCache()\r\n}\r\n\r\n/**\r\n * 统一的认证 Token 获取\r\n * 自动处理缓存、签发等逻辑\r\n * @returns GitHub Installation Token\r\n */\r\nexport async function getAuthToken(): Promise<string> {\r\n\t// 1. 先尝试从缓存获取 token\r\n\tconst cachedToken = getTokenFromCache()\r\n\tif (cachedToken) {\r\n\t\ttoast.info('使用缓存的令牌...')\r\n\t\treturn cachedToken\r\n\t}\r\n\r\n\t// 2. 获取私钥（从缓存）\r\n\tconst privateKey = useAuthStore.getState().privateKey\r\n\tif (!privateKey) {\r\n\t\tthrow new Error('需要先设置私钥。请使用 useAuth().setPrivateKey()')\r\n\t}\r\n\r\n\ttoast.info('正在签发 JWT...')\r\n\tconst jwt = signAppJwt(GITHUB_CONFIG.APP_ID, privateKey)\r\n\r\n\ttoast.info('正在获取安装信息...')\r\n\tconst installationId = await getInstallationId(jwt, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO)\r\n\r\n\ttoast.info('正在创建安装令牌...')\r\n\tconst token = await createInstallationToken(jwt, installationId)\r\n\r\n\tsaveTokenToCache(token)\r\n\r\n\treturn token\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,yBAAyB;AAE/B,SAAS;IACR,IAAI,OAAO,mBAAmB,aAAa,OAAO;IAClD,IAAI;QACH,OAAO,eAAe,OAAO,CAAC;IAC/B,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEA,SAAS,iBAAiB,KAAa;IACtC,IAAI,OAAO,mBAAmB,aAAa;IAC3C,IAAI;QACH,eAAe,OAAO,CAAC,wBAAwB;IAChD,EAAE,OAAO,OAAO;QACf,QAAQ,KAAK,CAAC,kCAAkC;IACjD;AACD;AAEA,SAAS;IACR,IAAI,OAAO,mBAAmB,aAAa;IAC3C,IAAI;QACH,eAAe,UAAU,CAAC;IAC3B,EAAE,OAAO,OAAO;QACf,QAAQ,KAAK,CAAC,gCAAgC;IAC/C;AACD;AAEO,SAAS;IACf;AACD;AAEO,SAAS;IACf,OAAO,CAAC,CAAC;AACV;AAOO,eAAe;IACrB,oBAAoB;IACpB,MAAM,cAAc;IACpB,IAAI,aAAa;QAChB,oRAAK,CAAC,IAAI,CAAC;QACX,OAAO;IACR;IAEA,eAAe;IACf,MAAM,aAAa,8IAAY,CAAC,QAAQ,GAAG,UAAU;IACrD,IAAI,CAAC,YAAY;QAChB,MAAM,IAAI,MAAM;IACjB;IAEA,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,MAAM,IAAA,+IAAU,EAAC,iIAAa,CAAC,MAAM,EAAE;IAE7C,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,iBAAiB,MAAM,IAAA,sJAAiB,EAAC,KAAK,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI;IAE3F,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,QAAQ,MAAM,IAAA,4JAAuB,EAAC,KAAK;IAEjD,iBAAiB;IAEjB,OAAO;AACR","debugId":null}},
    {"offset": {"line": 1926, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/hooks/use-auth.ts"],"sourcesContent":["import { create } from 'zustand'\r\nimport { clearAllAuthCache, getAuthToken as getToken, hasAuth as checkAuth } from '@/lib/auth'\r\n\r\ninterface AuthStore {\r\n\t// State\r\n\tisAuth: boolean\r\n\tprivateKey: string | null\r\n\r\n\t// Actions\r\n\tsetPrivateKey: (key: string) => void\r\n\tclearAuth: () => void\r\n\trefreshAuthState: () => void\r\n\tgetAuthToken: () => Promise<string>\r\n}\r\n\r\nexport const useAuthStore = create<AuthStore>((set, get) => ({\r\n\tisAuth: checkAuth(),\r\n\tprivateKey: null,\r\n\r\n\tsetPrivateKey: (key: string) => {\r\n\t\tset({ isAuth: true, privateKey: key })\r\n\t},\r\n\r\n\tclearAuth: () => {\r\n\t\tclearAllAuthCache()\r\n\t\tset({ isAuth: false })\r\n\t},\r\n\r\n\trefreshAuthState: () => {\r\n\t\tset({ isAuth: checkAuth() })\r\n\t},\r\n\r\n\tgetAuthToken: async () => {\r\n\t\tconst token = await getToken()\r\n\t\tget().refreshAuthState()\r\n\t\treturn token\r\n\t}\r\n}))\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAcO,MAAM,eAAe,IAAA,iQAAM,EAAY,CAAC,KAAK,MAAQ,CAAC;QAC5D,QAAQ,IAAA,gIAAS;QACjB,YAAY;QAEZ,eAAe,CAAC;YACf,IAAI;gBAAE,QAAQ;gBAAM,YAAY;YAAI;QACrC;QAEA,WAAW;YACV,IAAA,0IAAiB;YACjB,IAAI;gBAAE,QAAQ;YAAM;QACrB;QAEA,kBAAkB;YACjB,IAAI;gBAAE,QAAQ,IAAA,gIAAS;YAAG;QAC3B;QAEA,cAAc;YACb,MAAM,QAAQ,MAAM,IAAA,qIAAQ;YAC5B,MAAM,gBAAgB;YACtB,OAAO;QACR;IACD,CAAC","debugId":null}},
    {"offset": {"line": 1967, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/github-client.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\nimport { KJUR, KEYUTIL } from 'jsrsasign'\r\n\r\nexport const GH_API = 'https://api.github.com'\r\n\r\nfunction handle401Error(): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tuseAuthStore.getState().clearAuth()\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to clear auth cache:', error)\r\n\t}\r\n}\r\n\r\nexport function toBase64Utf8(input: string): string {\r\n\treturn btoa(unescape(encodeURIComponent(input)))\r\n}\r\n\r\nexport function signAppJwt(appId: string, privateKeyPem: string): string {\r\n\tconst now = Math.floor(Date.now() / 1000)\r\n\tconst header = { alg: 'RS256', typ: 'JWT' }\r\n\tconst payload = { iat: now - 60, exp: now + 8 * 60, iss: appId }\r\n\tconst prv = KEYUTIL.getKey(privateKeyPem) as unknown as string\r\n\treturn KJUR.jws.JWS.sign('RS256', JSON.stringify(header), JSON.stringify(payload), prv)\r\n}\r\n\r\nexport async function getInstallationId(jwt: string, owner: string, repo: string): Promise<number> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/installation`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${jwt}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`installation lookup failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn data.id\r\n}\r\n\r\nexport async function createInstallationToken(jwt: string, installationId: number): Promise<string> {\r\n\tconst res = await fetch(`${GH_API}/app/installations/${installationId}/access_tokens`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${jwt}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create token failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn data.token as string\r\n}\r\n\r\nexport async function getFileSha(token: string, owner: string, repo: string, path: string, branch: string): Promise<string | undefined> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (res.status === 404) return undefined\r\n\tif (!res.ok) throw new Error(`get file sha failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn (data && data.sha) || undefined\r\n}\r\n\r\nexport async function putFile(token: string, owner: string, repo: string, path: string, contentBase64: string, message: string, branch: string) {\r\n\tconst sha = await getFileSha(token, owner, repo, path, branch)\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}`, {\r\n\t\tmethod: 'PUT',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ message, content: contentBase64, branch, ...(sha ? { sha } : {}) })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`put file failed: ${res.status}`)\r\n\treturn res.json()\r\n}\r\n\r\n// Batch commit APIs\r\n\r\nexport async function getRef(token: string, owner: string, repo: string, ref: string): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/ref/${encodeURIComponent(ref)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`get ref failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.object.sha }\r\n}\r\n\r\nexport type TreeItem = {\r\n\tpath: string\r\n\tmode: '100644' | '100755' | '040000' | '160000' | '120000'\r\n\ttype: 'blob' | 'tree' | 'commit'\r\n\tcontent?: string\r\n\tsha?: string | null\r\n}\r\n\r\nexport async function createTree(token: string, owner: string, repo: string, tree: TreeItem[], baseTree?: string): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/trees`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ tree, base_tree: baseTree })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create tree failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n\r\nexport async function createCommit(token: string, owner: string, repo: string, message: string, tree: string, parents: string[]): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/commits`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ message, tree, parents })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create commit failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n\r\nexport async function updateRef(token: string, owner: string, repo: string, ref: string, sha: string, force = false): Promise<void> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/refs/${encodeURIComponent(ref)}`, {\r\n\t\tmethod: 'PATCH',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ sha, force })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`update ref failed: ${res.status}`)\r\n}\r\n\r\nexport async function readTextFileFromRepo(token: string, owner: string, repo: string, path: string, ref: string): Promise<string | null> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(ref)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (res.status === 404) return null\r\n\tif (!res.ok) throw new Error(`read file failed: ${res.status}`)\r\n\tconst data: any = await res.json()\r\n\tif (Array.isArray(data) || !data.content) return null\r\n\ttry {\r\n\t\treturn decodeURIComponent(escape(atob(data.content)))\r\n\t} catch {\r\n\t\treturn atob(data.content)\r\n\t}\r\n}\r\n\r\nexport async function listRepoFilesRecursive(token: string, owner: string, repo: string, path: string, ref: string): Promise<string[]> {\r\n\tasync function fetchPath(targetPath: string): Promise<string[]> {\r\n\t\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(targetPath)}?ref=${encodeURIComponent(ref)}`, {\r\n\t\t\theaders: {\r\n\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (res.status === 401) handle401Error()\r\n\t\tif (res.status === 404) return []\r\n\t\tif (!res.ok) throw new Error(`read directory failed: ${res.status}`)\r\n\t\tconst data: any = await res.json()\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tconst files: string[] = []\r\n\t\t\tfor (const item of data) {\r\n\t\t\t\tif (item.type === 'file') {\r\n\t\t\t\t\tfiles.push(item.path)\r\n\t\t\t\t} else if (item.type === 'dir') {\r\n\t\t\t\t\tconst nested = await fetchPath(item.path)\r\n\t\t\t\t\tfiles.push(...nested)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn files\r\n\t\t}\r\n\t\tif (data?.type === 'file') return [data.path]\r\n\t\tif (data?.type === 'dir') return fetchPath(data.path)\r\n\t\treturn []\r\n\t}\r\n\r\n\treturn fetchPath(path)\r\n}\r\n\r\nexport async function createBlob(\r\n\ttoken: string,\r\n\towner: string,\r\n\trepo: string,\r\n\tcontent: string,\r\n\tencoding: 'utf-8' | 'base64' = 'base64'\r\n): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/blobs`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ content, encoding })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create blob failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2247, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/blog-index.ts"],"sourcesContent":["'use client'\r\n\r\nimport { putFile, toBase64Utf8, readTextFileFromRepo } from '@/lib/github-client'\r\n\r\nexport type BlogIndexItem = {\r\n\tslug: string\r\n\ttitle: string\r\n\ttags: string[]\r\n\tdate: string\r\n\tsummary?: string\r\n\tcover?: string\r\n}\r\n\r\nexport async function upsertBlogsIndex(token: string, owner: string, repo: string, item: BlogIndexItem, branch: string): Promise<void> {\r\n\tconst indexPath = 'public/blogs/index.json'\r\n\tlet list: BlogIndexItem[] = []\r\n\ttry {\r\n\t\tconst txt = await readTextFileFromRepo(token, owner, repo, indexPath, branch)\r\n\t\tif (txt) list = JSON.parse(txt)\r\n\t} catch {\r\n\t\t// ignore parse errors and start from empty list\r\n\t}\r\n\tconst map = new Map<string, BlogIndexItem>(list.map(i => [i.slug, i]))\r\n\tmap.set(item.slug, item)\r\n\tconst next = Array.from(map.values()).sort((a, b) => (b.date || '').localeCompare(a.date || ''))\r\n\tconst base64 = toBase64Utf8(JSON.stringify(next, null, 2))\r\n\tawait putFile(token, owner, repo, indexPath, base64, 'Update blogs index', branch)\r\n}\r\n\r\nexport async function prepareBlogsIndex(token: string, owner: string, repo: string, item: BlogIndexItem, branch: string): Promise<string> {\r\n\tconst indexPath = 'public/blogs/index.json'\r\n\tlet list: BlogIndexItem[] = []\r\n\ttry {\r\n\t\tconst txt = await readTextFileFromRepo(token, owner, repo, indexPath, branch)\r\n\t\tif (txt) list = JSON.parse(txt)\r\n\t} catch {\r\n\t\t// ignore parse errors and start from empty list\r\n\t}\r\n\tconst map = new Map<string, BlogIndexItem>(list.map(i => [i.slug, i]))\r\n\tmap.set(item.slug, item)\r\n\tconst next = Array.from(map.values()).sort((a, b) => (b.date || '').localeCompare(a.date || ''))\r\n\treturn JSON.stringify(next, null, 2)\r\n}\r\n\r\nexport async function removeBlogsFromIndex(token: string, owner: string, repo: string, slugs: string[], branch: string): Promise<string> {\r\n\tconst indexPath = 'public/blogs/index.json'\r\n\tlet list: BlogIndexItem[] = []\r\n\ttry {\r\n\t\tconst txt = await readTextFileFromRepo(token, owner, repo, indexPath, branch)\r\n\t\tif (txt) list = JSON.parse(txt)\r\n\t} catch {\r\n\t\t// ignore parse errors and keep empty list\r\n\t}\r\n\tconst slugSet = new Set(slugs.filter(Boolean))\r\n\tif (slugSet.size === 0) {\r\n\t\treturn JSON.stringify(list, null, 2)\r\n\t}\r\n\tconst next = list.filter(item => !slugSet.has(item.slug))\r\n\treturn JSON.stringify(next, null, 2)\r\n}\r\n\r\nexport async function removeBlogFromIndex(token: string, owner: string, repo: string, slug: string, branch: string): Promise<string> {\r\n\treturn removeBlogsFromIndex(token, owner, repo, [slug], branch)\r\n}"],"names":[],"mappings":";;;;;;;;;;AAEA;AAFA;;AAaO,eAAe,iBAAiB,KAAa,EAAE,KAAa,EAAE,IAAY,EAAE,IAAmB,EAAE,MAAc;IACrH,MAAM,YAAY;IAClB,IAAI,OAAwB,EAAE;IAC9B,IAAI;QACH,MAAM,MAAM,MAAM,IAAA,yJAAoB,EAAC,OAAO,OAAO,MAAM,WAAW;QACtE,IAAI,KAAK,OAAO,KAAK,KAAK,CAAC;IAC5B,EAAE,OAAM;IACP,gDAAgD;IACjD;IACA,MAAM,MAAM,IAAI,IAA2B,KAAK,GAAG,CAAC,CAAA,IAAK;YAAC,EAAE,IAAI;YAAE;SAAE;IACpE,IAAI,GAAG,CAAC,KAAK,IAAI,EAAE;IACnB,MAAM,OAAO,MAAM,IAAI,CAAC,IAAI,MAAM,IAAI,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,IAAI,IAAI,EAAE,EAAE,aAAa,CAAC,EAAE,IAAI,IAAI;IAC5F,MAAM,SAAS,IAAA,iJAAY,EAAC,KAAK,SAAS,CAAC,MAAM,MAAM;IACvD,MAAM,IAAA,4IAAO,EAAC,OAAO,OAAO,MAAM,WAAW,QAAQ,sBAAsB;AAC5E;AAEO,eAAe,kBAAkB,KAAa,EAAE,KAAa,EAAE,IAAY,EAAE,IAAmB,EAAE,MAAc;IACtH,MAAM,YAAY;IAClB,IAAI,OAAwB,EAAE;IAC9B,IAAI;QACH,MAAM,MAAM,MAAM,IAAA,yJAAoB,EAAC,OAAO,OAAO,MAAM,WAAW;QACtE,IAAI,KAAK,OAAO,KAAK,KAAK,CAAC;IAC5B,EAAE,OAAM;IACP,gDAAgD;IACjD;IACA,MAAM,MAAM,IAAI,IAA2B,KAAK,GAAG,CAAC,CAAA,IAAK;YAAC,EAAE,IAAI;YAAE;SAAE;IACpE,IAAI,GAAG,CAAC,KAAK,IAAI,EAAE;IACnB,MAAM,OAAO,MAAM,IAAI,CAAC,IAAI,MAAM,IAAI,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,IAAI,IAAI,EAAE,EAAE,aAAa,CAAC,EAAE,IAAI,IAAI;IAC5F,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AACnC;AAEO,eAAe,qBAAqB,KAAa,EAAE,KAAa,EAAE,IAAY,EAAE,KAAe,EAAE,MAAc;IACrH,MAAM,YAAY;IAClB,IAAI,OAAwB,EAAE;IAC9B,IAAI;QACH,MAAM,MAAM,MAAM,IAAA,yJAAoB,EAAC,OAAO,OAAO,MAAM,WAAW;QACtE,IAAI,KAAK,OAAO,KAAK,KAAK,CAAC;IAC5B,EAAE,OAAM;IACP,0CAA0C;IAC3C;IACA,MAAM,UAAU,IAAI,IAAI,MAAM,MAAM,CAAC;IACrC,IAAI,QAAQ,IAAI,KAAK,GAAG;QACvB,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;IACnC;IACA,MAAM,OAAO,KAAK,MAAM,CAAC,CAAA,OAAQ,CAAC,QAAQ,GAAG,CAAC,KAAK,IAAI;IACvD,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AACnC;AAEO,eAAe,oBAAoB,KAAa,EAAE,KAAa,EAAE,IAAY,EAAE,IAAY,EAAE,MAAc;IACjH,OAAO,qBAAqB,OAAO,OAAO,MAAM;QAAC;KAAK,EAAE;AACzD","debugId":null}},
    {"offset": {"line": 2323, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/app/write/services/push-blog.ts"],"sourcesContent":["import { toBase64Utf8, getRef, createTree, createCommit, updateRef, createBlob, type TreeItem } from '@/lib/github-client'\r\nimport { fileToBase64NoPrefix, hashFileSHA256 } from '@/lib/file-utils'\r\nimport { prepareBlogsIndex } from '@/lib/blog-index'\r\nimport { getAuthToken } from '@/lib/auth'\r\nimport { GITHUB_CONFIG } from '@/consts'\r\nimport type { ImageItem } from '../types'\r\nimport { getFileExt } from '@/lib/utils'\r\nimport { toast } from 'sonner'\r\n\r\nexport type PushBlogParams = {\r\n\tform: {\r\n\t\tslug: string\r\n\t\ttitle: string\r\n\t\tmd: string\r\n\t\ttags: string[]\r\n\t\tdate?: string\r\n\t\tsummary?: string\r\n\t}\r\n\tcover?: ImageItem | null\r\n\timages?: ImageItem[]\r\n\tmode?: 'create' | 'edit'\r\n\toriginalSlug?: string | null\r\n}\r\n\r\nexport async function pushBlog(params: PushBlogParams): Promise<void> {\r\n\tconst { form, cover, images, mode = 'create', originalSlug } = params\r\n\r\n\tif (!form?.slug) throw new Error('需要 slug')\r\n\r\n\tif (mode === 'edit' && originalSlug && originalSlug !== form.slug) {\r\n\t\tthrow new Error('编辑模式下不支持修改 slug，请保持原 slug 不变')\r\n\t}\r\n\r\n\t// 获取认证 token（自动从全局认证状态获取）\r\n\tconst token = await getAuthToken()\r\n\r\n\ttoast.info('正在获取分支信息...')\r\n\tconst refData = await getRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`)\r\n\tconst latestCommitSha = refData.sha\r\n\r\n\tconst basePath = `public/blogs/${form.slug}`\r\n\tconst commitMessage = mode === 'edit' ? `更新文章: ${form.slug}` : `新增文章: ${form.slug}`\r\n\r\n\t// collect all local images (content + cover)\r\n\tconst allLocalImages: Array<{ img: Extract<ImageItem, { type: 'file' }>; id: string }> = []\r\n\r\n\t// add content images\r\n\tfor (const img of images || []) {\r\n\t\tif (img.type === 'file') {\r\n\t\t\tallLocalImages.push({ img, id: img.id })\r\n\t\t}\r\n\t}\r\n\r\n\t// add cover if local\r\n\tif (cover?.type === 'file') {\r\n\t\tallLocalImages.push({ img: cover, id: cover.id })\r\n\t}\r\n\r\n\ttoast.info('正在准备文件...')\r\n\r\n\tconst uploadedHashes = new Set<string>()\r\n\tlet mdToUpload = form.md\r\n\tlet coverPath: string | undefined\r\n\r\n\t// prepare tree items for all files\r\n\tconst treeItems: TreeItem[] = []\r\n\r\n\t// process all images\r\n\tif (allLocalImages.length > 0) {\r\n\t\ttoast.info('正在上传图片...')\r\n\t\tfor (const { img, id } of allLocalImages) {\r\n\t\t\tconst hash = img.hash || (await hashFileSHA256(img.file))\r\n\t\t\tconst ext = getFileExt(img.file.name)\r\n\t\t\tconst filename = `${hash}${ext}`\r\n\t\t\tconst publicPath = `/blogs/${form.slug}/${filename}`\r\n\r\n\t\t\tif (!uploadedHashes.has(hash)) {\r\n\t\t\t\tconst path = `${basePath}/${filename}`\r\n\t\t\t\tconst contentBase64 = await fileToBase64NoPrefix(img.file)\r\n\t\t\t\t// create blob for image\r\n\t\t\t\tconst blobData = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, contentBase64, 'base64')\r\n\t\t\t\ttreeItems.push({\r\n\t\t\t\t\tpath,\r\n\t\t\t\t\tmode: '100644',\r\n\t\t\t\t\ttype: 'blob',\r\n\t\t\t\t\tsha: blobData.sha\r\n\t\t\t\t})\r\n\t\t\t\tuploadedHashes.add(hash)\r\n\t\t\t}\r\n\r\n\t\t\t// replace placeholder in markdown\r\n\t\t\tconst placeholder = `local-image:${id}`\r\n\t\t\tmdToUpload = mdToUpload.split(`(${placeholder})`).join(`(${publicPath})`)\r\n\r\n\t\t\t// set cover path if this is the cover\r\n\t\t\tif (cover?.type === 'file' && cover.id === id) {\r\n\t\t\t\tcoverPath = publicPath\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// handle external cover URL\r\n\tif (cover?.type === 'url') {\r\n\t\tcoverPath = cover.url\r\n\t}\r\n\r\n\ttoast.info('正在创建文件...')\r\n\r\n\t// create blob for index.md\r\n\tconst mdBlob = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, toBase64Utf8(mdToUpload), 'base64')\r\n\ttreeItems.push({\r\n\t\tpath: `${basePath}/index.md`,\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: mdBlob.sha\r\n\t})\r\n\r\n\t// create blob for config.json\r\n\tconst dateStr = form.date || new Date().toISOString().slice(0, 10)\r\n\tconst config = {\r\n\t\ttitle: form.title,\r\n\t\ttags: form.tags,\r\n\t\tdate: dateStr,\r\n\t\tsummary: form.summary,\r\n\t\tcover: coverPath\r\n\t}\r\n\tconst configBlob = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, toBase64Utf8(JSON.stringify(config, null, 2)), 'base64')\r\n\ttreeItems.push({\r\n\t\tpath: `${basePath}/config.json`,\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: configBlob.sha\r\n\t})\r\n\r\n\t// prepare and create blob for blogs index\r\n\tconst indexJson = await prepareBlogsIndex(\r\n\t\ttoken,\r\n\t\tGITHUB_CONFIG.OWNER,\r\n\t\tGITHUB_CONFIG.REPO,\r\n\t\t{\r\n\t\t\tslug: form.slug,\r\n\t\t\ttitle: form.title,\r\n\t\t\ttags: form.tags,\r\n\t\t\tdate: dateStr,\r\n\t\t\tsummary: form.summary,\r\n\t\t\tcover: coverPath\r\n\t\t},\r\n\t\tGITHUB_CONFIG.BRANCH\r\n\t)\r\n\tconst indexBlob = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, toBase64Utf8(indexJson), 'base64')\r\n\ttreeItems.push({\r\n\t\tpath: 'public/blogs/index.json',\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: indexBlob.sha\r\n\t})\r\n\r\n\t// create tree\r\n\ttoast.info('正在创建文件树...')\r\n\tconst treeData = await createTree(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, treeItems, latestCommitSha)\r\n\r\n\t// create commit\r\n\ttoast.info('正在创建提交...')\r\n\tconst commitData = await createCommit(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, commitMessage, treeData.sha, [latestCommitSha])\r\n\r\n\t// update branch reference\r\n\ttoast.info('正在更新分支...')\r\n\tawait updateRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`, commitData.sha)\r\n\r\n\ttoast.success('发布成功！')\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2473, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/app/write/services/delete-blog.ts"],"sourcesContent":["import { toast } from 'sonner'\r\nimport { getAuthToken } from '@/lib/auth'\r\nimport { GITHUB_CONFIG } from '@/consts'\r\nimport { createBlob, createCommit, createTree, getRef, listRepoFilesRecursive, toBase64Utf8, TreeItem, updateRef } from '@/lib/github-client'\r\nimport { removeBlogFromIndex } from '@/lib/blog-index'\r\n\r\nexport async function deleteBlog(slug: string): Promise<void> {\r\n\tif (!slug) throw new Error('需要 slug')\r\n\r\n\tconst token = await getAuthToken()\r\n\r\n\ttoast.info('正在获取分支信息...')\r\n\tconst refData = await getRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`)\r\n\tconst latestCommitSha = refData.sha\r\n\r\n\tconst basePath = `public/blogs/${slug}`\r\n\r\n\ttoast.info('正在收集文章文件...')\r\n\tconst files = await listRepoFilesRecursive(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, basePath, GITHUB_CONFIG.BRANCH)\r\n\tif (files.length === 0) {\r\n\t\tthrow new Error('文章不存在或已删除')\r\n\t}\r\n\r\n\tconst treeItems: TreeItem[] = files.map(path => ({\r\n\t\tpath,\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: null\r\n\t}))\r\n\r\n\ttoast.info('正在更新索引...')\r\n\tconst indexJson = await removeBlogFromIndex(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, slug, GITHUB_CONFIG.BRANCH)\r\n\tconst indexBlob = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, toBase64Utf8(indexJson), 'base64')\r\n\ttreeItems.push({\r\n\t\tpath: 'public/blogs/index.json',\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: indexBlob.sha\r\n\t})\r\n\r\n\ttoast.info('正在创建提交...')\r\n\tconst treeData = await createTree(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, treeItems, latestCommitSha)\r\n\tconst commitData = await createCommit(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `删除文章: ${slug}`, treeData.sha, [latestCommitSha])\r\n\r\n\ttoast.info('正在更新分支...')\r\n\tawait updateRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`, commitData.sha)\r\n\r\n\ttoast.success('删除成功！请等待页面部署后刷新')\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,WAAW,IAAY;IAC5C,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,MAAM,QAAQ,MAAM,IAAA,qIAAY;IAEhC,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,UAAU,MAAM,IAAA,2IAAM,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,iIAAa,CAAC,MAAM,EAAE;IAC5G,MAAM,kBAAkB,QAAQ,GAAG;IAEnC,MAAM,WAAW,CAAC,aAAa,EAAE,MAAM;IAEvC,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,QAAQ,MAAM,IAAA,2JAAsB,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,UAAU,iIAAa,CAAC,MAAM;IACzH,IAAI,MAAM,MAAM,KAAK,GAAG;QACvB,MAAM,IAAI,MAAM;IACjB;IAEA,MAAM,YAAwB,MAAM,GAAG,CAAC,CAAA,OAAQ,CAAC;YAChD;YACA,MAAM;YACN,MAAM;YACN,KAAK;QACN,CAAC;IAED,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,YAAY,MAAM,IAAA,qJAAmB,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,MAAM,iIAAa,CAAC,MAAM;IACtH,MAAM,YAAY,MAAM,IAAA,+IAAU,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,IAAA,iJAAY,EAAC,YAAY;IAC5G,UAAU,IAAI,CAAC;QACd,MAAM;QACN,MAAM;QACN,MAAM;QACN,KAAK,UAAU,GAAG;IACnB;IAEA,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,WAAW,MAAM,IAAA,+IAAU,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,WAAW;IAC7F,MAAM,aAAa,MAAM,IAAA,iJAAY,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,SAAS,GAAG,EAAE;QAAC;KAAgB;IAEtI,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,IAAA,8IAAS,EAAC,OAAO,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,iIAAa,CAAC,MAAM,EAAE,EAAE,WAAW,GAAG;IAE/G,oRAAK,CAAC,OAAO,CAAC;AACf","debugId":null}},
    {"offset": {"line": 2530, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/hooks/use-publish.ts"],"sourcesContent":["import { useCallback } from 'react'\r\nimport { readFileAsText } from '@/lib/file-utils'\r\nimport { toast } from 'sonner'\r\nimport { pushBlog } from '../services/push-blog'\r\nimport { deleteBlog } from '../services/delete-blog'\r\nimport { useWriteStore } from '../stores/write-store'\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\n\r\nexport function usePublish() {\r\n\tconst { loading, setLoading, form, cover, images, mode, originalSlug } = useWriteStore()\r\n\tconst { isAuth, setPrivateKey } = useAuthStore()\r\n\r\n\tconst onChoosePrivateKey = useCallback(\r\n\t\tasync (file: File) => {\r\n\t\t\tconst pem = await readFileAsText(file)\r\n\t\t\tsetPrivateKey(pem)\r\n\t\t},\r\n\t\t[setPrivateKey]\r\n\t)\r\n\r\n\tconst onPublish = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true)\r\n\t\t\tawait pushBlog({\r\n\t\t\t\tform,\r\n\t\t\t\tcover,\r\n\t\t\t\timages,\r\n\t\t\t\tmode,\r\n\t\t\t\toriginalSlug\r\n\t\t\t})\r\n\r\n\t\t\tconst successMsg = mode === 'edit' ? '更新成功' : '发布成功'\r\n\t\t\ttoast.success(successMsg)\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error(err)\r\n\t\t\ttoast.error(err?.message || '操作失败')\r\n\t\t} finally {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}, [form, cover, images, mode, originalSlug, setLoading])\r\n\r\n\tconst onDelete = useCallback(async () => {\r\n\t\tconst targetSlug = originalSlug || form.slug\r\n\t\tif (!targetSlug) {\r\n\t\t\ttoast.error('缺少 slug，无法删除')\r\n\t\t\treturn\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tsetLoading(true)\r\n\t\t\tawait deleteBlog(targetSlug)\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error(err)\r\n\t\t\ttoast.error(err?.message || '删除失败')\r\n\t\t} finally {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}, [form.slug, originalSlug, setLoading])\r\n\r\n\treturn {\r\n\t\tisAuth,\r\n\t\tloading,\r\n\t\tonChoosePrivateKey,\r\n\t\tonPublish,\r\n\t\tonDelete\r\n\t}\r\n}\r\n"],"names":["useCallback","readFileAsText","toast","pushBlog","deleteBlog","useWriteStore","useAuthStore","usePublish","loading","setLoading","form","cover","images","mode","originalSlug","isAuth","setPrivateKey","onChoosePrivateKey","file","File","pem","onPublish","successMsg","success","err","console","error","message","onDelete","targetSlug","slug"],"mappings":";;;;AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,cAAc,QAAQ,kBAAkB;AACjD,SAASC,KAAK,QAAQ,QAAQ;AAC9B,SAASC,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,UAAU,QAAQ,yBAAyB;AACpD,SAASC,aAAa,QAAQ,uBAAuB;AACrD,SAASC,YAAY,QAAQ,kBAAkB;;;;;;;;;AAExC;;IACN,MAAM,EAAEE,OAAO,EAAEC,UAAU,EAAEC,IAAI,EAAEC,KAAK,EAAEC,MAAM,EAAEC,IAAI,EAAEC,YAAAA,EAAc,0KAAgB,CAAC,CAAC;IACxF,MAAM,EAAEC,MAAM,EAAEC,aAAAA,EAAe;IAE/B,MAAMC,kBAAkB,OAAGjB,2RAAW;sDACrC,OAAOkB,IAAI,EAAEC,IAAI,KAAK;YACrB,MAAMC,GAAG,GAAG,UAAMnB,gJAAc,EAACiB,IAAI,CAAC;YACtCF,aAAa,CAACI,GAAG,CAAC;QACnB,CAAC;qDACD;QAACJ,aAAa;KACf,CAAC;IAED,MAAMK,SAAS,OAAGrB,2RAAW;6CAAC,YAAY;YACzC,IAAI;gBACHS,UAAU,CAAC,IAAI,CAAC;gBAChB,UAAMN,8JAAQ,EAAC;oBACdO,IAAI;oBACJC,KAAK;oBACLC,MAAM;oBACNC,IAAI;oBACJC;gBACD,CAAC,CAAC;gBAEF,MAAMQ,UAAU,GAAGT,IAAI,KAAK,MAAM,GAAG,MAAM,GAAG,MAAM;gBACpDX,oRAAK,CAACqB,OAAO,CAACD,UAAU,CAAC;YAC1B,CAAC,CAAC,OAAOE,GAAG,EAAE,AAAK,GAAF;gBAChBC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;gBAClBtB,oRAAK,CAACwB,KAAK,CAACF,GAAG,EAAEG,OAAO,IAAI,MAAM,CAAC;YACpC,CAAC,QAAS;gBACTlB,UAAU,CAAC,KAAK,CAAC;YAClB;QACD,CAAC;4CAAE;QAACC,IAAI;QAAEC,KAAK;QAAEC,MAAM;QAAEC,IAAI;QAAEC,YAAY;QAAEL,UAAU;KAAC,CAAC;IAEzD,MAAMmB,QAAQ,OAAG5B,2RAAW;4CAAC,YAAY;YACxC,MAAM6B,UAAU,GAAGf,YAAY,IAAIJ,IAAI,CAACoB,IAAI;YAC5C,IAAI,CAACD,UAAU,EAAE;gBAChB3B,oRAAK,CAACwB,KAAK,CAAC,cAAc,CAAC;gBAC3B;YACD;YACA,IAAI;gBACHjB,UAAU,CAAC,IAAI,CAAC;gBAChB,UAAML,kKAAU,EAACyB,UAAU,CAAC;YAC7B,CAAC,CAAC,OAAOL,KAAG,EAAE,AAAK,GAAF;gBAChBC,OAAO,CAACC,KAAK,CAACF,KAAG,CAAC;gBAClBtB,oRAAK,CAACwB,KAAK,CAACF,KAAG,EAAEG,OAAO,IAAI,MAAM,CAAC;YACpC,CAAC,QAAS;gBACTlB,UAAU,CAAC,KAAK,CAAC;YAClB;QACD,CAAC;2CAAE;QAACC,IAAI,CAACoB,IAAI;QAAEhB,YAAY;QAAEL,UAAU;KAAC,CAAC;IAEzC,OAAO;QACNM,MAAM;QACNP,OAAO;QACPS,kBAAkB;QAClBI,SAAS;QACTO;IACD,CAAC;AACF;GAzDgBrB,UAAUA,CAAA,EAAG;;QAC6CF;QACvCC,8IAAY,CAAC,CAAC","ignoreList":[],"debugId":null}},
    {"offset": {"line": 2632, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/actions.tsx"],"sourcesContent":["import { motion } from 'motion/react'\r\nimport { useRef } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { useWriteStore } from '../stores/write-store'\r\nimport { usePreviewStore } from '../stores/preview-store'\r\nimport { usePublish } from '../hooks/use-publish'\r\n\r\nexport function WriteActions() {\r\n\tconst { loading, mode, form } = useWriteStore()\r\n\tconst { openPreview } = usePreviewStore()\r\n\tconst { isAuth, onChoosePrivateKey, onPublish, onDelete } = usePublish()\r\n\tconst keyInputRef = useRef<HTMLInputElement>(null)\r\n\r\n\tconst handleImportOrPublish = () => {\r\n\t\tif (!isAuth) {\r\n\t\t\tkeyInputRef.current?.click()\r\n\t\t} else {\r\n\t\t\tonPublish()\r\n\t\t}\r\n\t}\r\n\r\n\tconst buttonText = isAuth ? (mode === 'edit' ? '更新' : '发布') : '导入密钥'\r\n\r\n\tconst handleDelete = () => {\r\n\t\tif (!isAuth) {\r\n\t\t\ttoast.info('请先导入密钥')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst confirmMsg = form?.title ? `确定删除《${form.title}》吗？该操作不可恢复。` : '确定删除当前文章吗？该操作不可恢复。'\r\n\t\tif (window.confirm(confirmMsg)) {\r\n\t\t\tonDelete()\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<input\r\n\t\t\t\tref={keyInputRef}\r\n\t\t\t\ttype='file'\r\n\t\t\t\taccept='.pem'\r\n\t\t\t\tclassName='hidden'\r\n\t\t\t\tonChange={async e => {\r\n\t\t\t\t\tconst f = e.target.files?.[0]\r\n\t\t\t\t\tif (f) await onChoosePrivateKey(f)\r\n\t\t\t\t\tif (e.currentTarget) e.currentTarget.value = ''\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<ul className='absolute top-4 right-6 flex items-center gap-2'>\r\n\t\t\t\t{mode === 'edit' && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<motion.div initial={{ opacity: 0, scale: 0.6 }} animate={{ opacity: 1, scale: 1 }} className='flex items-center gap-2'>\r\n\t\t\t\t\t\t\t<div className='rounded-lg border bg-blue-50 px-4 py-2 text-sm text-blue-700'>编辑模式</div>\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.6 }}\r\n\t\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\t\tclassName='rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600 transition-colors hover:bg-red-100'\r\n\t\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\t\tonClick={handleDelete}>\r\n\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<motion.button\r\n\t\t\t\t\tinitial={{ opacity: 0, scale: 0.6 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\tclassName='rounded-xl border bg-white/60 px-6 py-2 text-sm'\r\n\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\tonClick={openPreview}>\r\n\t\t\t\t\t预览\r\n\t\t\t\t</motion.button>\r\n\t\t\t\t<motion.button\r\n\t\t\t\t\tinitial={{ opacity: 0, scale: 0.6 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\tclassName='brand-btn px-6'\r\n\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\tonClick={handleImportOrPublish}>\r\n\t\t\t\t\t{buttonText}\r\n\t\t\t\t</motion.button>\r\n\t\t\t</ul>\r\n\t\t</>\r\n\t)\r\n}\r\n"],"names":["motion","useRef","toast","useWriteStore","usePreviewStore","usePublish","WriteActions","$","_c","$i","Symbol","for","loading","mode","form","openPreview","isAuth","onChoosePrivateKey","onPublish","onDelete","keyInputRef","t0","WriteActions[handleImportOrPublish]","current","click","handleImportOrPublish","buttonText","t1","WriteActions[handleDelete]","info","confirmMsg","title","window","confirm","handleDelete","t2","e","f","target","files","currentTarget","value","t3","opacity","scale","t4","t5","t6","t7","t8","t10","t11","t12","t9","t13","t14","t15"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 2952, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/markdown-renderer.ts"],"sourcesContent":["import { marked } from 'marked'\r\nimport type { Tokens } from 'marked'\r\nimport { codeToHtml } from 'shiki'\r\n\r\nexport type TocItem = { id: string; text: string; level: number }\r\n\r\nexport interface MarkdownRenderResult {\r\n\thtml: string\r\n\ttoc: TocItem[]\r\n}\r\n\r\nexport function slugify(text: string): string {\r\n\treturn text\r\n\t\t.toLowerCase()\r\n\t\t.replace(/[^a-z0-9\\u4e00-\\u9fa5\\s-]/g, '')\r\n\t\t.trim()\r\n\t\t.replace(/\\s+/g, '-')\r\n}\r\n\r\nexport async function renderMarkdown(markdown: string): Promise<MarkdownRenderResult> {\r\n\t// Parse TOC from markdown\r\n\tconst toc: TocItem[] = []\r\n\tfor (const line of markdown.split('\\n')) {\r\n\t\tconst m = /^(#{1,3})\\s+(.+)$/.exec(line.trim())\r\n\t\tif (m) {\r\n\t\t\tconst level = m[1].length\r\n\t\t\tconst text = m[2].trim()\r\n\t\t\tconst id = slugify(text)\r\n\t\t\ttoc.push({ id, text, level })\r\n\t\t}\r\n\t}\r\n\r\n\t// Pre-process code blocks with Shiki\r\n\tconst codeBlockMap = new Map<string, { html: string; original: string }>()\r\n\tconst tokens = marked.lexer(markdown)\r\n\r\n\tfor (const token of tokens) {\r\n\t\tif (token.type === 'code') {\r\n\t\t\tconst codeToken = token as Tokens.Code\r\n\t\t\tconst originalCode = codeToken.text\r\n\t\t\ttry {\r\n\t\t\t\tconst html = await codeToHtml(originalCode, {\r\n\t\t\t\t\tlang: codeToken.lang || 'text',\r\n\t\t\t\t\ttheme: 'one-light'\r\n\t\t\t\t})\r\n\t\t\t\tconst key = `__SHIKI_CODE_${codeBlockMap.size}__`\r\n\t\t\t\tcodeBlockMap.set(key, { html, original: originalCode })\r\n\t\t\t\tcodeToken.text = key\r\n\t\t\t} catch {\r\n\t\t\t\t// Keep original if highlighting fails\r\n\t\t\t\tconst key = `__SHIKI_CODE_${codeBlockMap.size}__`\r\n\t\t\t\tcodeBlockMap.set(key, { html: '', original: originalCode })\r\n\t\t\t\tcodeToken.text = key\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Render HTML with heading ids\r\n\tconst renderer = new marked.Renderer()\r\n\r\n\trenderer.heading = (token: Tokens.Heading) => {\r\n\t\tconst id = slugify(token.text || '')\r\n\t\treturn `<h${token.depth} id=\"${id}\">${token.text}</h${token.depth}>`\r\n\t}\r\n\r\n\trenderer.code = (token: Tokens.Code) => {\r\n\t\t// Check if this code block was pre-processed\r\n\t\tconst codeData = codeBlockMap.get(token.text)\r\n\t\tif (codeData) {\r\n\t\t\t// Add data-code attribute with original code for copy functionality\r\n\t\t\t// Escape HTML entities for attribute value\r\n\t\t\tconst escapedCode = codeData.original\r\n\t\t\t\t.replace(/&/g, '&amp;')\r\n\t\t\t\t.replace(/\"/g, '&quot;')\r\n\t\t\t\t.replace(/'/g, '&#39;')\r\n\t\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\tif (codeData.html) {\r\n\t\t\t\t// Shiki highlighted code\r\n\t\t\t\treturn `<pre data-code=\"${escapedCode}\">${codeData.html}</pre>`\r\n\t\t\t}\r\n\t\t\t// Fallback for failed highlighting\r\n\t\t\treturn `<pre data-code=\"${escapedCode}\"><code>${codeData.original}</code></pre>`\r\n\t\t}\r\n\t\t// Fallback to default (inline code, not code block)\r\n\t\treturn `<code>${token.text}</code>`\r\n\t}\r\n\r\n\trenderer.listitem = (token: Tokens.ListItem) => {\r\n\t\t// Render inline markdown inside list items (e.g. links, emphasis)\r\n\t\tconst inner = token.tokens ? (marked.parser(token.tokens) as string) : token.text\r\n\r\n\t\tif (token.task) {\r\n\t\t\tconst checkbox = token.checked ? '<input type=\"checkbox\" checked disabled />' : '<input type=\"checkbox\" disabled />'\r\n\t\t\treturn `<li class=\"task-list-item\">${checkbox} ${inner}</li>\\n`\r\n\t\t}\r\n\r\n\t\treturn `<li>${inner}</li>\\n`\r\n\t}\r\n\r\n\tmarked.use({\r\n\t\trenderer\r\n\t})\r\n\tconst html = (marked.parser(tokens) as string) || ''\r\n\r\n\treturn { html, toc }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3058, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/dialog-modal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, type ReactNode } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { AnimatePresence, motion } from 'motion/react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface DialogModalProps {\r\n\topen: boolean\r\n\tonClose: () => void\r\n\tchildren: ReactNode\r\n\tclassName?: string\r\n\toverlayClassName?: string\r\n\tdisableCloseOnOverlay?: boolean\r\n\tlockScroll?: boolean\r\n\tcloseOnEsc?: boolean\r\n}\r\n\r\nexport function DialogModal({ open, onClose, children, className, disableCloseOnOverlay = false, lockScroll = true, closeOnEsc = true }: DialogModalProps) {\r\n\tconst [mounted, setMounted] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMounted(true)\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!lockScroll || !open) return\r\n\t\tconst previous = document.body.style.overflow\r\n\t\tdocument.body.style.overflow = 'hidden'\r\n\t\treturn () => {\r\n\t\t\tdocument.body.style.overflow = previous\r\n\t\t}\r\n\t}, [lockScroll, open])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!closeOnEsc || !open) return\r\n\t\tconst handler = (event: KeyboardEvent) => {\r\n\t\t\tif (event.key === 'Escape') {\r\n\t\t\t\tonClose()\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.addEventListener('keydown', handler)\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('keydown', handler)\r\n\t\t}\r\n\t}, [closeOnEsc, onClose, open])\r\n\r\n\tif (!mounted) return null\r\n\r\n\treturn createPortal(\r\n\t\t<AnimatePresence>\r\n\t\t\t{open && (\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0 }}\r\n\t\t\t\t\tanimate={{ opacity: 1 }}\r\n\t\t\t\t\texit={{ opacity: 0 }}\r\n\t\t\t\t\tclassName={'fixed inset-0 z-50 flex items-center justify-center bg-card p-4 backdrop-blur-xl'}\r\n\t\t\t\t\tonClick={disableCloseOnOverlay ? undefined : onClose}>\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.8, y: 20 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0.8, y: 20 }}\r\n\t\t\t\t\t\tclassName={cn('static', className)}\r\n\t\t\t\t\t\tonClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t</motion.div>\r\n\t\t\t)}\r\n\t\t</AnimatePresence>,\r\n\t\tdocument.body\r\n\t)\r\n}\r\n"],"names":["c","_c","useEffect","useState","ReactNode","createPortal","AnimatePresence","motion","cn","DialogModalProps","open","onClose","children","className","overlayClassName","disableCloseOnOverlay","lockScroll","closeOnEsc","DialogModal","t0","$","$i","Symbol","for","t1","t2","t3","undefined","mounted","setMounted","t4","t5","DialogModal[useEffect()]","t6","t7","previous","document","body","style","overflow","t8","t9","handler","event","key","window","addEventListener","removeEventListener","t10","opacity","scale","y","_DialogModalMotionDivOnClick","t11","e","stopPropagation"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 3256, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/markdown-image.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { DialogModal } from '@/components/dialog-modal'\r\n\r\ntype MarkdownImageProps = {\r\n\tsrc: string\r\n\talt?: string\r\n\ttitle?: string\r\n}\r\n\r\nexport function MarkdownImage({ src, alt = '', title = '' }: MarkdownImageProps) {\r\n\tconst [display, setDisplay] = useState(false)\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<img src={src} alt={alt} title={title} loading='lazy' onClick={() => setDisplay(true)} className='cursor-pointer transition-opacity hover:opacity-80' />\r\n\t\t\t<DialogModal open={display} onClose={() => setDisplay(false)} className='max-w-none bg-transparent p-0'>\r\n\t\t\t\t<img src={src} alt={alt} className='max-h-[90vh] max-w-full rounded-2xl object-contain' />\r\n\t\t\t</DialogModal>\r\n\t\t</>\r\n\t)\r\n}\r\n"],"names":["c","_c","useState","DialogModal","MarkdownImageProps","src","alt","title","MarkdownImage","t0","$","$i","Symbol","for","t1","t2","undefined","display","setDisplay","t3","MarkdownImage[<img>.onClick]","t4","t5","MarkdownImage[<DialogModal>.onClose]","t6","t7","t8"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 3384, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/code-block.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Copy, Check } from 'lucide-react'\r\n\r\ntype CodeBlockProps = {\r\n\tchildren: React.ReactNode\r\n\tcode: string\r\n}\r\n\r\nexport function CodeBlock({ children, code }: CodeBlockProps) {\r\n\tconst [copied, setCopied] = useState(false)\r\n\r\n\tconst handleCopy = async () => {\r\n\t\ttry {\r\n\t\t\tawait navigator.clipboard.writeText(code)\r\n\t\t\tsetCopied(true)\r\n\t\t\tsetTimeout(() => setCopied(false), 2000)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Failed to copy code:', error)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='code-block-wrapper'>\r\n\t\t\t<button\r\n\t\t\t\ttype='button'\r\n\t\t\t\tonClick={handleCopy}\r\n\t\t\t\tclassName='code-block-copy-btn'\r\n\t\t\t\taria-label='Copy code'\r\n\t\t\t>\r\n\t\t\t\t{copied ? <Check size={16} /> : <Copy size={16} />}\r\n\t\t\t</button>\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\n"],"names":["c","_c","useState","Copy","Check","CodeBlockProps","children","React","ReactNode","code","CodeBlock","t0","$","$i","Symbol","for","copied","setCopied","t1","CodeBlock[handleCopy]","navigator","clipboard","writeText","setTimeout","CodeBlock[handleCopy > setTimeout()]","t2","error","console","handleCopy","t3","t4"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 3504, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/hooks/use-markdown-render.tsx"],"sourcesContent":["import { useEffect, useState, type ReactElement } from 'react'\r\nimport parse, { type HTMLReactParserOptions, Element, type DOMNode } from 'html-react-parser'\r\nimport { renderMarkdown, type TocItem } from '@/lib/markdown-renderer'\r\nimport { MarkdownImage } from '@/components/markdown-image'\r\nimport { CodeBlock } from '@/components/code-block'\r\n\r\ntype MarkdownRenderResult = {\r\n\tcontent: ReactElement | null\r\n\ttoc: TocItem[]\r\n\tloading: boolean\r\n}\r\n\r\nexport function useMarkdownRender(markdown: string): MarkdownRenderResult {\r\n\tconst [content, setContent] = useState<ReactElement | null>(null)\r\n\tconst [toc, setToc] = useState<TocItem[]>([])\r\n\tconst [loading, setLoading] = useState<boolean>(true)\r\n\r\n\tuseEffect(() => {\r\n\t\tlet cancelled = false\r\n\r\n\t\tasync function render() {\r\n\t\t\tsetLoading(true)\r\n\t\t\ttry {\r\n\t\t\t\tconst { html, toc } = await renderMarkdown(markdown)\r\n\t\t\t\tif (!cancelled) {\r\n\t\t\t\t\t// Extract pre elements and replace with placeholders before parsing\r\n\t\t\t\t\tconst codeBlocks: Array<{ placeholder: string; code: string; preHtml: string }> = []\r\n\t\t\t\t\tlet processedHtml = html.replace(/<pre\\s+data-code=\"([^\"]*)\"([^>]*)>([\\s\\S]*?)<\\/pre>/g, (match, codeAttr, attrs, content) => {\r\n\t\t\t\t\t\tconst placeholder = `__CODE_BLOCK_${codeBlocks.length}__`\r\n\t\t\t\t\t\t// Decode HTML entities in code attribute\r\n\t\t\t\t\t\tconst code = codeAttr\r\n\t\t\t\t\t\t\t.replace(/&quot;/g, '\"')\r\n\t\t\t\t\t\t\t.replace(/&#39;/g, \"'\")\r\n\t\t\t\t\t\t\t.replace(/&lt;/g, '<')\r\n\t\t\t\t\t\t\t.replace(/&gt;/g, '>')\r\n\t\t\t\t\t\t\t.replace(/&amp;/g, '&')\r\n\t\t\t\t\t\tcodeBlocks.push({\r\n\t\t\t\t\t\t\tplaceholder,\r\n\t\t\t\t\t\t\tcode,\r\n\t\t\t\t\t\t\tpreHtml: `${content}`\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn placeholder\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// Parse HTML and replace img elements and code block placeholders\r\n\t\t\t\t\tconst options: HTMLReactParserOptions = {\r\n\t\t\t\t\t\treplace(domNode: DOMNode) {\r\n\t\t\t\t\t\t\tif (domNode instanceof Element && domNode.name === 'img') {\r\n\t\t\t\t\t\t\t\tconst { src, alt, title } = domNode.attribs\r\n\t\t\t\t\t\t\t\treturn <MarkdownImage src={src} alt={alt} title={title} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Handle code block placeholders in text nodes\r\n\t\t\t\t\t\t\tif (domNode.type === 'text' && domNode.data) {\r\n\t\t\t\t\t\t\t\tconst text = domNode.data\r\n\t\t\t\t\t\t\t\tfor (const block of codeBlocks) {\r\n\t\t\t\t\t\t\t\t\tif (text.includes(block.placeholder)) {\r\n\t\t\t\t\t\t\t\t\t\tconst parts = text.split(block.placeholder)\r\n\t\t\t\t\t\t\t\t\t\tconst preElement = parse(block.preHtml) as ReactElement\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{parts[0] && <>{parts[0]}</>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CodeBlock code={block.code}>{preElement}</CodeBlock>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{parts[1] && <>{parts[1]}</>}\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst reactContent = parse(processedHtml, options) as ReactElement\r\n\t\t\t\t\tsetContent(reactContent)\r\n\t\t\t\t\tsetToc(toc)\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Markdown render error:', error)\r\n\t\t\t\tif (!cancelled) {\r\n\t\t\t\t\tsetContent(null)\r\n\t\t\t\t\tsetToc([])\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tif (!cancelled) {\r\n\t\t\t\t\tsetLoading(false)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trender()\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelled = true\r\n\t\t}\r\n\t}, [markdown])\r\n\r\n\treturn { content, toc, loading }\r\n}\r\n"],"names":["useEffect","useState","ReactElement","parse","HTMLReactParserOptions","Element","DOMNode","renderMarkdown","TocItem","MarkdownImage","CodeBlock","MarkdownRenderResult","content","toc","loading","useMarkdownRender","markdown","setContent","setToc","setLoading","cancelled","render","html","codeBlocks","Array","placeholder","code","preHtml","processedHtml","replace","match","codeAttr","attrs","length","push","options","domNode","name","src","alt","title","attribs","type","data","text","block","includes","parts","split","preElement","reactContent","error","console"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 3635, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/like-button.tsx"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react'\r\nimport useSWR from 'swr'\r\nimport { motion, AnimatePresence } from 'motion/react'\r\nimport { Heart } from 'lucide-react'\r\nimport clsx from 'clsx'\r\nimport { cn } from '@/lib/utils'\r\nimport { toast } from 'sonner'\r\n\r\ntype LikeButtonProps = {\r\n\tslug?: string\r\n\tclassName?: string\r\n\tdelay?: number\r\n}\r\n\r\nconst ENDPOINT = 'https://blog-liker.yysuni1001.workers.dev/api/like'\r\n\r\nexport default function LikeButton({ slug = 'yysuni', delay, className }: LikeButtonProps) {\r\n\tconst [liked, setLiked] = useState(false)\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [justLiked, setJustLiked] = useState(false)\r\n\tconst [particles, setParticles] = useState<Array<{ id: number; x: number; y: number }>>([])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetShow(true)\r\n\t\t}, delay || 1000)\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (justLiked) {\r\n\t\t\tconst timer = setTimeout(() => setJustLiked(false), 600)\r\n\t\t\treturn () => clearTimeout(timer)\r\n\t\t}\r\n\t}, [justLiked])\r\n\r\n\tconst fetcher = useCallback(async (url: string): Promise<number | null> => {\r\n\t\tconst res = await fetch(url, { method: 'GET', cache: 'no-store' })\r\n\t\tif (!res.ok) return null\r\n\t\tconst data = await res.json().catch(() => ({}))\r\n\t\treturn typeof data?.count === 'number' ? data.count : null\r\n\t}, [])\r\n\r\n\tconst { data: fetchedCount, mutate } = useSWR(slug ? `${ENDPOINT}?slug=${encodeURIComponent(slug)}` : null, fetcher, {\r\n\t\trevalidateOnFocus: false,\r\n\t\tdedupingInterval: 1000 * 10\r\n\t})\r\n\r\n\tconst handleLike = useCallback(async () => {\r\n\t\tif (!slug) return\r\n\t\tsetLiked(true)\r\n\t\tsetJustLiked(true)\r\n\r\n\t\t// Create particle effects\r\n\t\tconst newParticles = Array.from({ length: 6 }, (_, i) => ({\r\n\t\t\tid: Date.now() + i,\r\n\t\t\tx: Math.random() * 60 - 30,\r\n\t\t\ty: Math.random() * 60 - 30\r\n\t\t}))\r\n\t\tsetParticles(newParticles)\r\n\r\n\t\t// Clear particles after animation\r\n\t\tsetTimeout(() => setParticles([]), 1000)\r\n\r\n\t\ttry {\r\n\t\t\tconst url = `${ENDPOINT}?slug=${encodeURIComponent(slug)}`\r\n\t\t\tconst res = await fetch(url, { method: 'POST' })\r\n\t\t\tconst data = await res.json().catch(() => ({}))\r\n\t\t\tif (data.reason == 'rate_limited') toast('谢谢啦😘，今天已经不能再点赞啦💕')\r\n\t\t\tconst value = typeof data?.count === 'number' ? data.count : (fetchedCount ?? 0) + 1\r\n\t\t\tawait mutate(value, { revalidate: false })\r\n\t\t} catch {\r\n\t\t\t// ignore\r\n\t\t}\r\n\t}, [slug, fetchedCount, mutate])\r\n\r\n\tconst count = typeof fetchedCount === 'number' ? fetchedCount : null\r\n\r\n\tif (show)\r\n\t\treturn (\r\n\t\t\t<motion.button\r\n\t\t\t\tinitial={{ opacity: 0, scale: 0.6 }}\r\n\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\taria-label='Like this post'\r\n\t\t\t\tonClick={handleLike}\r\n\t\t\t\tclassName={clsx('card heartbeat-container relative overflow-visible rounded-full p-3', className)}>\r\n\t\t\t\t<AnimatePresence>\r\n\t\t\t\t\t{particles.map(particle => (\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tkey={particle.id}\r\n\t\t\t\t\t\t\tclassName='pointer-events-none absolute inset-0 flex items-center justify-center'\r\n\t\t\t\t\t\t\tinitial={{ opacity: 1, scale: 0, x: 0, y: 0 }}\r\n\t\t\t\t\t\t\tanimate={{\r\n\t\t\t\t\t\t\t\topacity: [1, 1, 0],\r\n\t\t\t\t\t\t\t\tscale: [0, 1.2, 0.8],\r\n\t\t\t\t\t\t\t\tx: particle.x,\r\n\t\t\t\t\t\t\t\ty: particle.y\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\texit={{ opacity: 0 }}\r\n\t\t\t\t\t\t\ttransition={{ duration: 0.8, ease: 'easeOut' }}>\r\n\t\t\t\t\t\t\t<Heart className='fill-rose-400 text-rose-400' size={12} />\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</AnimatePresence>\r\n\r\n\t\t\t\t{typeof count === 'number' && (\r\n\t\t\t\t\t<motion.span\r\n\t\t\t\t\t\tinitial={{ scale: 0.4 }}\r\n\t\t\t\t\t\tanimate={{ scale: 1 }}\r\n\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t'absolute -top-2 left-9 min-w-6 rounded-full px-1.5 py-1 text-center text-xs text-white tabular-nums',\r\n\t\t\t\t\t\t\tliked ? 'bg-rose-400' : 'bg-gray-300'\r\n\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t{count}\r\n\t\t\t\t\t</motion.span>\r\n\t\t\t\t)}\r\n\t\t\t\t<motion.div animate={justLiked ? { scale: [1, 1.4, 1], rotate: [0, -10, 10, 0] } : {}} transition={{ duration: 0.6, ease: 'easeOut' }}>\r\n\t\t\t\t\t<Heart className={clsx('heartbeat', liked ? 'fill-rose-400 text-rose-400' : 'fill-rose-200 text-rose-200')} size={28} />\r\n\t\t\t\t</motion.div>\r\n\t\t\t</motion.button>\r\n\t\t)\r\n}\r\n"],"names":["useCallback","useEffect","useState","useSWR","motion","AnimatePresence","Heart","clsx","cn","toast","LikeButtonProps","slug","className","delay","ENDPOINT","LikeButton","liked","setLiked","show","setShow","justLiked","setJustLiked","particles","setParticles","Array","id","x","y","setTimeout","timer","clearTimeout","fetcher","url","Promise","res","fetch","method","cache","ok","data","json","catch","count","fetchedCount","mutate","encodeURIComponent","revalidateOnFocus","dedupingInterval","handleLike","newParticles","from","length","_","i","Date","now","Math","random","reason","value","revalidate","opacity","scale","map","particle","duration","ease","rotate"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 3881, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/blog-toc.tsx"],"sourcesContent":["'use client'\r\n\r\nimport clsx from 'clsx'\r\nimport { motion } from 'motion/react'\r\nimport { useEffect, useMemo, useState } from 'react'\r\n\r\ntype TocItem = {\r\n\tid: string\r\n\ttext: string\r\n\tlevel: number\r\n}\r\n\r\ntype BlogTocProps = {\r\n\ttoc: TocItem[]\r\n\tdelay?: number\r\n}\r\n\r\nexport function BlogToc({ toc, delay = 0 }: BlogTocProps) {\r\n\tconst [activeIds, setActiveIds] = useState<Set<string>>(new Set())\r\n\tconst minActiveId = useMemo(() => {\r\n\t\treturn Array.from(activeIds).sort((a, b) => toc.findIndex(item => item.id === a) - toc.findIndex(item => item.id === b))[0]\r\n\t}, [activeIds, toc])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (toc.length === 0) return\r\n\r\n\t\tconst observers = new Map<string, IntersectionObserver>()\r\n\r\n\t\t// Create observers for each heading\r\n\t\ttoc.forEach(item => {\r\n\t\t\tconst element = document.getElementById(item.id)\r\n\t\t\tif (!element) return\r\n\r\n\t\t\tconst observer = new IntersectionObserver(\r\n\t\t\t\tentries => {\r\n\t\t\t\t\tentries.forEach(entry => {\r\n\t\t\t\t\t\tsetActiveIds(prev => {\r\n\t\t\t\t\t\t\tconst newSet = new Set(prev)\r\n\t\t\t\t\t\t\tif (entry.isIntersecting) newSet.add(entry.target.id)\r\n\t\t\t\t\t\t\telse newSet.delete(entry.target.id)\r\n\r\n\t\t\t\t\t\t\treturn newSet\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\trootMargin: '-100px 0px -100px 0px',\r\n\t\t\t\t\tthreshold: 0\r\n\t\t\t\t}\r\n\t\t\t)\r\n\r\n\t\t\tobserver.observe(element)\r\n\t\t\tobservers.set(item.id, observer)\r\n\t\t})\r\n\r\n\t\treturn () => {\r\n\t\t\tobservers.forEach(observer => observer.disconnect())\r\n\t\t}\r\n\t}, [toc])\r\n\r\n\treturn (\r\n\t\t<motion.div\r\n\t\t\tinitial={{ opacity: 0, scale: 0.8 }}\r\n\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\ttransition={{ delay }}\r\n\t\t\tclassName='bg-card w-full rounded-xl border p-3 text-sm'>\r\n\t\t\t<h2 className='text-secondary mb-2 font-medium'>目录</h2>\r\n\t\t\t<div className='relative max-h-[300px] space-y-2 overflow-auto'>\r\n\t\t\t\t{toc.length === 0 && <div className='text-secondary'>暂无</div>}\r\n\t\t\t\t{toc.map(item => (\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\tkey={item.id + item.level}\r\n\t\t\t\t\t\thref={`#${item.id}`}\r\n\t\t\t\t\t\tclassName={clsx('hover:text-brand relative block pl-3 transition-colors', item.id === minActiveId && 'text-brand')}\r\n\t\t\t\t\t\tstyle={{ paddingLeft: (item.level - 1) * 8 }}>\r\n\t\t\t\t\t\t{item.text}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["c","_c","clsx","motion","useEffect","useMemo","useState","TocItem","id","text","level","BlogTocProps","toc","delay","BlogToc","t0","$","$i","Symbol","for","t1","undefined","t2","Set","activeIds","setActiveIds","t3","t4","BlogToc[(anonymous)()]","a","b","findIndex","item","item_0","Array","from","sort","minActiveId","t5","BlogToc[useEffect()]","length","observers","Map","forEach","item_1","element","document","getElementById","observer","IntersectionObserver","entries","entry","prev","newSet","isIntersecting","add","target","delete","rootMargin","threshold","observe","set","_BlogTocUseEffectAnonymousObserversForEach","t6","t7","opacity","scale","t8","t9","t10","t11","t12","item_2","paddingLeft","map","t13","observer_0","disconnect"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 4138, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/blog-sidebar.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { motion, useScroll, useSpring, useTransform } from 'motion/react'\r\nimport { ANIMATION_DELAY, INIT_DELAY } from '@/consts'\r\nimport LikeButton from '@/components/like-button'\r\nimport { BlogToc } from '@/components/blog-toc'\r\nimport { ScrollTopButton } from '@/components/scroll-top-button'\r\n\r\ntype TocItem = {\r\n\tid: string\r\n\ttext: string\r\n\tlevel: number\r\n}\r\n\r\ntype BlogSidebarProps = {\r\n\tcover?: string\r\n\tsummary?: string\r\n\ttoc: TocItem[]\r\n\tslug?: string\r\n}\r\nconst offset = 72\r\n\r\nexport function BlogSidebar({ cover, summary, toc, slug }: BlogSidebarProps) {\r\n\tconst [maxOffset, setMaxOffset] = useState(0)\r\n\tconst { scrollY } = useScroll()\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof window === 'undefined') {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst updateMaxOffset = () => {\r\n\t\t\tconst maxScrollable = document.documentElement.scrollHeight - window.innerHeight\r\n\r\n\t\t\tconst nextMaxOffset = Math.max(0, maxScrollable - offset)\r\n\r\n\t\t\tsetMaxOffset(nextMaxOffset)\r\n\t\t}\r\n\r\n\t\tconst timer = setTimeout(() => {\r\n\t\t\tupdateMaxOffset()\r\n\t\t}, 5000)\r\n\r\n\t\tupdateMaxOffset()\r\n\t\twindow.addEventListener('resize', updateMaxOffset)\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('resize', updateMaxOffset)\r\n\t\t\tclearTimeout(timer)\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst adjustedScrollY = useTransform(scrollY, value => {\r\n\t\tconst adjusted = Math.max(0, value - offset)\r\n\t\treturn Math.min(adjusted, maxOffset)\r\n\t})\r\n\tconst sidebarY = useSpring(adjustedScrollY, {\r\n\t\tstiffness: 100,\r\n\t\tdamping: 15,\r\n\t\tmass: 0.6,\r\n\t\trestDelta: 0.5\r\n\t})\r\n\r\n\treturn (\r\n\t\t<motion.div className='relative flex w-[200px] shrink-0 flex-col items-start gap-4 self-start max-sm:hidden' style={{ y: sidebarY }}>\r\n\t\t\t{cover && (\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0, scale: 0.8 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\ttransition={{ delay: INIT_DELAY + ANIMATION_DELAY * 1 }}\r\n\t\t\t\t\tclassName='bg-card w-full rounded-xl p-3'>\r\n\t\t\t\t\t<img src={cover} alt='cover' className='h-auto w-full rounded-xl border object-cover' />\r\n\t\t\t\t</motion.div>\r\n\t\t\t)}\r\n\r\n\t\t\t{summary && (\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0, scale: 0.8 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\ttransition={{ delay: INIT_DELAY + ANIMATION_DELAY * 2 }}\r\n\t\t\t\t\tclassName='bg-card w-full rounded-xl border p-3 text-sm'>\r\n\t\t\t\t\t<h2 className='text-secondary mb-2 font-medium'>摘要</h2>\r\n\t\t\t\t\t<div className='text-secondary cursor-text'>{summary}</div>\r\n\t\t\t\t</motion.div>\r\n\t\t\t)}\r\n\r\n\t\t\t<BlogToc toc={toc} delay={INIT_DELAY + ANIMATION_DELAY * 3} />\r\n\r\n\t\t\t<LikeButton slug={slug} delay={(INIT_DELAY + ANIMATION_DELAY * 4) * 1000} />\r\n\r\n\t\t\t<ScrollTopButton delay={INIT_DELAY + ANIMATION_DELAY * 5} />\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["c","_c","useEffect","useState","motion","useScroll","useSpring","useTransform","ANIMATION_DELAY","INIT_DELAY","LikeButton","BlogToc","ScrollTopButton","TocItem","id","text","level","BlogSidebarProps","cover","summary","toc","slug","offset","BlogSidebar","t0","$","$i","Symbol","for","maxOffset","setMaxOffset","scrollY","t1","t2","BlogSidebar[useEffect()]","window","updateMaxOffset","BlogSidebar[useEffect() > updateMaxOffset]","maxScrollable","document","documentElement","scrollHeight","innerHeight","nextMaxOffset","Math","max","timer","setTimeout","BlogSidebar[useEffect() > setTimeout()]","addEventListener","removeEventListener","clearTimeout","t3","value","adjusted","min","adjustedScrollY","t4","stiffness","damping","mass","restDelta","sidebarY","t5","y","t6","opacity","scale","delay","t7","t8","t9","t10","t11"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 4413, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/blog-preview.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { motion } from 'motion/react'\r\nimport { INIT_DELAY } from '@/consts'\r\nimport { useMarkdownRender } from '@/hooks/use-markdown-render'\r\nimport { useSize } from '@/hooks/use-size'\r\nimport { BlogSidebar } from '@/components/blog-sidebar'\r\n\r\ntype BlogPreviewProps = {\r\n\tmarkdown: string\r\n\ttitle: string\r\n\ttags: string[]\r\n\tdate: string\r\n\tsummary?: string\r\n\tcover?: string\r\n\tslug?: string\r\n}\r\n\r\nexport function BlogPreview({ markdown, title, tags, date, summary, cover, slug }: BlogPreviewProps) {\r\n\tconst { maxSM: isMobile } = useSize()\r\n\tconst { content, toc, loading } = useMarkdownRender(markdown)\r\n\r\n\tif (loading) {\r\n\t\treturn <div className='text-secondary flex h-full items-center justify-center text-sm'>渲染中...</div>\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='mx-auto flex max-w-[1140px] justify-center gap-6 px-6 pt-28 pb-12 max-sm:px-0'>\r\n\t\t\t<motion.article\r\n\t\t\t\tinitial={{ opacity: 0 }}\r\n\t\t\t\tanimate={{ opacity: 1 }}\r\n\t\t\t\ttransition={{ delay: INIT_DELAY }}\r\n\t\t\t\tclassName='card bg-article static flex-1 overflow-auto rounded-xl p-8'>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className='text-center text-2xl font-semibold'>{title}</div>\r\n\r\n\t\t\t\t\t<div className='text-secondary mt-4 flex flex-wrap items-center justify-center gap-3 px-8 text-center text-sm'>\r\n\t\t\t\t\t\t{tags.map(t => (\r\n\t\t\t\t\t\t\t<span key={t}>#{t}</span>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='text-secondary mt-3 text-center text-sm'>{date}</div>\r\n\t\t\t\t\t<div className='prose mt-6 max-w-none cursor-text'>{content}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</motion.article>\r\n\r\n\t\t\t{!isMobile && <BlogSidebar cover={cover} summary={summary} toc={toc} slug={slug} />}\r\n\t\t</div>\r\n\t)\r\n}\r\n"],"names":["c","_c","motion","INIT_DELAY","useMarkdownRender","useSize","BlogSidebar","BlogPreviewProps","markdown","title","tags","date","summary","cover","slug","BlogPreview","t0","$","$i","Symbol","for","maxSM","isMobile","content","toc","loading","t1","t2","t3","opacity","delay","t4","t5","map","_BlogPreviewTagsMap","t6","t7","t8","t9","t10","t11","t"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 4653, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/hooks/use-write-data.ts"],"sourcesContent":["import { useMemo } from 'react'\r\nimport dayjs from 'dayjs'\r\nimport { useWriteStore } from '../stores/write-store'\r\n\r\nexport function useWriteData() {\r\n\tconst { form, images } = useWriteStore()\r\n\r\n\t// Replace local-image placeholders with preview URLs\r\n\tconst processedMarkdown = useMemo(() => {\r\n\t\tlet mdForPreview = form.md\r\n\t\tfor (const img of images) {\r\n\t\t\tif (img.type === 'file') {\r\n\t\t\t\tconst placeholder = `local-image:${img.id}`\r\n\t\t\t\tmdForPreview = mdForPreview.split(`(${placeholder})`).join(`(${img.previewUrl})`)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn mdForPreview\r\n\t}, [form.md, images])\r\n\r\n\tconst title = form.title || 'Untitled'\r\n\tconst date = dayjs(form.date).format('YYYY年 M月 D日')\r\n\r\n\treturn {\r\n\t\tmarkdown: processedMarkdown,\r\n\t\ttitle,\r\n\t\tdate\r\n\t}\r\n}\r\n"],"names":["useMemo","dayjs","useWriteStore","useWriteData","$","_c","$i","Symbol","for","form","images","mdForPreview","md","img","type","placeholder","id","split","join","previewUrl","processedMarkdown","title","t0","date","format","t1","markdown"],"mappings":";;;;;AACA,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,QAAQ,uBAAuB;;;;;AAE9C;;IAAA,MAAAE,CAAA,OAAAC,+RAAA,EAAA;IAAA,IAAAD,CAAA,CAAA,EAAA,KAAA,oEAAA;QAAA,IAAA,IAAAE,EAAA,GAAA,GAAAA,EAAA,GAAA,IAAAA,EAAA,IAAA,EAAA;YAAAF,CAAA,CAAAE,EAAA,CAAA,GAAAC,MAAA,CAAAC,GAAA,CAAA;QAAA;QAAAJ,CAAA,CAAA,EAAA,GAAA;IAAA;IACN,MAAA,EAAAK,IAAA,EAAAC,MAAAA,EAAA;IAAwC,IAAAC,YAAA;IAAA,IAAAP,CAAA,CAAA,EAAA,KAAAK,IAAA,CAAAG,EAAA,IAAAR,CAAA,CAAA,EAAA,KAAAM,MAAA,EAAA;QAIvCC,YAAA,GAAmBF,IAAI,CAAAG,EAAG;QAC1B,KAAK,MAAAC,GAAS,IAAIH,MAAM,CAAA;YACvB,IAAIG,GAAG,CAAAC,IAAK,KAAK,MAAM,EAAA;gBACtB,MAAAC,WAAA,GAAoB,CAAA,YAAA,EAAeF,GAAG,CAAAG,EAAG,EAAE;gBAC3CL,YAAA,CAAAA,CAAA,CAAeA,YAAY,CAAAM,KAAM,CAAC,CAAA,CAAA,EAAIF,WAAW,CAAA,CAAA,CAAG,CAAC,CAAAG,IAAK,CAAC,CAAA,CAAA,EAAIL,GAAG,CAAAM,UAAW,CAAA,CAAA,CAAG,CAAC;YAArE;QACZ;QACDf,CAAA,CAAA,EAAA,GAAAK,IAAA,CAAAG,EAAA;QAAAR,CAAA,CAAA,EAAA,GAAAM,MAAA;QAAAN,CAAA,CAAA,EAAA,GAAAO,YAAA;IAAA,OAAA;QAAAA,YAAA,GAAAP,CAAA,CAAA,EAAA;IAAA;IAPF,MAAAgB,iBAAA,GAQCT,YAAmB;IAGpB,MAAAU,KAAA,GAAcZ,IAAI,CAAAY,KAAoB,IAAxB,UAAwB;IAAA,IAAAC,EAAA;IAAA,IAAAlB,CAAA,CAAA,EAAA,KAAAK,IAAA,CAAAc,IAAA,EAAA;QACzBD,EAAA,OAAArB,uMAAK,EAACQ,IAAI,CAAAc,IAAK,CAAC,CAAAC,MAAO,CAAC,4BAAa,CAAC;QAAApB,CAAA,CAAA,EAAA,GAAAK,IAAA,CAAAc,IAAA;QAAAnB,CAAA,CAAA,EAAA,GAAAkB,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAlB,CAAA,CAAA,EAAA;IAAA;IAAnD,MAAAmB,IAAA,GAAaD,EAAsC;IAAA,IAAAG,EAAA;IAAA,IAAArB,CAAA,CAAA,EAAA,KAAAmB,IAAA,IAAAnB,CAAA,CAAA,EAAA,KAAAgB,iBAAA,IAAAhB,CAAA,CAAA,EAAA,KAAAiB,KAAA,EAAA;QAE5CI,EAAA,GAAA;YAAAC,QAAA,EACIN,iBAAiB;YAAAC,KAAA;YAAAE;QAG5B,CAAC;QAAAnB,CAAA,CAAA,EAAA,GAAAmB,IAAA;QAAAnB,CAAA,CAAA,EAAA,GAAAgB,iBAAA;QAAAhB,CAAA,CAAA,EAAA,GAAAiB,KAAA;QAAAjB,CAAA,CAAA,EAAA,GAAAqB,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAArB,CAAA,CAAA,EAAA;IAAA;IAAA,OAJMqB,EAIN;AAAA;GAtBKtB,aAAA;;QACmBD,mKAAa,CAAC,CAAC","ignoreList":[],"debugId":null}},
    {"offset": {"line": 4728, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/components/preview.tsx"],"sourcesContent":["import { motion } from 'motion/react'\r\nimport { BlogPreview } from '@/components/blog-preview'\r\nimport { useWriteData } from '../hooks/use-write-data'\r\nimport type { PublishForm } from '../types'\r\n\r\ntype WritePreviewProps = {\r\n\tform: PublishForm\r\n\tcoverPreviewUrl: string | null\r\n\tonClose: () => void\r\n\tslug?: string\r\n}\r\n\r\nexport function WritePreview({ form, coverPreviewUrl, onClose, slug }: WritePreviewProps) {\r\n\tconst previewData = useWriteData()\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div onClick={e => e.stopPropagation()}>\r\n\t\t\t\t<BlogPreview\r\n\t\t\t\t\tmarkdown={previewData.markdown}\r\n\t\t\t\t\ttitle={previewData.title}\r\n\t\t\t\t\ttags={form.tags}\r\n\t\t\t\t\tdate={previewData.date}\r\n\t\t\t\t\tsummary={form.summary}\r\n\t\t\t\t\tcover={coverPreviewUrl || undefined}\r\n\t\t\t\t\tslug={slug}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<motion.button\r\n\t\t\t\tinitial={{ opacity: 0, scale: 0.6 }}\r\n\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\tclassName='absolute top-4 right-6 rounded-xl border bg-white/60 px-6 py-2 text-sm'\r\n\t\t\t\tonClick={onClose}>\r\n\t\t\t\t关闭预览\r\n\t\t\t</motion.button>\r\n\t\t</div>\r\n\t)\r\n}\r\n"],"names":["motion","BlogPreview","useWriteData","PublishForm","WritePreviewProps","form","coverPreviewUrl","onClose","slug","WritePreview","t0","$","_c","$i","Symbol","for","previewData","t1","undefined","t2","summary","tags","date","markdown","title","_WritePreviewDivOnClick","t3","t4","t5","t6","opacity","scale","t7","t8","e","stopPropagation"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 4875, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/write/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useWriteStore } from './stores/write-store'\r\nimport { usePreviewStore } from './stores/preview-store'\r\nimport { WriteEditor } from './components/editor'\r\nimport { WriteSidebar } from './components/sidebar'\r\nimport { WriteActions } from './components/actions'\r\nimport { WritePreview } from './components/preview'\r\nimport { useEffect } from 'react'\r\n\r\nexport default function WritePage() {\r\n\tconst { form, cover, reset } = useWriteStore()\r\n\tuseEffect(() => reset(), [])\r\n\tconst { isPreview, closePreview } = usePreviewStore()\r\n\r\n\tconst coverPreviewUrl = cover ? (cover.type === 'url' ? cover.url : cover.previewUrl) : null\r\n\r\n\treturn isPreview ? (\r\n\t\t<WritePreview form={form} coverPreviewUrl={coverPreviewUrl} onClose={closePreview} />\r\n\t) : (\r\n\t\t<>\r\n\t\t\t<div className='flex h-full justify-center gap-6 px-6 pt-24 pb-12'>\r\n\t\t\t\t<WriteEditor />\r\n\t\t\t\t<WriteSidebar />\r\n\t\t\t</div>\r\n\r\n\t\t\t<WriteActions />\r\n\t\t</>\r\n\t)\r\n}\r\n"],"names":["c","_c","useWriteStore","usePreviewStore","WriteEditor","WriteSidebar","WriteActions","WritePreview","useEffect","WritePage","$","$i","Symbol","for","form","cover","reset","t0","WritePage[useEffect()]","t1","isPreview","closePreview","coverPreviewUrl","type","url","previewUrl","t2"],"mappings":";;;;;AAAY,SAAAA,CAAA,IAAAC,EAAA;AAEZ,SAASC,aAAa,QAAQ,sBAAsB;AACpD,SAASC,eAAe,QAAQ,wBAAwB;AACxD,SAASC,WAAW,QAAQ,qBAAqB;AACjD,SAASC,YAAY,QAAQ,sBAAsB;AACnD,SAASC,YAAY,QAAQ,sBAAsB;AACnD,SAASC,YAAY,QAAQ,sBAAsB;AACnD,SAASC,SAAS,QAAQ,OAAO;;;AARjC,YAAY;;;;;;;;;AAUG;;IAAA,MAAAE,CAAA,OAAAT,+RAAA,EAAA;IAAA,IAAAS,CAAA,CAAA,EAAA,KAAA,oEAAA;QAAA,IAAA,IAAAC,EAAA,GAAA,GAAAA,EAAA,GAAA,GAAAA,EAAA,IAAA,EAAA;YAAAD,CAAA,CAAAC,EAAA,CAAA,GAAAC,MAAA,CAAAC,GAAA,CAAA;QAAA;QAAAH,CAAA,CAAA,EAAA,GAAA;IAAA;IACd,MAAA,EAAAI,IAAA,EAAAC,KAAA,EAAAC,KAAAA,EAAA;IAA8C,IAAAC,EAAA;IAAA,IAAAP,CAAA,CAAA,EAAA,KAAAM,KAAA,EAAA;QACpCC,EAAA,GAAA,CAAA;YAAA,0BAAAC,CAAA,GAAMF,KAAK,CAAC;SAAC,CAAA,CAAA,yBAAA;QAAAN,CAAA,CAAA,EAAA,GAAAM,KAAA;QAAAN,CAAA,CAAA,EAAA,GAAAO,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAP,CAAA,CAAA,EAAA;IAAA;IAAA,IAAAS,EAAA;IAAA,IAAAT,CAAA,CAAA,EAAA,KAAAE,MAAA,CAAAC,GAAA,CAAA,8BAAA;QAAEM,EAAA,GAAA,EAAE;QAAAT,CAAA,CAAA,EAAA,GAAAS,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAT,CAAA,CAAA,EAAA;IAAA;QAA3BF,yRAAS,EAACS,EAAa,EAAEE,EAAE,CAAC;IAC5B,MAAA,EAAAC,SAAA,EAAAC,YAAAA,EAAA;IAEA,MAAAC,eAAA,GAAwBP,KAAK,GAAIA,KAAK,CAAAQ,IAAK,KAAK,KAAoC,GAA5BR,KAAK,CAAAS,GAAuB,GAAhBT,KAAK,CAAAU,UAAmB,GAApE,IAAoE;IAAA,IAAAC,EAAA;IAAA,IAAAhB,CAAA,CAAA,EAAA,KAAAW,YAAA,IAAAX,CAAA,CAAA,EAAA,KAAAY,eAAA,IAAAZ,CAAA,CAAA,EAAA,KAAAI,IAAA,IAAAJ,CAAA,CAAA,EAAA,KAAAU,SAAA,EAAA;QAErFM,EAAA,GAAAN,SAAS,iBACf,4SAAC,gKAAY;YAAON,IAAI,CAAJA,CAAAA,IAAG,CAAC;YAAmBQ,eAAe,CAAfA,CAAAA,eAAc,CAAC;YAAWD,OAAY,CAAZA,CAAAA,YAAW,CAAC,GAUjF;;;;;iCAXM;;8BAIL,4SAAA,GAGM;oBAHS,SAAmD,EAAnD,mDAAmD;;sCACjE,4SAAC,8JAAW;;;;;sCACZ,4SAAC,gKAAY,GACd,EAHA,GAGM;;;;;;;;;;;8BAEN,4SAAC,gKAAY,GAAG,GAEjB;;;;;;;QAAAX,CAAA,CAAA,EAAA,GAAAW,YAAA;QAAAX,CAAA,CAAA,EAAA,GAAAY,eAAA;QAAAZ,CAAA,CAAA,EAAA,GAAAI,IAAA;QAAAJ,CAAA,CAAA,EAAA,GAAAU,SAAA;QAAAV,CAAA,CAAA,EAAA,GAAAgB,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAhB,CAAA,CAAA,EAAA;IAAA;IAAA,OAXMgB,EAWN;AAAA;;;QAjB8BxB,mKAAa,CAAC,CAAC;QAEVC,uKAAe,CAAC,CAAC;;;KAHvCM,UAAA","ignoreList":[],"debugId":null}}]
}