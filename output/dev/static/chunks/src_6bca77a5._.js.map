{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/pictures/list.json"],"sourcesContent":["[{\"id\":\"1764336067650-188e7e4bf33f88\",\"uploadedAt\":\"2025-11-28T13:21:07.650Z\",\"description\":\"我自己第一张图片，我自己的头像\",\"images\":[\"/images/pictures/b346636da687740b.webp\"]},{\"id\":\"1764396655400-4c7115746f45f\",\"uploadedAt\":\"2025-11-29T06:10:55.400Z\",\"description\":\"IOS 26 时候，专门生成的壁纸\",\"images\":[\"/images/pictures/25e9f3a783d6002d.webp\",\"/images/pictures/900c05fc5ffbd0cd.webp\",\"/images/pictures/818e2f72bfcd58c4.webp\",\"/images/pictures/e87a7e59c7a06eea.webp\",\"/images/pictures/6c11232a0c6b6dad.webp\"]}]"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 3, "column": 516}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/pictures/components/picture-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { motion } from 'motion/react'\r\n\r\nexport interface Picture {\r\n\tid: string\r\n\tuploadedAt: string\r\n\tdescription?: string\r\n\timage?: string\r\n\timages?: string[]\r\n}\r\n\r\ninterface PictureCardProps {\r\n\tpicture: Picture\r\n\tonDelete?: () => void\r\n\tisEditMode?: boolean\r\n}\r\n\r\nexport function PictureCard({ picture, onDelete, isEditMode }: PictureCardProps) {\r\n\tconst imageList = picture.images && picture.images.length > 0 ? picture.images : picture.image ? [picture.image] : []\r\n\r\n\tif (imageList.length === 0) {\r\n\t\treturn null\r\n\t}\r\n\r\n\treturn (\r\n\t\t<motion.div initial={{ opacity: 0, scale: 0.9 }} whileInView={{ opacity: 1, scale: 1 }} className='card relative flex flex-col gap-3'>\r\n\t\t\t{isEditMode && (\r\n\t\t\t\t<button onClick={onDelete} className='absolute top-3 right-3 rounded-lg px-2 py-1.5 text-xs text-red-400 transition-colors hover:text-red-600'>\r\n\t\t\t\t\t删除\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className='relative flex h-56 items-center justify-center overflow-visible rounded-xl'>\r\n\t\t\t\t{imageList.length === 1 && (\r\n\t\t\t\t\t<div className='flex max-h-48 max-w-full items-center justify-center rounded-xl border-4 border-white bg-white shadow-xl'>\r\n\t\t\t\t\t\t<img src={imageList[0]} alt={picture.id} className='max-h-48 max-w-full rounded-lg object-contain' />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{imageList.length > 1 &&\r\n\t\t\t\t\timageList.slice(0, 3).map((src, index) => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tclassName={`absolute flex max-h-48 max-w-full items-center justify-center overflow-hidden rounded-xl border-4 border-white bg-white shadow-xl transition-transform ${\r\n\t\t\t\t\t\t\t\tindex === 0 ? '-left-4 -translate-y-2 -rotate-6' : index === 1 ? 'z-20 rotate-1' : 'right-0 translate-y-2 rotate-6'\r\n\t\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t\t<img src={src} alt={`${picture.id}-${index}`} className='max-h-48 max-w-full rounded-lg object-contain' />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\r\n\t\t\t\t{imageList.length > 3 && (\r\n\t\t\t\t\t<div className='absolute right-4 -bottom-2 rounded-full bg-black/70 px-3 py-1 text-xs text-white shadow-lg'>共 {imageList.length} 张</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t)\r\n}\r\n"],"names":["c","_c","motion","Picture","id","uploadedAt","description","image","images","PictureCardProps","picture","onDelete","isEditMode","PictureCard","t0","$","$i","Symbol","for","T0","imageList","t1","t2","t3","t4","t5","t6","t7","t8","bb0","length","div","opacity","scale","slice","map","PictureCard[(anonymous)()]","src","index","t9","t10","t11"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/components/dialog-modal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, type ReactNode } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { AnimatePresence, motion } from 'motion/react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface DialogModalProps {\r\n\topen: boolean\r\n\tonClose: () => void\r\n\tchildren: ReactNode\r\n\tclassName?: string\r\n\toverlayClassName?: string\r\n\tdisableCloseOnOverlay?: boolean\r\n\tlockScroll?: boolean\r\n\tcloseOnEsc?: boolean\r\n}\r\n\r\nexport function DialogModal({ open, onClose, children, className, disableCloseOnOverlay = false, lockScroll = true, closeOnEsc = true }: DialogModalProps) {\r\n\tconst [mounted, setMounted] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMounted(true)\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!lockScroll || !open) return\r\n\t\tconst previous = document.body.style.overflow\r\n\t\tdocument.body.style.overflow = 'hidden'\r\n\t\treturn () => {\r\n\t\t\tdocument.body.style.overflow = previous\r\n\t\t}\r\n\t}, [lockScroll, open])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!closeOnEsc || !open) return\r\n\t\tconst handler = (event: KeyboardEvent) => {\r\n\t\t\tif (event.key === 'Escape') {\r\n\t\t\t\tonClose()\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.addEventListener('keydown', handler)\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('keydown', handler)\r\n\t\t}\r\n\t}, [closeOnEsc, onClose, open])\r\n\r\n\tif (!mounted) return null\r\n\r\n\treturn createPortal(\r\n\t\t<AnimatePresence>\r\n\t\t\t{open && (\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0 }}\r\n\t\t\t\t\tanimate={{ opacity: 1 }}\r\n\t\t\t\t\texit={{ opacity: 0 }}\r\n\t\t\t\t\tclassName={'fixed inset-0 z-50 flex items-center justify-center bg-card p-4 backdrop-blur-xl'}\r\n\t\t\t\t\tonClick={disableCloseOnOverlay ? undefined : onClose}>\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.8, y: 20 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0.8, y: 20 }}\r\n\t\t\t\t\t\tclassName={cn('static', className)}\r\n\t\t\t\t\t\tonClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t</motion.div>\r\n\t\t\t)}\r\n\t\t</AnimatePresence>,\r\n\t\tdocument.body\r\n\t)\r\n}\r\n"],"names":["c","_c","useEffect","useState","ReactNode","createPortal","AnimatePresence","motion","cn","DialogModalProps","open","onClose","children","className","overlayClassName","disableCloseOnOverlay","lockScroll","closeOnEsc","DialogModal","t0","$","$i","Symbol","for","t1","t2","t3","undefined","mounted","setMounted","t4","t5","DialogModal[useEffect()]","t6","t7","previous","document","body","style","overflow","t8","t9","handler","event","key","window","addEventListener","removeEventListener","t10","opacity","scale","y","_DialogModalMotionDivOnClick","t11","e","stopPropagation"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/pictures/components/upload-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useRef } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { Plus } from 'lucide-react'\r\nimport { DialogModal } from '@/components/dialog-modal'\r\nimport type { ImageItem } from '../../projects/components/image-upload-dialog'\r\n\r\ninterface UploadDialogProps {\r\n\tonClose: () => void\r\n\tonSubmit: (payload: { images: ImageItem[]; description: string }) => void\r\n}\r\n\r\nexport default function UploadDialog({ onClose, onSubmit }: UploadDialogProps) {\r\n\tconst [description, setDescription] = useState('')\r\n\tconst [images, setImages] = useState<ImageItem[]>([])\r\n\tconst fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n\tconst handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst files = Array.from(e.target.files || [])\r\n\t\tif (files.length === 0) return\r\n\r\n\t\tconst nextImages: ImageItem[] = []\r\n\r\n\t\tfor (const file of files) {\r\n\t\t\tif (!file.type.startsWith('image/')) {\r\n\t\t\t\ttoast.error('请选择图片文件')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tconst previewUrl = URL.createObjectURL(file)\r\n\t\t\tnextImages.push({\r\n\t\t\t\ttype: 'file',\r\n\t\t\t\tfile,\r\n\t\t\t\tpreviewUrl\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tsetImages(nextImages)\r\n\t}\r\n\r\n\tconst handleSubmit = () => {\r\n\t\tif (images.length === 0) {\r\n\t\t\ttoast.error('请至少选择一张图片')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tonSubmit({\r\n\t\t\timages,\r\n\t\t\tdescription\r\n\t\t})\r\n\r\n\t\tsetImages([])\r\n\t\tsetDescription('')\r\n\t\tonClose()\r\n\t}\r\n\r\n\tconst handleClose = () => {\r\n\t\timages.forEach(image => {\r\n\t\t\tif (image.type === 'file') {\r\n\t\t\t\tURL.revokeObjectURL(image.previewUrl)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetImages([])\r\n\t\tsetDescription('')\r\n\t\tonClose()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<DialogModal open onClose={handleClose} className='card w-md max-sm:w-full'>\r\n\t\t\t<div className='space-y-4'>\r\n\t\t\t\t<h2 className='text-xl font-bold'>上传图片</h2>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label className='text-secondary mb-2 block text-sm font-medium'>选择图片（可多选）</label>\r\n\t\t\t\t\t<input ref={fileInputRef} type='file' accept='image/*' multiple className='hidden' onChange={handleFileSelect} />\r\n\r\n\t\t\t\t\t{images.length === 0 ? (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tonClick={() => fileInputRef.current?.click()}\r\n\t\t\t\t\t\t\tclassName='flex h-32 cursor-pointer items-center justify-center rounded-xl border border-dashed border-gray-300 bg-gray-50 transition-colors hover:bg-secondary/10'>\r\n\t\t\t\t\t\t\t<div className='text-center'>\r\n\t\t\t\t\t\t\t\t<Plus className='mx-auto mb-1 h-8 w-8 text-gray-500' />\r\n\t\t\t\t\t\t\t\t<p className='text-secondary text-xs'>点击选择图片</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div className='relative flex h-40 items-center justify-center overflow-visible rounded-xl bg-linear-to-br from-gray-50 to-gray-100'>\r\n\t\t\t\t\t\t\t\t{images.slice(0, 3).map((image, index) =>\r\n\t\t\t\t\t\t\t\t\timage.type === 'file' ? (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={`absolute h-32 w-44 overflow-hidden rounded-xl border-4 border-white bg-white shadow-xl transition-transform ${\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex === 0 ? '-left-4 -translate-y-2 -rotate-6' : index === 1 ? 'z-20 rotate-1' : 'right-0 translate-y-2 rotate-6'\r\n\t\t\t\t\t\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={image.previewUrl} alt={`preview-${index}`} className='h-full w-full object-cover' />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{images.length > 3 && (\r\n\t\t\t\t\t\t\t\t\t<div className='absolute right-4 -bottom-2 rounded-full bg-black/70 px-3 py-1 text-xs text-white shadow-lg'>共 {images.length} 张</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className='mt-3 flex items-center justify-between'>\r\n\t\t\t\t\t\t\t\t<span className='text-secondary text-xs'>已选择 {images.length} 张图片</span>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype='button'\r\n\t\t\t\t\t\t\t\t\tonClick={() => fileInputRef.current?.click()}\r\n\t\t\t\t\t\t\t\t\tclassName='rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-xs text-gray-700 transition-colors hover:bg-gray-50'>\r\n\t\t\t\t\t\t\t\t\t继续添加\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label className='text-secondary mb-2 block text-sm font-medium'>描述（可选，应用于本次所有图片）</label>\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tvalue={description}\r\n\t\t\t\t\t\tonChange={e => setDescription(e.target.value)}\r\n\t\t\t\t\t\tplaceholder='这组图片的说明...'\r\n\t\t\t\t\t\tclassName='w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm focus:outline-none'\r\n\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className='mt-4 flex gap-3'>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype='button'\r\n\t\t\t\t\t\tonClick={handleClose}\r\n\t\t\t\t\t\tclassName='flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm transition-colors hover:bg-gray-50'>\r\n\t\t\t\t\t\t取消\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button type='button' onClick={handleSubmit} className='brand-btn flex-1 justify-center px-4'>\r\n\t\t\t\t\t\t确认上传\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</DialogModal>\r\n\t)\r\n}\r\n"],"names":["c","_c","useState","useRef","toast","Plus","DialogModal","ImageItem","UploadDialogProps","onClose","onSubmit","payload","images","description","UploadDialog","t0","$","$i","Symbol","for","setDescription","t1","setImages","fileInputRef","t2","e","files","Array","from","target","length","nextImages","file","type","startsWith","error","previewUrl","URL","createObjectURL","push","handleFileSelect","t3","UploadDialog[handleSubmit]","handleSubmit","t4","UploadDialog[handleClose]","forEach","_UploadDialogHandleCloseImagesForEach","handleClose","t5","t6","t7","t8","UploadDialog[<div>.onClick]","current","click","slice","map","_UploadDialogAnonymous","UploadDialog[<button>.onClick]","t9","t10","e_0","value","t11","t12","t13","t14","t15","t16","image_0","index","image","revokeObjectURL"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 860, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/auth.ts"],"sourcesContent":["import { createInstallationToken, getInstallationId, signAppJwt } from './github-client'\r\nimport { GITHUB_CONFIG } from '@/consts'\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\nimport { toast } from 'sonner'\r\n\r\nconst GITHUB_TOKEN_CACHE_KEY = 'github_token'\r\n\r\nfunction getTokenFromCache(): string | null {\r\n\tif (typeof sessionStorage === 'undefined') return null\r\n\ttry {\r\n\t\treturn sessionStorage.getItem(GITHUB_TOKEN_CACHE_KEY)\r\n\t} catch {\r\n\t\treturn null\r\n\t}\r\n}\r\n\r\nfunction saveTokenToCache(token: string): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tsessionStorage.setItem(GITHUB_TOKEN_CACHE_KEY, token)\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to save token to cache:', error)\r\n\t}\r\n}\r\n\r\nfunction clearTokenCache(): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tsessionStorage.removeItem(GITHUB_TOKEN_CACHE_KEY)\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to clear token cache:', error)\r\n\t}\r\n}\r\n\r\nexport function clearAllAuthCache(): void {\r\n\tclearTokenCache()\r\n}\r\n\r\nexport function hasAuth(): boolean {\r\n\treturn !!getTokenFromCache()\r\n}\r\n\r\n/**\r\n * 统一的认证 Token 获取\r\n * 自动处理缓存、签发等逻辑\r\n * @returns GitHub Installation Token\r\n */\r\nexport async function getAuthToken(): Promise<string> {\r\n\t// 1. 先尝试从缓存获取 token\r\n\tconst cachedToken = getTokenFromCache()\r\n\tif (cachedToken) {\r\n\t\ttoast.info('使用缓存的令牌...')\r\n\t\treturn cachedToken\r\n\t}\r\n\r\n\t// 2. 获取私钥（从缓存）\r\n\tconst privateKey = useAuthStore.getState().privateKey\r\n\tif (!privateKey) {\r\n\t\tthrow new Error('需要先设置私钥。请使用 useAuth().setPrivateKey()')\r\n\t}\r\n\r\n\ttoast.info('正在签发 JWT...')\r\n\tconst jwt = signAppJwt(GITHUB_CONFIG.APP_ID, privateKey)\r\n\r\n\ttoast.info('正在获取安装信息...')\r\n\tconst installationId = await getInstallationId(jwt, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO)\r\n\r\n\ttoast.info('正在创建安装令牌...')\r\n\tconst token = await createInstallationToken(jwt, installationId)\r\n\r\n\tsaveTokenToCache(token)\r\n\r\n\treturn token\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,yBAAyB;AAE/B,SAAS;IACR,IAAI,OAAO,mBAAmB,aAAa,OAAO;IAClD,IAAI;QACH,OAAO,eAAe,OAAO,CAAC;IAC/B,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEA,SAAS,iBAAiB,KAAa;IACtC,IAAI,OAAO,mBAAmB,aAAa;IAC3C,IAAI;QACH,eAAe,OAAO,CAAC,wBAAwB;IAChD,EAAE,OAAO,OAAO;QACf,QAAQ,KAAK,CAAC,kCAAkC;IACjD;AACD;AAEA,SAAS;IACR,IAAI,OAAO,mBAAmB,aAAa;IAC3C,IAAI;QACH,eAAe,UAAU,CAAC;IAC3B,EAAE,OAAO,OAAO;QACf,QAAQ,KAAK,CAAC,gCAAgC;IAC/C;AACD;AAEO,SAAS;IACf;AACD;AAEO,SAAS;IACf,OAAO,CAAC,CAAC;AACV;AAOO,eAAe;IACrB,oBAAoB;IACpB,MAAM,cAAc;IACpB,IAAI,aAAa;QAChB,oRAAK,CAAC,IAAI,CAAC;QACX,OAAO;IACR;IAEA,eAAe;IACf,MAAM,aAAa,8IAAY,CAAC,QAAQ,GAAG,UAAU;IACrD,IAAI,CAAC,YAAY;QAChB,MAAM,IAAI,MAAM;IACjB;IAEA,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,MAAM,IAAA,+IAAU,EAAC,iIAAa,CAAC,MAAM,EAAE;IAE7C,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,iBAAiB,MAAM,IAAA,sJAAiB,EAAC,KAAK,iIAAa,CAAC,KAAK,EAAE,iIAAa,CAAC,IAAI;IAE3F,oRAAK,CAAC,IAAI,CAAC;IACX,MAAM,QAAQ,MAAM,IAAA,4JAAuB,EAAC,KAAK;IAEjD,iBAAiB;IAEjB,OAAO;AACR","debugId":null}},
    {"offset": {"line": 935, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/hooks/use-auth.ts"],"sourcesContent":["import { create } from 'zustand'\r\nimport { clearAllAuthCache, getAuthToken as getToken, hasAuth as checkAuth } from '@/lib/auth'\r\n\r\ninterface AuthStore {\r\n\t// State\r\n\tisAuth: boolean\r\n\tprivateKey: string | null\r\n\r\n\t// Actions\r\n\tsetPrivateKey: (key: string) => void\r\n\tclearAuth: () => void\r\n\trefreshAuthState: () => void\r\n\tgetAuthToken: () => Promise<string>\r\n}\r\n\r\nexport const useAuthStore = create<AuthStore>((set, get) => ({\r\n\tisAuth: checkAuth(),\r\n\tprivateKey: null,\r\n\r\n\tsetPrivateKey: (key: string) => {\r\n\t\tset({ isAuth: true, privateKey: key })\r\n\t},\r\n\r\n\tclearAuth: () => {\r\n\t\tclearAllAuthCache()\r\n\t\tset({ isAuth: false })\r\n\t},\r\n\r\n\trefreshAuthState: () => {\r\n\t\tset({ isAuth: checkAuth() })\r\n\t},\r\n\r\n\tgetAuthToken: async () => {\r\n\t\tconst token = await getToken()\r\n\t\tget().refreshAuthState()\r\n\t\treturn token\r\n\t}\r\n}))\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAcO,MAAM,eAAe,IAAA,iQAAM,EAAY,CAAC,KAAK,MAAQ,CAAC;QAC5D,QAAQ,IAAA,gIAAS;QACjB,YAAY;QAEZ,eAAe,CAAC;YACf,IAAI;gBAAE,QAAQ;gBAAM,YAAY;YAAI;QACrC;QAEA,WAAW;YACV,IAAA,0IAAiB;YACjB,IAAI;gBAAE,QAAQ;YAAM;QACrB;QAEA,kBAAkB;YACjB,IAAI;gBAAE,QAAQ,IAAA,gIAAS;YAAG;QAC3B;QAEA,cAAc;YACb,MAAM,QAAQ,MAAM,IAAA,qIAAQ;YAC5B,MAAM,gBAAgB;YACtB,OAAO;QACR;IACD,CAAC","debugId":null}},
    {"offset": {"line": 976, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/github-client.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\nimport { KJUR, KEYUTIL } from 'jsrsasign'\r\n\r\nexport const GH_API = 'https://api.github.com'\r\n\r\nfunction handle401Error(): void {\r\n\tif (typeof sessionStorage === 'undefined') return\r\n\ttry {\r\n\t\tuseAuthStore.getState().clearAuth()\r\n\t} catch (error) {\r\n\t\tconsole.error('Failed to clear auth cache:', error)\r\n\t}\r\n}\r\n\r\nexport function toBase64Utf8(input: string): string {\r\n\treturn btoa(unescape(encodeURIComponent(input)))\r\n}\r\n\r\nexport function signAppJwt(appId: string, privateKeyPem: string): string {\r\n\tconst now = Math.floor(Date.now() / 1000)\r\n\tconst header = { alg: 'RS256', typ: 'JWT' }\r\n\tconst payload = { iat: now - 60, exp: now + 8 * 60, iss: appId }\r\n\tconst prv = KEYUTIL.getKey(privateKeyPem) as unknown as string\r\n\treturn KJUR.jws.JWS.sign('RS256', JSON.stringify(header), JSON.stringify(payload), prv)\r\n}\r\n\r\nexport async function getInstallationId(jwt: string, owner: string, repo: string): Promise<number> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/installation`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${jwt}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`installation lookup failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn data.id\r\n}\r\n\r\nexport async function createInstallationToken(jwt: string, installationId: number): Promise<string> {\r\n\tconst res = await fetch(`${GH_API}/app/installations/${installationId}/access_tokens`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${jwt}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create token failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn data.token as string\r\n}\r\n\r\nexport async function getFileSha(token: string, owner: string, repo: string, path: string, branch: string): Promise<string | undefined> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (res.status === 404) return undefined\r\n\tif (!res.ok) throw new Error(`get file sha failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn (data && data.sha) || undefined\r\n}\r\n\r\nexport async function putFile(token: string, owner: string, repo: string, path: string, contentBase64: string, message: string, branch: string) {\r\n\tconst sha = await getFileSha(token, owner, repo, path, branch)\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}`, {\r\n\t\tmethod: 'PUT',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ message, content: contentBase64, branch, ...(sha ? { sha } : {}) })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`put file failed: ${res.status}`)\r\n\treturn res.json()\r\n}\r\n\r\n// Batch commit APIs\r\n\r\nexport async function getRef(token: string, owner: string, repo: string, ref: string): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/ref/${encodeURIComponent(ref)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`get ref failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.object.sha }\r\n}\r\n\r\nexport type TreeItem = {\r\n\tpath: string\r\n\tmode: '100644' | '100755' | '040000' | '160000' | '120000'\r\n\ttype: 'blob' | 'tree' | 'commit'\r\n\tcontent?: string\r\n\tsha?: string | null\r\n}\r\n\r\nexport async function createTree(token: string, owner: string, repo: string, tree: TreeItem[], baseTree?: string): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/trees`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ tree, base_tree: baseTree })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create tree failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n\r\nexport async function createCommit(token: string, owner: string, repo: string, message: string, tree: string, parents: string[]): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/commits`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ message, tree, parents })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create commit failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n\r\nexport async function updateRef(token: string, owner: string, repo: string, ref: string, sha: string, force = false): Promise<void> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/refs/${encodeURIComponent(ref)}`, {\r\n\t\tmethod: 'PATCH',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ sha, force })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`update ref failed: ${res.status}`)\r\n}\r\n\r\nexport async function readTextFileFromRepo(token: string, owner: string, repo: string, path: string, ref: string): Promise<string | null> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(ref)}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t}\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (res.status === 404) return null\r\n\tif (!res.ok) throw new Error(`read file failed: ${res.status}`)\r\n\tconst data: any = await res.json()\r\n\tif (Array.isArray(data) || !data.content) return null\r\n\ttry {\r\n\t\treturn decodeURIComponent(escape(atob(data.content)))\r\n\t} catch {\r\n\t\treturn atob(data.content)\r\n\t}\r\n}\r\n\r\nexport async function listRepoFilesRecursive(token: string, owner: string, repo: string, path: string, ref: string): Promise<string[]> {\r\n\tasync function fetchPath(targetPath: string): Promise<string[]> {\r\n\t\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/contents/${encodeURIComponent(targetPath)}?ref=${encodeURIComponent(ref)}`, {\r\n\t\t\theaders: {\r\n\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t\t'X-GitHub-Api-Version': '2022-11-28'\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (res.status === 401) handle401Error()\r\n\t\tif (res.status === 404) return []\r\n\t\tif (!res.ok) throw new Error(`read directory failed: ${res.status}`)\r\n\t\tconst data: any = await res.json()\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tconst files: string[] = []\r\n\t\t\tfor (const item of data) {\r\n\t\t\t\tif (item.type === 'file') {\r\n\t\t\t\t\tfiles.push(item.path)\r\n\t\t\t\t} else if (item.type === 'dir') {\r\n\t\t\t\t\tconst nested = await fetchPath(item.path)\r\n\t\t\t\t\tfiles.push(...nested)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn files\r\n\t\t}\r\n\t\tif (data?.type === 'file') return [data.path]\r\n\t\tif (data?.type === 'dir') return fetchPath(data.path)\r\n\t\treturn []\r\n\t}\r\n\r\n\treturn fetchPath(path)\r\n}\r\n\r\nexport async function createBlob(\r\n\ttoken: string,\r\n\towner: string,\r\n\trepo: string,\r\n\tcontent: string,\r\n\tencoding: 'utf-8' | 'base64' = 'base64'\r\n): Promise<{ sha: string }> {\r\n\tconst res = await fetch(`${GH_API}/repos/${owner}/${repo}/git/blobs`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\tAccept: 'application/vnd.github+json',\r\n\t\t\t'X-GitHub-Api-Version': '2022-11-28',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify({ content, encoding })\r\n\t})\r\n\tif (res.status === 401) handle401Error()\r\n\tif (!res.ok) throw new Error(`create blob failed: ${res.status}`)\r\n\tconst data = await res.json()\r\n\treturn { sha: data.sha }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1256, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/lib/file-utils.ts"],"sourcesContent":["'use client'\r\n\r\nexport function readFileAsText(file: File): Promise<string> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst reader = new FileReader()\r\n\t\treader.onload = () => resolve(String(reader.result || ''))\r\n\t\treader.onerror = reject\r\n\t\treader.readAsText(file)\r\n\t})\r\n}\r\n\r\nexport function fileToBase64NoPrefix(file: File): Promise<string> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst reader = new FileReader()\r\n\t\treader.onload = () => {\r\n\t\t\tconst dataUrl = String(reader.result || '')\r\n\t\t\tresolve(dataUrl.replace(/^data:[^;]+;base64,/, ''))\r\n\t\t}\r\n\t\treader.onerror = reject\r\n\t\treader.readAsDataURL(file)\r\n\t})\r\n}\r\n\r\nexport async function hashFileSHA256(file: File): Promise<string> {\r\n\tconst buf = await file.arrayBuffer()\r\n\tconst digest = await crypto.subtle.digest('SHA-256', buf)\r\n\tconst bytes = new Uint8Array(digest)\r\n\tlet hex = ''\r\n\tfor (let i = 0; i < bytes.length; i++) {\r\n\t\tconst h = bytes[i].toString(16).padStart(2, '0')\r\n\t\thex += h\r\n\t}\r\n\treturn hex.slice(0, 16)\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AAEO,SAAS,eAAe,IAAU;IACxC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG,IAAM,QAAQ,OAAO,OAAO,MAAM,IAAI;QACtD,OAAO,OAAO,GAAG;QACjB,OAAO,UAAU,CAAC;IACnB;AACD;AAEO,SAAS,qBAAqB,IAAU;IAC9C,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG;YACf,MAAM,UAAU,OAAO,OAAO,MAAM,IAAI;YACxC,QAAQ,QAAQ,OAAO,CAAC,uBAAuB;QAChD;QACA,OAAO,OAAO,GAAG;QACjB,OAAO,aAAa,CAAC;IACtB;AACD;AAEO,eAAe,eAAe,IAAU;IAC9C,MAAM,MAAM,MAAM,KAAK,WAAW;IAClC,MAAM,SAAS,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,WAAW;IACrD,MAAM,QAAQ,IAAI,WAAW;IAC7B,IAAI,MAAM;IACV,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;QACtC,MAAM,IAAI,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG;QAC5C,OAAO;IACR;IACA,OAAO,IAAI,KAAK,CAAC,GAAG;AACrB","debugId":null}},
    {"offset": {"line": 1302, "column": 0}, "map": {"version":3,"sources":["file:///E:/qbb/github/blog-public/src/app/pictures/services/push-pictures.ts"],"sourcesContent":["import { toBase64Utf8, getRef, createTree, createCommit, updateRef, createBlob, type TreeItem } from '@/lib/github-client'\r\nimport { fileToBase64NoPrefix, hashFileSHA256 } from '@/lib/file-utils'\r\nimport { getAuthToken } from '@/lib/auth'\r\nimport { GITHUB_CONFIG } from '@/consts'\r\nimport type { Picture } from '../components/picture-card'\r\nimport type { ImageItem } from '../../projects/components/image-upload-dialog'\r\nimport { getFileExt } from '@/lib/utils'\r\nimport { toast } from 'sonner'\r\n\r\nexport type PushPicturesParams = {\r\n\tpictures: Picture[]\r\n\timageItems?: Map<string, ImageItem>\r\n}\r\n\r\nexport async function pushPictures(params: PushPicturesParams): Promise<void> {\r\n\tconst { pictures, imageItems } = params\r\n\r\n\tconst token = await getAuthToken()\r\n\r\n\ttoast.info('正在获取分支信息...')\r\n\tconst refData = await getRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`)\r\n\tconst latestCommitSha = refData.sha\r\n\r\n\tconst commitMessage = `更新图床列表`\r\n\r\n\ttoast.info('正在准备文件...')\r\n\r\n\tconst treeItems: TreeItem[] = []\r\n\tconst uploadedHashes = new Set<string>()\r\n\tlet updatedPictures = [...pictures]\r\n\r\n\tif (imageItems && imageItems.size > 0) {\r\n\t\ttoast.info('正在上传图片...')\r\n\t\tfor (const [key, imageItem] of imageItems.entries()) {\r\n\t\t\tif (imageItem.type === 'file') {\r\n\t\t\t\tconst hash = imageItem.hash || (await hashFileSHA256(imageItem.file))\r\n\t\t\t\tconst ext = getFileExt(imageItem.file.name)\r\n\t\t\t\tconst filename = `${hash}${ext}`\r\n\t\t\t\tconst publicPath = `/images/pictures/${filename}`\r\n\r\n\t\t\t\tif (!uploadedHashes.has(hash)) {\r\n\t\t\t\t\tconst path = `public/images/pictures/${filename}`\r\n\t\t\t\t\tconst contentBase64 = await fileToBase64NoPrefix(imageItem.file)\r\n\t\t\t\t\tconst blobData = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, contentBase64, 'base64')\r\n\t\t\t\t\ttreeItems.push({\r\n\t\t\t\t\t\tpath,\r\n\t\t\t\t\t\tmode: '100644',\r\n\t\t\t\t\t\ttype: 'blob',\r\n\t\t\t\t\t\tsha: blobData.sha\r\n\t\t\t\t\t})\r\n\t\t\t\t\tuploadedHashes.add(hash)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst [groupId, indexStr] = key.split('::')\r\n\t\t\t\tconst imageIndex = Number(indexStr) || 0\r\n\r\n\t\t\t\tupdatedPictures = updatedPictures.map(p => {\r\n\t\t\t\t\tif (p.id !== groupId) return p\r\n\r\n\t\t\t\t\tconst currentImages = p.images && p.images.length > 0 ? p.images : p.image ? [p.image] : []\r\n\r\n\t\t\t\t\tconst nextImages = currentImages.map((img, idx) => (idx === imageIndex ? publicPath : img))\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...p,\r\n\t\t\t\t\t\timage: undefined,\r\n\t\t\t\t\t\timages: nextImages\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst picturesJson = JSON.stringify(updatedPictures, null, '\\t')\r\n\tconst picturesBlob = await createBlob(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, toBase64Utf8(picturesJson), 'base64')\r\n\ttreeItems.push({\r\n\t\tpath: 'src/app/pictures/list.json',\r\n\t\tmode: '100644',\r\n\t\ttype: 'blob',\r\n\t\tsha: picturesBlob.sha\r\n\t})\r\n\r\n\ttoast.info('正在创建文件树...')\r\n\tconst treeData = await createTree(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, treeItems, latestCommitSha)\r\n\r\n\ttoast.info('正在创建提交...')\r\n\tconst commitData = await createCommit(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, commitMessage, treeData.sha, [latestCommitSha])\r\n\r\n\ttoast.info('正在更新分支...')\r\n\tawait updateRef(token, GITHUB_CONFIG.OWNER, GITHUB_CONFIG.REPO, `heads/${GITHUB_CONFIG.BRANCH}`, commitData.sha)\r\n\r\n\ttoast.success('发布成功！')\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1393, "column": 0}, "map": {"version":3,"sources":["E:/qbb/github/blog-public/src/app/pictures/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useRef } from 'react'\r\nimport { motion } from 'motion/react'\r\nimport { toast } from 'sonner'\r\nimport initialList from './list.json'\r\nimport { PictureCard, type Picture } from './components/picture-card'\r\nimport UploadDialog from './components/upload-dialog'\r\nimport { pushPictures } from './services/push-pictures'\r\nimport { useAuthStore } from '@/hooks/use-auth'\r\nimport type { ImageItem } from '../projects/components/image-upload-dialog'\r\nimport { useRouter } from 'next/navigation'\r\n\r\nexport default function Page() {\r\n\tconst [pictures, setPictures] = useState<Picture[]>(initialList as Picture[])\r\n\tconst [originalPictures, setOriginalPictures] = useState<Picture[]>(initialList as Picture[])\r\n\tconst [isEditMode, setIsEditMode] = useState(false)\r\n\tconst [isSaving, setIsSaving] = useState(false)\r\n\tconst [isUploadDialogOpen, setIsUploadDialogOpen] = useState(false)\r\n\tconst [imageItems, setImageItems] = useState<Map<string, ImageItem>>(new Map())\r\n\tconst keyInputRef = useRef<HTMLInputElement>(null)\r\n\tconst router = useRouter()\r\n\r\n\tconst { isAuth, setPrivateKey } = useAuthStore()\r\n\r\n\tconst handleUploadSubmit = ({ images, description }: { images: ImageItem[]; description: string }) => {\r\n\t\tconst now = new Date().toISOString()\r\n\r\n\t\tif (images.length === 0) {\r\n\t\t\ttoast.error('请至少选择一张图片')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst id = `${Date.now()}-${Math.random().toString(16).slice(2)}`\r\n\t\tconst desc = description.trim() || undefined\r\n\r\n\t\tconst imageUrls = images.map(imageItem => (imageItem.type === 'url' ? imageItem.url : imageItem.previewUrl))\r\n\r\n\t\tconst newPicture: Picture = {\r\n\t\t\tid,\r\n\t\t\tuploadedAt: now,\r\n\t\t\tdescription: desc,\r\n\t\t\timages: imageUrls\r\n\t\t}\r\n\r\n\t\tconst newMap = new Map(imageItems)\r\n\r\n\t\timages.forEach((imageItem, index) => {\r\n\t\t\tif (imageItem.type === 'file') {\r\n\t\t\t\tnewMap.set(`${id}::${index}`, imageItem)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tsetPictures(prev => [...prev, newPicture])\r\n\t\tsetImageItems(newMap)\r\n\t\tsetIsUploadDialogOpen(false)\r\n\t}\r\n\r\n\tconst handleDelete = (picture: Picture) => {\r\n\t\tif (!confirm('确定要删除这一组图片吗？')) return\r\n\r\n\t\tsetPictures(prev => prev.filter(p => p.id !== picture.id))\r\n\t\tsetImageItems(prev => {\r\n\t\t\tconst next = new Map(prev)\r\n\t\t\tfor (const key of next.keys()) {\r\n\t\t\t\tif (key.startsWith(`${picture.id}::`)) {\r\n\t\t\t\t\tnext.delete(key)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn next\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleChoosePrivateKey = async (file: File) => {\r\n\t\ttry {\r\n\t\t\tconst text = await file.text()\r\n\t\t\tsetPrivateKey(text)\r\n\t\t\tawait handleSave()\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Failed to read private key:', error)\r\n\t\t\ttoast.error('读取密钥文件失败')\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSaveClick = () => {\r\n\t\tif (!isAuth) {\r\n\t\t\tkeyInputRef.current?.click()\r\n\t\t} else {\r\n\t\t\thandleSave()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSave = async () => {\r\n\t\tsetIsSaving(true)\r\n\r\n\t\ttry {\r\n\t\t\tawait pushPictures({\r\n\t\t\t\tpictures,\r\n\t\t\t\timageItems\r\n\t\t\t})\r\n\r\n\t\t\tsetOriginalPictures(pictures)\r\n\t\t\tsetImageItems(new Map())\r\n\t\t\tsetIsEditMode(false)\r\n\t\t\ttoast.success('保存成功！')\r\n\t\t} catch (error: any) {\r\n\t\t\tconsole.error('Failed to save:', error)\r\n\t\t\ttoast.error(`保存失败: ${error?.message || '未知错误'}`)\r\n\t\t} finally {\r\n\t\t\tsetIsSaving(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleCancel = () => {\r\n\t\tsetPictures(originalPictures)\r\n\t\tsetImageItems(new Map())\r\n\t\tsetIsEditMode(false)\r\n\t}\r\n\r\n\tconst buttonText = isAuth ? '保存' : '导入密钥'\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<input\r\n\t\t\t\tref={keyInputRef}\r\n\t\t\t\ttype='file'\r\n\t\t\t\taccept='.pem'\r\n\t\t\t\tclassName='hidden'\r\n\t\t\t\tonChange={async e => {\r\n\t\t\t\t\tconst f = e.target.files?.[0]\r\n\t\t\t\t\tif (f) await handleChoosePrivateKey(f)\r\n\t\t\t\t\tif (e.currentTarget) e.currentTarget.value = ''\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<div className='flex flex-col items-center justify-center px-6 pt-32 pb-12'>\r\n\t\t\t\t<div className='grid w-full max-w-[1200px] grid-cols-3 gap-6 max-lg:grid-cols-2 max-sm:grid-cols-1'>\r\n\t\t\t\t\t{pictures.map(picture => (\r\n\t\t\t\t\t\t<PictureCard key={picture.id} picture={picture} isEditMode={isEditMode} onDelete={() => handleDelete(picture)} />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{pictures.length === 0 && <div className='mt-16 text-center text-sm text-gray-500'>还没有上传图片，点击右上角「编辑」后即可开始上传。</div>}\r\n\t\t\t</div>\r\n\r\n\t\t\t<motion.div initial={{ opacity: 0, scale: 0.6 }} animate={{ opacity: 1, scale: 1 }} className='absolute top-4 right-6 flex gap-3 max-sm:hidden'>\r\n\t\t\t\t{isEditMode ? (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\t\tonClick={() => router.push('/image-toolbox')}\r\n\t\t\t\t\t\t\tclassName='rounded-xl border bg-blue-50 px-4 py-2 text-sm text-blue-700'>\r\n\t\t\t\t\t\t\t压缩工具\r\n\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\t\tonClick={handleCancel}\r\n\t\t\t\t\t\t\tdisabled={isSaving}\r\n\t\t\t\t\t\t\tclassName='rounded-xl border bg-white/60 px-6 py-2 text-sm'>\r\n\t\t\t\t\t\t\t取消\r\n\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\t\tonClick={() => setIsUploadDialogOpen(true)}\r\n\t\t\t\t\t\t\tclassName='rounded-xl border bg-white/60 px-6 py-2 text-sm'>\r\n\t\t\t\t\t\t\t上传\r\n\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t<motion.button whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }} onClick={handleSaveClick} disabled={isSaving} className='brand-btn px-6'>\r\n\t\t\t\t\t\t\t{isSaving ? '保存中...' : buttonText}\r\n\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t</>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\twhileHover={{ scale: 1.05 }}\r\n\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\tonClick={() => setIsEditMode(true)}\r\n\t\t\t\t\t\tclassName='rounded-xl border bg-white/60 px-6 py-2 text-sm backdrop-blur-sm transition-colors hover:bg-white/80'>\r\n\t\t\t\t\t\t编辑\r\n\t\t\t\t\t</motion.button>\r\n\t\t\t\t)}\r\n\t\t\t</motion.div>\r\n\r\n\t\t\t{isUploadDialogOpen && <UploadDialog onClose={() => setIsUploadDialogOpen(false)} onSubmit={handleUploadSubmit} />}\r\n\t\t</>\r\n\t)\r\n}\r\n"],"names":["useState","useRef","motion","toast","initialList","PictureCard","Picture","UploadDialog","pushPictures","useAuthStore","ImageItem","useRouter","Page","pictures","setPictures","originalPictures","setOriginalPictures","isEditMode","setIsEditMode","isSaving","setIsSaving","isUploadDialogOpen","setIsUploadDialogOpen","imageItems","setImageItems","Map","keyInputRef","HTMLInputElement","router","isAuth","setPrivateKey","handleUploadSubmit","images","description","now","Date","toISOString","length","error","id","Math","random","toString","slice","desc","trim","undefined","imageUrls","map","imageItem","type","url","previewUrl","newPicture","uploadedAt","newMap","forEach","index","set","prev","handleDelete","picture","confirm","filter","p","next","key","keys","startsWith","delete","handleChoosePrivateKey","file","File","text","handleSave","console","handleSaveClick","current","click","success","message","handleCancel","buttonText","e","f","target","files","currentTarget","value","opacity","scale","push"],"mappings":"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","ignoreList":[],"debugId":null}}]
}