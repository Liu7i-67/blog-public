module.exports=[89068,a=>{"use strict";var b=a.i(1937),c=a.i(56916),d=a.i(91434),e=a.i(43559);let f={slug:"",title:"",md:"",tags:[],date:new Date().toISOString().slice(0,10),summary:""},g=(0,b.create)((a,b)=>({mode:"create",originalSlug:null,setMode:(b,c)=>a({mode:b,originalSlug:c||null}),form:{...f},updateForm:b=>a(a=>({form:{...a.form,...b}})),setForm:b=>a({form:b}),images:[],addUrlImage:d=>{let{images:e}=b();if(e.some(a=>"url"===a.type&&a.url===d))return void c.toast.info("该图片已在列表中");let f=Math.random().toString(36).slice(2,10);a(a=>({images:[{id:f,type:"url",url:d},...a.images]}))},addFiles:async e=>{let{images:f}=b(),g=Array.from(e).filter(a=>a.type.startsWith("image/"));if(0===g.length)return[];let h=new Map(f.filter(a=>"file"===a.type&&a.hash).map(a=>[a.hash,a])),i=await Promise.all(g.map(async a=>{let b=await (0,d.hashFileSHA256)(a);return{file:a,hash:b}})),j=new Set,k=i.filter(({hash:a})=>!(h.has(a)||j.has(a))&&(j.add(a),!0)),l=[];for(let{hash:a}of i)h.has(a)&&l.push(h.get(a));if(k.length>0){let b=k.map(({file:a,hash:b})=>{let c=Math.random().toString(36).slice(2,10),d=URL.createObjectURL(a),e=a.name;return{id:c,type:"file",file:a,previewUrl:d,filename:e,hash:b}});a(a=>({images:[...b,...a.images]})),l.push(...b)}else 0===l.length&&c.toast.info("图片已存在，不重复添加");return l},deleteImage:b=>a(c=>{for(let d of c.images)"file"===d.type&&d.id===b&&(URL.revokeObjectURL(d.previewUrl),d.id===c.cover?.id&&a({cover:null}));return{images:c.images.filter(a=>a.id!==b)}}),cover:null,setCover:b=>a({cover:b}),loading:!1,setLoading:b=>a({loading:b}),loadBlogForEdit:async b=>{try{let d;a({loading:!0});let f=await (0,e.loadBlog)(b),g=[],h=/!\[.*?\]\((.*?)\)/g;for(;null!==(d=h.exec(f.markdown));){let a=d[1];if(a&&a!==f.cover&&!a.startsWith("local-image:")&&!g.some(b=>"url"===b.type&&b.url===a)){let b=Math.random().toString(36).slice(2,10);g.push({id:b,type:"url",url:a})}}let i=null;f.cover&&(i={id:Math.random().toString(36).slice(2,10),type:"url",url:f.cover}),a({mode:"edit",originalSlug:b,form:{slug:b,title:f.config.title||"",md:f.markdown,tags:f.config.tags||[],date:f.config.date||new Date().toISOString().slice(0,10),summary:f.config.summary||""},images:g,cover:i,loading:!1}),c.toast.success("博客加载成功")}catch(b){throw console.error("Failed to load blog:",b),c.toast.error(b?.message||"加载博客失败"),a({loading:!1}),b}},reset:()=>{let{images:c,cover:d}=b();for(let a of c)"file"===a.type&&URL.revokeObjectURL(a.previewUrl);d?.type==="file"&&URL.revokeObjectURL(d.previewUrl),a({mode:"create",originalSlug:null,form:{...f,date:new Date().toISOString().slice(0,10)},images:[],cover:null})}}));a.s(["useWriteStore",0,g])},69957,a=>{"use strict";let b=(0,a.i(1937).create)(a=>({isPreview:!1,openPreview:()=>a({isPreview:!0}),closePreview:()=>a({isPreview:!1}),togglePreview:()=>a(a=>({isPreview:!a.isPreview}))}));a.s(["usePreviewStore",0,b])},771,a=>{"use strict";var b=a.i(90053),c=a.i(94693),d=a.i(89068),e=a.i(76139),f=a.i(17396);let g="text";function h(){let{form:a,updateForm:h,images:i,addFiles:j}=(0,d.useWriteStore)(),k=(0,f.useRef)(null),l=a=>{let b=k.current;if(b&&(b.focus(),!document.execCommand("insertText",!1,a))){let{selectionStart:c,selectionEnd:d,value:e}=b;h({md:e.substring(0,c)+a+e.substring(d)}),setTimeout(()=>{b.setSelectionRange(c+a.length,c+a.length),b.focus()},0)}},m=async a=>{let b=a.clipboardData.items;if(!b)return;let c=[];for(let a=0;a<b.length;a++){let d=b[a];if(d.type.startsWith("image/")){let a=d.getAsFile();a&&c.push(a)}}if(c.length>0){a.preventDefault();let b=await j(c).catch(()=>[]);b&&b.length>0&&l(b.map(a=>"url"===a.type?`![](${a.url})`:`![](local-image:${a.id})`).join("\n"))}};return(0,b.jsxs)(c.motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:e.INIT_DELAY},className:"flex min-h-[800px] w-[800px] flex-col rounded-[40px] border bg-white/60 p-6 shadow",children:[(0,b.jsxs)("div",{className:"mb-3 flex gap-3",children:[(0,b.jsx)("input",{type:"text",placeholder:"标题",className:"flex-1 rounded-lg border bg-white/60 px-3 py-2 text-sm",value:a.title,onChange:a=>h({title:a.target.value})}),(0,b.jsx)("input",{type:"text",placeholder:"slug（xx-xx）",className:"w-[200px] rounded-lg border bg-white/60 px-3 py-2 text-sm",value:a.slug,onChange:a=>h({slug:a.target.value})})]}),(0,b.jsx)("textarea",{ref:k,placeholder:"Markdown 内容",className:"h-[650px] w-full flex-1 resize-none rounded-xl border bg-white/60 p-4 text-sm",value:a.md,onChange:a=>h({md:a.target.value}),onKeyDown:a=>{let b=k.current;if(!b)return;let{selectionStart:c,selectionEnd:d,value:e}=b,f=e.substring(c,d);if((a.ctrlKey||a.metaKey)&&"b"===a.key){a.preventDefault();let h=e.substring(0,c),i=e.substring(d);if(h.endsWith("**")&&i.startsWith("**")&&f)b.setSelectionRange(c-2,d+2),l(f);else{let a=f||g;l(`**${a}**`),f||setTimeout(()=>{b.setSelectionRange(c+2,c+2+g.length)},0)}return}if((a.ctrlKey||a.metaKey)&&"i"===a.key){a.preventDefault();let h=e.substring(0,c),i=e.substring(d);if(h.endsWith("*")&&i.startsWith("*")&&!(h.endsWith("**")&&i.startsWith("**"))&&f)b.setSelectionRange(c-1,d+1),l(f);else{let a=f||g;l(`*${a}*`),f||setTimeout(()=>{b.setSelectionRange(c+1,c+1+g.length)},0)}return}if((a.ctrlKey||a.metaKey)&&"k"===a.key){a.preventDefault();let d=f||g;l(`[${d}](url)`),setTimeout(()=>{let a=c+d.length+3;b.setSelectionRange(a,a+3)},0);return}if("Tab"===a.key&&!a.shiftKey){a.preventDefault(),l("	");return}if("Tab"===a.key&&a.shiftKey){a.preventDefault();let d=e.lastIndexOf("\n",c-1)+1,f=e.substring(d,e.indexOf("\n",c));f.startsWith("	")?(b.setSelectionRange(d,d+1),l("")):f.startsWith("  ")&&(b.setSelectionRange(d,d+2),l(""));return}},onPaste:m})]})}a.s(["WriteEditor",()=>h])},64067,a=>{"use strict";var b=a.i(90053),c=a.i(17396),d=a.i(94693),e=a.i(56916),f=a.i(89068);function g({delay:a=0}){let{images:g,setCover:h,cover:i,addFiles:j}=(0,f.useWriteStore)(),k=(0,c.useRef)(null),l=i?"url"===i.type?i.url:i.previewUrl:null,m=async a=>{a.preventDefault();let b=a.dataTransfer.getData("text/markdown")||a.dataTransfer.getData("text/plain")||"",c=/!\[\]\(([^)]+)\)/.exec(b.trim());if(c){let a,b=c[1];if(b.startsWith("local-image:")){let c=b.replace(/^local-image:/,"");a=g.find(a=>a.id===c)}else a=g.find(a=>"url"===a.type&&a.url===b);if(a){h(a),e.toast.success("已设置封面");return}}let d=a.dataTransfer.files;if(d&&d.length>0){let a=Array.from(d).filter(a=>a.type.startsWith("image/"));if(0===a.length)return void e.toast.error("请拖入图片文件");let b=await j(a);return void(b&&b.length>0&&(h(b[0]),e.toast.success("已设置封面")))}},n=async a=>{let b=a.target.files;if(!b||0===b.length)return;let c=await j(b);c&&c.length>0&&(h(c[0]),e.toast.success("已设置封面")),a.target.value=""};return(0,b.jsxs)(d.motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:a},className:"card relative",children:[(0,b.jsx)("h2",{className:"text-sm",children:"封面"}),(0,b.jsx)("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:n}),(0,b.jsx)("div",{className:"mt-3 h-[150px] overflow-hidden rounded-xl border bg-white/60",onDragOver:a=>{a.preventDefault()},onDrop:m,children:l?(0,b.jsx)("img",{src:l,alt:"cover preview",className:"h-full w-full rounded-2xl object-cover"}):(0,b.jsx)("div",{className:"grid h-full w-full cursor-pointer place-items-center transition-colors hover:bg-white/60",onClick:()=>{k.current?.click()},children:(0,b.jsx)("span",{className:"text-3xl leading-none text-neutral-400",children:"+"})})})]})}function h({tags:a,onChange:d}){let[e,f]=(0,c.useState)("");return(0,b.jsxs)("div",{className:"w-full rounded-lg border bg-white/70 px-3 py-2",children:[a.length>0&&(0,b.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:a.map((c,e)=>(0,b.jsxs)("span",{className:"flex items-center gap-1.5 rounded-md bg-blue-100 px-2 py-1 text-sm text-blue-700",children:["#",c,(0,b.jsx)("button",{type:"button",onClick:()=>{d(a.filter((a,b)=>b!==e))},className:"text-secondary",children:"×"})]},e))}),(0,b.jsx)("input",{type:"text",placeholder:"添加标签（按回车）",className:"w-full bg-transparent text-sm outline-none",value:e,onChange:a=>f(a.target.value),onKeyDown:b=>{"Enter"===b.key&&(b.preventDefault(),e.trim()&&!a.includes(e.trim())&&(d([...a,e.trim()]),f("")))}})]})}function i({delay:a=0}){let{form:c,updateForm:e}=(0,f.useWriteStore)();return(0,b.jsxs)(d.motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:a},className:"card relative",children:[(0,b.jsx)("h2",{className:"text-sm",children:"元信息"}),(0,b.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,b.jsx)("textarea",{placeholder:"为这篇文章写一段简短摘要",rows:2,className:"block w-full resize-none rounded-xl border bg-white/60 p-3 text-sm",value:c.summary,onChange:a=>e({summary:a.target.value})}),(0,b.jsx)(h,{tags:c.tags,onChange:a=>e({tags:a})}),(0,b.jsx)("input",{type:"date",placeholder:"日期",className:"w-full rounded-lg border bg-white/60 px-3 py-2 text-sm",value:c.date,onChange:a=>e({date:a.target.value})})]})]})}var j=a.i(29896);function k({delay:a=0}){let{images:e,cover:g,addUrlImage:h,addFiles:i,deleteImage:k}=(0,f.useWriteStore)(),[l,m]=(0,c.useState)(""),n=(0,c.useRef)(null),o=g?.id??null;return(0,b.jsxs)(d.motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:a},className:"card relative",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-sm",children:"图片管理"}),(0,b.jsx)(j.default,{href:"/image-toolbox",target:"_blank",className:"text-xs hover:underline",children:"压缩工具"})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,b.jsx)("input",{type:"text",placeholder:"https://...",className:"flex-1 rounded-lg border bg-white/70 px-3 py-2 text-sm",value:l,onChange:a=>m(a.target.value)}),(0,b.jsx)("button",{className:"rounded-lg border bg-white/70 px-3 py-2 text-sm",onClick:()=>{let a=l.trim();a&&(h(a),m(""))},children:"添加"})]}),(0,b.jsx)("input",{ref:n,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:a=>{let b=a.target.files;b&&b.length>0&&i(b),a.currentTarget&&(a.currentTarget.value="")}}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-4 gap-2",children:[(0,b.jsx)("div",{className:"group relative grid aspect-square cursor-pointer place-items-center rounded-lg border bg-white/50 hover:bg-white/70",onClick:()=>n.current?.click(),onDragOver:a=>{a.preventDefault()},onDrop:a=>{a.preventDefault();let b=a.dataTransfer.files;b&&b.length&&i(b)},children:(0,b.jsx)("span",{className:"text-2xl leading-none text-neutral-400",children:"+"})}),e.map(a=>{let c="url"===a.type,d=c?a.url:a.previewUrl,e=c?`![](${a.url})`:`![](local-image:${a.id})`,f=o===a.id;return(0,b.jsxs)("div",{className:`group relative aspect-square overflow-hidden rounded-lg border bg-white/50 text-xs ${f?"ring-2 ring-blue-500":""}`,children:[(0,b.jsx)("img",{src:d,className:"h-full w-full object-cover",draggable:!0,onDragStart:a=>{a.dataTransfer.setData("text/plain",e),a.dataTransfer.setData("text/markdown",e)}}),f&&(0,b.jsx)("div",{className:"absolute top-1 left-1 rounded-md bg-blue-500 px-1.5 py-0.5 text-white shadow",children:"封面"}),(0,b.jsx)("div",{className:"absolute top-1 right-1 hidden group-hover:flex",children:(0,b.jsx)("button",{type:"button",className:"rounded-md bg-white/80 px-1.5 py-0.5 shadow hover:bg-white",onClick:()=>k(a.id),children:"删除"})})]},a.id)})]})]})}var l=a.i(76139);function m(){return(0,b.jsxs)("div",{className:"w-[320px] space-y-6",children:[(0,b.jsx)(g,{delay:l.INIT_DELAY+0*l.ANIMATION_DELAY}),(0,b.jsx)(i,{delay:l.INIT_DELAY+ +l.ANIMATION_DELAY}),(0,b.jsx)(k,{delay:l.INIT_DELAY+2*l.ANIMATION_DELAY})]})}a.s(["WriteSidebar",()=>m],64067)},95637,a=>{"use strict";var b=a.i(90053),c=a.i(94693),d=a.i(17396),e=a.i(56916),f=a.i(89068),g=a.i(69957),h=a.i(91434),i=a.i(7565),j=a.i(17347),k=a.i(63672),l=a.i(76139),m=a.i(68114);async function n(a){let b,{form:c,cover:d,images:f,mode:g="create",originalSlug:n}=a;if(!c?.slug)throw Error("需要 slug");if("edit"===g&&n&&n!==c.slug)throw Error("编辑模式下不支持修改 slug，请保持原 slug 不变");let o=await (0,k.getAuthToken)();e.toast.info("正在获取分支信息...");let p=(await (0,i.getRef)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,`heads/${l.GITHUB_CONFIG.BRANCH}`)).sha,q=`public/blogs/${c.slug}`,r="edit"===g?`更新文章: ${c.slug}`:`新增文章: ${c.slug}`,s=[];for(let a of f||[])"file"===a.type&&s.push({img:a,id:a.id});d?.type==="file"&&s.push({img:d,id:d.id}),e.toast.info("正在准备文件...");let t=new Set,u=c.md,v=[];if(s.length>0)for(let{img:a,id:f}of(e.toast.info("正在上传图片..."),s)){let e=a.hash||await (0,h.hashFileSHA256)(a.file),g=(0,m.getFileExt)(a.file.name),j=`${e}${g}`,k=`/blogs/${c.slug}/${j}`;if(!t.has(e)){let b=`${q}/${j}`,c=await (0,h.fileToBase64NoPrefix)(a.file),d=await (0,i.createBlob)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,c,"base64");v.push({path:b,mode:"100644",type:"blob",sha:d.sha}),t.add(e)}let n=`local-image:${f}`;u=u.split(`(${n})`).join(`(${k})`),d?.type==="file"&&d.id===f&&(b=k)}d?.type==="url"&&(b=d.url),e.toast.info("正在创建文件...");let w=await (0,i.createBlob)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,(0,i.toBase64Utf8)(u),"base64");v.push({path:`${q}/index.md`,mode:"100644",type:"blob",sha:w.sha});let x=c.date||new Date().toISOString().slice(0,10),y={title:c.title,tags:c.tags,date:x,summary:c.summary,cover:b},z=await (0,i.createBlob)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,(0,i.toBase64Utf8)(JSON.stringify(y,null,2)),"base64");v.push({path:`${q}/config.json`,mode:"100644",type:"blob",sha:z.sha});let A=await (0,j.prepareBlogsIndex)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,{slug:c.slug,title:c.title,tags:c.tags,date:x,summary:c.summary,cover:b},l.GITHUB_CONFIG.BRANCH),B=await (0,i.createBlob)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,(0,i.toBase64Utf8)(A),"base64");v.push({path:"public/blogs/index.json",mode:"100644",type:"blob",sha:B.sha}),e.toast.info("正在创建文件树...");let C=await (0,i.createTree)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,v,p);e.toast.info("正在创建提交...");let D=await (0,i.createCommit)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,r,C.sha,[p]);e.toast.info("正在更新分支..."),await (0,i.updateRef)(o,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,`heads/${l.GITHUB_CONFIG.BRANCH}`,D.sha),e.toast.success("发布成功！")}async function o(a){if(!a)throw Error("需要 slug");let b=await (0,k.getAuthToken)();e.toast.info("正在获取分支信息...");let c=(await (0,i.getRef)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,`heads/${l.GITHUB_CONFIG.BRANCH}`)).sha,d=`public/blogs/${a}`;e.toast.info("正在收集文章文件...");let f=await (0,i.listRepoFilesRecursive)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,d,l.GITHUB_CONFIG.BRANCH);if(0===f.length)throw Error("文章不存在或已删除");let g=f.map(a=>({path:a,mode:"100644",type:"blob",sha:null}));e.toast.info("正在更新索引...");let h=await (0,j.removeBlogFromIndex)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,a,l.GITHUB_CONFIG.BRANCH),m=await (0,i.createBlob)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,(0,i.toBase64Utf8)(h),"base64");g.push({path:"public/blogs/index.json",mode:"100644",type:"blob",sha:m.sha}),e.toast.info("正在创建提交...");let n=await (0,i.createTree)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,g,c),o=await (0,i.createCommit)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,`删除文章: ${a}`,n.sha,[c]);e.toast.info("正在更新分支..."),await (0,i.updateRef)(b,l.GITHUB_CONFIG.OWNER,l.GITHUB_CONFIG.REPO,`heads/${l.GITHUB_CONFIG.BRANCH}`,o.sha),e.toast.success("删除成功！请等待页面部署后刷新")}var p=a.i(47507);function q(){let{loading:a,mode:i,form:j}=(0,f.useWriteStore)(),{openPreview:k}=(0,g.usePreviewStore)(),{isAuth:l,onChoosePrivateKey:m,onPublish:q,onDelete:r}=function(){let{loading:a,setLoading:b,form:c,cover:g,images:i,mode:j,originalSlug:k}=(0,f.useWriteStore)(),{isAuth:l,setPrivateKey:m}=(0,p.useAuthStore)(),q=(0,d.useCallback)(async a=>{m(await (0,h.readFileAsText)(a))},[m]),r=(0,d.useCallback)(async()=>{try{b(!0),await n({form:c,cover:g,images:i,mode:j,originalSlug:k});let a="edit"===j?"更新成功":"发布成功";e.toast.success(a)}catch(a){console.error(a),e.toast.error(a?.message||"操作失败")}finally{b(!1)}},[c,g,i,j,k,b]);return{isAuth:l,loading:a,onChoosePrivateKey:q,onPublish:r,onDelete:(0,d.useCallback)(async()=>{let a=k||c.slug;if(!a)return void e.toast.error("缺少 slug，无法删除");try{b(!0),await o(a)}catch(a){console.error(a),e.toast.error(a?.message||"删除失败")}finally{b(!1)}},[c.slug,k,b])}}(),s=(0,d.useRef)(null);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{ref:s,type:"file",accept:".pem",className:"hidden",onChange:async a=>{let b=a.target.files?.[0];b&&await m(b),a.currentTarget&&(a.currentTarget.value="")}}),(0,b.jsxs)("ul",{className:"absolute top-4 right-6 flex items-center gap-2",children:["edit"===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.motion.div,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:(0,b.jsx)("div",{className:"rounded-lg border bg-blue-50 px-4 py-2 text-sm text-blue-700",children:"编辑模式"})}),(0,b.jsx)(c.motion.button,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600 transition-colors hover:bg-red-100",disabled:a,onClick:()=>{if(!l)return void e.toast.info("请先导入密钥");let a=j?.title?`确定删除《${j.title}》吗？该操作不可恢复。`:"确定删除当前文章吗？该操作不可恢复。";window.confirm(a)&&r()},children:"删除"})]}),(0,b.jsx)(c.motion.button,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"rounded-xl border bg-white/60 px-6 py-2 text-sm",disabled:a,onClick:k,children:"预览"}),(0,b.jsx)(c.motion.button,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"brand-btn px-6",disabled:a,onClick:()=>{l?q():s.current?.click()},children:l?"edit"===i?"更新":"发布":"导入密钥"})]})]})}a.s(["WriteActions",()=>q],95637)},70855,a=>{"use strict";var b=a.i(17396),c=a.i(48429),d=a.i(89068);function e(){let{form:a,images:e}=(0,d.useWriteStore)(),f=(0,b.useMemo)(()=>{let b=a.md;for(let a of e)if("file"===a.type){let c=`local-image:${a.id}`;b=b.split(`(${c})`).join(`(${a.previewUrl})`)}return b},[a.md,e]);return{markdown:f,title:a.title||"Untitled",date:(0,c.default)(a.date).format("YYYY年 M月 D日")}}a.s(["useWriteData",()=>e])},17362,a=>a.a(async(b,c)=>{try{var d=a.i(90053),e=a.i(94693),f=a.i(39554),g=a.i(70855),h=b([f]);function i({form:a,coverPreviewUrl:b,onClose:c,slug:h}){let i=(0,g.useWriteData)();return(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{onClick:a=>a.stopPropagation(),children:(0,d.jsx)(f.BlogPreview,{markdown:i.markdown,title:i.title,tags:a.tags,date:i.date,summary:a.summary,cover:b||void 0,slug:h})}),(0,d.jsx)(e.motion.button,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"absolute top-4 right-6 rounded-xl border bg-white/60 px-6 py-2 text-sm",onClick:c,children:"关闭预览"})]})}[f]=h.then?(await h)():h,a.s(["WritePreview",()=>i]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=src_app_write_1128015f._.js.map