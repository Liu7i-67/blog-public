module.exports=[70697,(a,b,c)=>{a.e,b.exports=function(a){"use strict";var b={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(a,b){return"W"===b?a+"周":a+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(a,b){var c=100*a+b;return c<600?"凌晨":c<900?"早上":c<1100?"上午":c<1300?"中午":c<1800?"下午":"晚上"}};return(a&&"object"==typeof a&&"default"in a?a:{default:a}).default.locale(b,null,!0),b}(a.r(48429))},63370,a=>{"use strict";var b,c,d,e=a.i(90053),f=a.i(37366),g=a.i(93824),h=a.i(33498);function i(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),c=b.hiCard,d=null!==c.offsetX?a.x+c.offsetX:a.x,i=null!==c.offsetY?a.y+c.offsetY:a.y;return(0,e.jsxs)(g.default,{order:c.order,width:c.width,height:c.height,x:d,y:i,className:"-translate-1/2 text-center max-sm:static max-sm:translate-0",children:[(0,e.jsx)("img",{src:"/images/avatar.png",className:"mx-auto rounded-full",style:{width:120,height:120,boxShadow:" 0 16px 32px -5px #E2D9CE"}}),(0,e.jsxs)("h1",{className:"font-averia mt-3 text-2xl",children:[(0,e.jsx)("span",{className:"text-linear text-[32px]",children:"柒书"})," ",(0,e.jsx)("br",{})," 活到老，玩到老"]})]})}var j=a.i(76139),k=a.i(45763);function l(){let a=(0,f.useCenterStore)(),{cardStyles:b,siteContent:c}=(0,h.useConfigStore)(),d=(0,k.useRouter)(),i=b.artCard,l=b.hiCard,m=null!==i.offsetX?a.x+i.offsetX:a.x,n=null!==i.offsetY?a.y+i.offsetY:a.y-l.height/2-i.height/2-j.CARD_SPACING,o=c.artImages??[],p=c.currentArtImageId,q=(p?o.find(a=>a.id===p):void 0)??o[0],r=q?.url||"/images/art/cat.png";return(0,e.jsx)(g.default,{className:"-translate-1/2 p-2 max-sm:static max-sm:translate-0",order:i.order,width:i.width,height:i.height,x:m,y:n,children:(0,e.jsx)("img",{onClick:()=>d.push("/pictures"),src:r,alt:"wall art",className:"h-full w-full rounded-[32px] object-cover"})})}var m=a.i(17396);function n(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),[c,d]=(0,m.useState)(new Date),i=b.clockCard,k=b.hiCard;(0,m.useEffect)(()=>{let a=setInterval(()=>{d(new Date)},5e3);return()=>clearInterval(a)},[]);let l=c.getHours().toString().padStart(2,"0"),n=c.getMinutes().toString().padStart(2,"0"),q=null!==i.offsetX?a.x+i.offsetX:a.x+j.CARD_SPACING+k.width/2,r=null!==i.offsetY?a.y+i.offsetY:a.y-i.offset-i.height;return(0,e.jsx)(g.default,{order:i.order,width:i.width,height:i.height,x:q,y:r,className:"p-2",children:(0,e.jsxs)("div",{className:"bg-secondary/20 flex h-full w-full items-center justify-center gap-1.5 rounded-4xl",children:[(0,e.jsx)(o,{value:parseInt(l[0])}),(0,e.jsx)(o,{value:parseInt(l[1])}),(0,e.jsx)(p,{}),(0,e.jsx)(o,{value:parseInt(n[0])}),(0,e.jsx)(o,{value:parseInt(n[1])})]})})}function o({value:a,className:b}){let c={0:[!0,!0,!0,!0,!0,!0,!1],1:[!1,!0,!0,!1,!1,!1,!1],2:[!0,!0,!1,!0,!0,!1,!0],3:[!0,!0,!0,!0,!1,!1,!0],4:[!1,!0,!0,!1,!1,!0,!0],5:[!0,!1,!0,!0,!1,!0,!0],6:[!0,!1,!0,!0,!0,!0,!0],7:[!0,!0,!0,!1,!1,!1,!1],8:[!0,!0,!0,!0,!0,!0,!0],9:[!0,!0,!0,!0,!1,!0,!0]},d=c[a]||c[0],f="var(--color-primary)",g="rgba(0, 0, 0, 0.05)";return(0,e.jsxs)("svg",{width:"29",height:"52",viewBox:"0 0 29 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:b,children:[(0,e.jsx)("path",{d:"M4.20248 3.49482C2.82797 2.27303 3.69218 0 5.53121 0H22.6867C24.5522 0 25.4019 2.32821 23.975 3.52982L23.5791 3.86316C23.2186 4.16681 22.7623 4.33333 22.2909 4.33333H5.90621C5.41638 4.33333 4.94359 4.15358 4.57748 3.82815L4.20248 3.49482Z",fill:d[0]?f:g}),(0,e.jsx)("path",{d:"M3.85122 24.13C4.16644 23.936 4.5293 23.8333 4.89942 23.8333H23.3022C23.6503 23.8333 23.9923 23.9242 24.2945 24.0969L24.5862 24.2635C25.9298 25.0313 25.9298 26.9687 24.5862 27.7365L24.2945 27.9032C23.9923 28.0758 23.6503 28.1667 23.3022 28.1667H4.89942C4.5293 28.1667 4.16644 28.064 3.85122 27.87L3.58039 27.7033C2.31131 26.9224 2.31132 25.0777 3.58039 24.2967L3.85122 24.13Z",fill:d[6]?f:g}),(0,e.jsx)("path",{d:"M3.06 23.5458C1.7279 24.3784 -8.31295e-08 23.4207 -1.47217e-07 21.8498L-8.06095e-07 5.69981C-8.77526e-07 3.94893 2.09055 3.04323 3.36788 4.24073L3.70121 4.55323C4.10452 4.93133 4.33333 5.45949 4.33333 6.01231L4.33333 21.6415C4.33333 22.3311 3.97809 22.972 3.39333 23.3375L3.06 23.5458Z",fill:d[5]?f:g}),(0,e.jsx)("path",{d:"M24.8497 4.25654C26.1428 3.12502 28.1667 4.04338 28.1667 5.76169L28.1667 21.8498C28.1667 23.4207 26.4388 24.3784 25.1067 23.5458L24.7734 23.3375C24.1886 22.972 23.8334 22.3311 23.8334 21.6415L23.8334 6.05336C23.8334 5.47663 24.0823 4.92798 24.5163 4.54821L24.8497 4.25654Z",fill:d[1]?f:g}),(0,e.jsx)("path",{d:"M23.9259 48.6321C25.1234 49.9094 24.2177 52 22.4669 52L5.69978 52C3.9489 52 3.04321 49.9094 4.24071 48.6321L4.55321 48.2988C4.9313 47.8955 5.45947 47.6667 6.01228 47.6667L22.1544 47.6667C22.7072 47.6667 23.2353 47.8955 23.6134 48.2988L23.9259 48.6321Z",fill:d[3]?f:g}),(0,e.jsx)("path",{d:"M25.1862 28.489C26.5194 27.7391 28.1667 28.7025 28.1667 30.2322L28.1667 46.6299C28.1667 48.4117 26.0124 49.3041 24.7525 48.0441L24.4191 47.7108C24.0441 47.3357 23.8334 46.827 23.8334 46.2966L23.8334 30.4197C23.8334 29.6971 24.2231 29.0308 24.8528 28.6765L25.1862 28.489Z",fill:d[2]?f:g}),(0,e.jsx)("path",{d:"M3.4564 47.7859C2.21509 49.1048 4.23823e-07 48.2263 6.6133e-07 46.4152L2.79423e-06 30.1501C3.00022e-06 28.5793 1.72791 27.6216 3.06 28.4541L3.39333 28.6625C3.9781 29.028 4.33334 29.6689 4.33334 30.3585L4.33333 46.061C4.33333 46.5705 4.13891 47.0607 3.78973 47.4317L3.4564 47.7859Z",fill:d[4]?f:g})]})}function p({className:a}){return(0,e.jsxs)("div",{className:`flex flex-col justify-center gap-2 ${a}`,children:[(0,e.jsx)("div",{className:"bg-primary h-1.5 w-1.5"}),(0,e.jsx)("div",{className:"bg-primary h-1.5 w-1.5"})]})}var q=a.i(48429);a.i(70697);var r=a.i(68114);function s(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),c=(0,q.default)(),d=c.date(),i=(c.startOf("month").day()+6)%7,k=c.daysInMonth(),l=(c.day()+6)%7,m=b.calendarCard,n=b.hiCard,o=b.clockCard,p=null!==m.offsetX?a.x+m.offsetX:a.x+j.CARD_SPACING+n.width/2,s=null!==m.offsetY?a.y+m.offsetY:a.y-o.offset+j.CARD_SPACING;return(0,e.jsxs)(g.default,{order:m.order,width:m.width,height:m.height,x:p,y:s,children:[(0,e.jsxs)("h3",{className:"text-secondary text-sm",children:[c.format("YYYY/M/D")," ",c.format("ddd")]}),(0,e.jsxs)("ul",{className:"text-secondary mt-3 grid h-[206px] grid-cols-7 gap-2 text-sm",children:[Array(7).fill(0).map((a,b)=>(0,e.jsx)("li",{className:(0,r.cn)("flex items-center justify-center font-medium",b===l&&"text-brand"),children:t[b]},b)),Array(i).fill(0).map((a,b)=>(0,e.jsx)("li",{},`empty-${b}`)),Array(k).fill(0).map((a,b)=>{let c=b+1,f=c===d;return(0,e.jsx)("li",{className:(0,r.cn)("flex items-center justify-center rounded-lg",f&&"bg-linear border font-medium"),children:c},c)})]})]})}q.default.locale("zh-cn");let t=["一","二","三","四","五","六","日"];var u=a.i(65097),v=a.i(94681);function w(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),c=b.musicCard,d=b.hiCard,i=b.clockCard,k=b.calendarCard,l=null!==c.offsetX?a.x+c.offsetX:a.x+j.CARD_SPACING+d.width/2-c.offset,m=null!==c.offsetY?a.y+c.offsetY:a.y-i.offset+j.CARD_SPACING+k.height+j.CARD_SPACING;return(0,e.jsxs)(g.default,{order:c.order,width:c.width,height:c.height,x:l,y:m,className:"flex items-center gap-3",children:[(0,e.jsx)(u.default,{className:"h-8 w-8"}),(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)("div",{className:"text-secondary text-sm",children:"随机音乐"}),(0,e.jsx)("div",{className:"mt-1 h-2 rounded-full bg-white/60",children:(0,e.jsx)("div",{className:"bg-linear h-full w-1/2 rounded-full"})})]}),(0,e.jsx)("button",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-white",children:(0,e.jsx)(v.default,{className:"text-brand ml-1 h-4 w-4"})})]})}var x=a.i(57663);function y(){return(y=Object.assign.bind()).apply(null,arguments)}let z=function(a){return m.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",width:220.508,height:200,className:"bilibili_svg__icon",viewBox:"0 0 1129 1024"},a),b||(b=m.createElement("path",{fill:"#20B0E3",d:"M234.909 9.656a80.47 80.47 0 0 1 68.398 0 167.4 167.4 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a169 169 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.47 80.47 0 0 1-17.703 53.914 450 450 0 0 1-35.406 32.187 233 233 0 0 1-22.531 18.508h100.585a170.6 170.6 0 0 1 118.289 53.109 171.4 171.4 0 0 1 53.914 118.288v462.693a326 326 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173 173 0 0 1-92.539 25.75h-738.7a341.2 341.2 0 0 1-72.421-4.024A177.84 177.84 0 0 1 28.91 939.065a172.2 172.2 0 0 1-27.36-92.539V388.662a360.5 360.5 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.47 80.47 0 0 1-25.75-65.984 80.47 80.47 0 0 1 39.43-63.57M216.4 321.873a80.47 80.47 0 0 0-63.57 57.937 108.6 108.6 0 0 0 0 30.578v380.615a80.47 80.47 0 0 0 55.523 80.469 106.2 106.2 0 0 0 34.601 5.632h654.208a80.47 80.47 0 0 0 76.444-47.476 112.66 112.66 0 0 0 8.047-53.109v-354.06a135.2 135.2 0 0 0 0-38.625 80.47 80.47 0 0 0-52.304-54.719 129.6 129.6 0 0 0-49.89-7.242H254.22a269 269 0 0 0-37.82 0m0 0"})),c||(c=m.createElement("path",{fill:"#20B0E3",d:"M348.369 447.404a80.47 80.47 0 0 1 55.523 18.507 80.47 80.47 0 0 1 28.164 59.547v80.468a80.47 80.47 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.6 104.6 0 0 1-10.46-54.719v-80.468a80.47 80.47 0 0 1 70.007-67.593zm416.02 0a80.47 80.47 0 0 1 86.102 75.64v80.468a94.15 94.15 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.76 95.76 0 0 1-12.875-57.133V519.02a80.47 80.47 0 0 1 70.007-70.812zm0 0"})))};var A=a.i(82407),B=a.i(94693),C=a.i(56916),D=a.i(57066);let E=100;function F(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),{maxSM:c,init:d}=(0,D.useSize)(),g=b.socialButtons,i=b.hiCard,k=g.order;c&&d&&(k=0,E=0);let[l,n]=(0,m.useState)(!1),[o,p]=(0,m.useState)(!1),[q,r]=(0,m.useState)(!1);(0,m.useEffect)(()=>{setTimeout(()=>n(!0),k*j.ANIMATION_DELAY*1e3),setTimeout(()=>p(!0),k*j.ANIMATION_DELAY*1e3+ +E),setTimeout(()=>r(!0),k*j.ANIMATION_DELAY*1e3+2*E)},[k]);let s=null!==g.offsetX?a.x+g.offsetX:a.x+i.width/2,t=null!==g.offsetY?a.y+g.offsetY:a.y+i.height/2+j.CARD_SPACING;return l?(0,e.jsx)(B.motion.div,{className:"absolute max-sm:static",animate:{left:s,top:t},initial:{left:s,top:t},children:(0,e.jsxs)("div",{className:"absolute top-0 right-0 flex items-center gap-3 max-sm:static",children:[q&&(0,e.jsxs)(B.motion.a,{href:"https://github.com/Liu7i-67",target:"_blank",initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"font-averia flex items-center gap-2 rounded-xl border bg-[#070707] px-3 py-2 text-xl text-white",style:{boxShadow:" inset 0 0 12px rgba(255, 255, 255, 0.4)"},children:[(0,e.jsx)(x.default,{}),"Github"]}),o&&(0,e.jsxs)(B.motion.a,{href:"https://space.bilibili.com/189975021",target:"_blank",initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"card relative flex items-center gap-2 rounded-xl px-3 py-2.5 font-medium whitespace-nowrap",children:[(0,e.jsx)(z,{className:"h-6 w-6"}),"哔哩哔哩"]}),(0,e.jsx)(B.motion.button,{onClick:()=>{navigator.clipboard.writeText("liu67iq@gmail.com").then(()=>{C.toast.success("邮箱已复制到剪贴板")})},initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"card btn relative rounded-xl p-1.5",children:(0,e.jsx)(A.default,{})})]})}):null}var G=a.i(92609),H=a.i(29896);function I(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),[c,d]=(0,m.useState)(null),i=b.shareCard,k=b.hiCard,l=b.socialButtons;if((0,m.useEffect)(()=>{let a=Math.floor(Math.random()*G.default.length);d(G.default[a])},[]),!c)return null;let n=null!==i.offsetX?a.x+i.offsetX:a.x+k.width/2-l.width,o=null!==i.offsetY?a.y+i.offsetY:a.y+k.height/2+j.CARD_SPACING+l.height+j.CARD_SPACING;return(0,e.jsxs)(g.default,{order:i.order,width:i.width,x:n,y:o,children:[(0,e.jsx)("h2",{className:"text-secondary text-sm",children:"随机推荐"}),(0,e.jsxs)(H.default,{href:"/share",className:"mt-2 block space-y-2",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"relative mr-3 h-12 w-12 shrink-0 overflow-hidden rounded-xl",children:(0,e.jsx)("img",{src:c.logo,alt:c.name,className:"h-full w-full object-contain"})}),(0,e.jsx)("h3",{className:"text-sm font-medium",children:c.name})]}),(0,e.jsx)("p",{className:"text-secondary line-clamp-3 text-xs",children:c.description})]})]})}var J=a.i(20197);function K(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),{blog:c,loading:d}=(0,J.useLatestBlog)(),i=b.articleCard,k=b.hiCard,l=b.socialButtons,m=null!==i.offsetX?a.x+i.offsetX:a.x+k.width/2-l.width-j.CARD_SPACING-i.width,n=null!==i.offsetY?a.y+i.offsetY:a.y+k.height/2+j.CARD_SPACING;return(0,e.jsxs)(g.default,{order:i.order,width:i.width,x:m,y:n,className:"space-y-2 max-sm:static",children:[(0,e.jsx)("h2",{className:"text-secondary text-sm",children:"最新文章"}),d?(0,e.jsx)("div",{className:"flex h-[60px] items-center justify-center",children:(0,e.jsx)("span",{className:"text-secondary text-xs",children:"加载中..."})}):c?(0,e.jsxs)(H.default,{href:`/blog/${c.slug}`,className:"flex transition-opacity hover:opacity-80",children:[c.cover?(0,e.jsx)("img",{src:c.cover,alt:"cover",className:"mr-3 h-12 w-12 shrink-0 rounded-xl border object-cover"}):(0,e.jsx)("div",{className:"text-secondary mr-3 grid h-12 w-12 shrink-0 place-items-center rounded-xl bg-white/60",children:"+"}),(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)("h3",{className:"line-clamp-1 text-sm font-medium",children:c.title||c.slug}),c.summary&&(0,e.jsx)("p",{className:"text-secondary mt-1 line-clamp-3 text-xs",children:c.summary}),(0,e.jsx)("p",{className:"text-secondary mt-3 text-xs",children:(0,q.default)(c.date).format("YYYY/M/D")})]})]}):(0,e.jsx)("div",{className:"flex h-[60px] items-center justify-center",children:(0,e.jsx)("span",{className:"text-secondary text-xs",children:"暂无文章"})})]})}var L=a.i(29873);function M(){return(M=Object.assign.bind()).apply(null,arguments)}let N=function(a){return m.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 32"},a),d||(d=m.createElement("path",{fill:"#fff",fillOpacity:.8,d:"M16 23.333a2 2 0 1 1 0 4.001 2 2 0 0 1 0-4m9.333 0a2 2 0 1 1 0 4.001 2 2 0 0 1 0-4m-18.666 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4M16 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4m9.333 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4M6.667 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4M16 4.667a2 2 0 1 1 0 4 2 2 0 0 1 0-4m9.333 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4m-18.666 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4"})))};var O=a.i(73528),P=a.i(47507),Q=a.i(7565),R=a.i(63672),S=a.i(91434);async function T(a,b,c,d,e,f){let g=await (0,R.getAuthToken)();C.toast.info("正在获取分支信息...");let h=(await (0,Q.getRef)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,`heads/${j.GITHUB_CONFIG.BRANCH}`)).sha,i=`更新站点配置`;C.toast.info("正在准备文件...");let k=[];if(c?.type==="file"){C.toast.info("正在上传 Favicon...");let a=await (0,S.fileToBase64NoPrefix)(c.file),b=await (0,Q.createBlob)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,a,"base64");k.push({path:"public/favicon.png",mode:"100644",type:"blob",sha:b.sha})}if(d?.type==="file"){C.toast.info("正在上传 Avatar...");let a=await (0,S.fileToBase64NoPrefix)(d.file),b=await (0,Q.createBlob)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,a,"base64");k.push({path:"public/images/avatar.png",mode:"100644",type:"blob",sha:b.sha})}if(e)for(let[b,c]of Object.entries(e)){if("file"!==c.type)continue;let d=a.artImages?.find(a=>a.id===b);if(!d)continue;let e=d.url.startsWith("/")?d.url:`/${d.url}`,f=`public${e}`;if(!f)continue;C.toast.info(`正在上传 Art 图片 ${b}...`);let h=await (0,S.fileToBase64NoPrefix)(c.file),i=await (0,Q.createBlob)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,h,"base64");k.push({path:f,mode:"100644",type:"blob",sha:i.sha})}if(f&&f.length>0)for(let a of f){let b=a.url.startsWith("/")?a.url:`/${a.url}`,c=`public${b}`;k.push({path:c,mode:"100644",type:"blob",sha:null})}let l=JSON.stringify(a,null,"	"),m=await (0,Q.createBlob)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,(0,Q.toBase64Utf8)(l),"base64");k.push({path:"src/config/site-content.json",mode:"100644",type:"blob",sha:m.sha});let n=JSON.stringify(b,null,"	"),o=await (0,Q.createBlob)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,(0,Q.toBase64Utf8)(n),"base64");k.push({path:"src/config/card-styles.json",mode:"100644",type:"blob",sha:o.sha}),C.toast.info("正在创建文件树...");let p=await (0,Q.createTree)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,k,h);C.toast.info("正在创建提交...");let q=await (0,Q.createCommit)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,i,p.sha,[h]);C.toast.info("正在更新分支..."),await (0,Q.updateRef)(g,j.GITHUB_CONFIG.OWNER,j.GITHUB_CONFIG.REPO,`heads/${j.GITHUB_CONFIG.BRANCH}`,q.sha),C.toast.success("保存成功！")}function U({formData:a,setFormData:b,faviconItem:c,setFaviconItem:d,avatarItem:f,setAvatarItem:g,artImageUploads:h,setArtImageUploads:i}){let j=(0,m.useRef)(null),k=(0,m.useRef)(null),l=(0,m.useRef)(null),n=async a=>{let b=a.target.files?.[0];if(!b)return;if(!b.type.startsWith("image/"))return void C.toast.error("请选择图片文件");let c=await (0,S.hashFileSHA256)(b),e=URL.createObjectURL(b);d({type:"file",file:b,previewUrl:e,hash:c}),a.currentTarget&&(a.currentTarget.value="")},o=async a=>{let b=a.target.files?.[0];if(!b)return;if(!b.type.startsWith("image/"))return void C.toast.error("请选择图片文件");let c=await (0,S.hashFileSHA256)(b),d=URL.createObjectURL(b);g({type:"file",file:b,previewUrl:d,hash:c}),a.currentTarget&&(a.currentTarget.value="")},p=async a=>{let c=Array.from(a.target.files||[]);if(c.length){for(let a of c){if(!a.type.startsWith("image/")){C.toast.error("请选择图片文件");continue}let c=await (0,S.hashFileSHA256)(a),d=a.name.split(".").pop()||"png",e=`/images/art/${c}.${d}`,f=URL.createObjectURL(a);i(b=>({...b,[c]:{type:"file",file:a,previewUrl:f,hash:c}})),b(a=>{let b=[...(a.artImages??[]).filter(a=>a.id!==c),{id:c,url:e}];return{...a,artImages:b,currentArtImageId:a.currentArtImageId||c}})}a.currentTarget&&(a.currentTarget.value="")}};return(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"Favicon"}),(0,e.jsx)("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:n}),(0,e.jsxs)("div",{className:"group relative h-20 w-20 cursor-pointer overflow-hidden rounded-lg border bg-white/60",children:[c?.type==="file"?(0,e.jsx)("img",{src:c.previewUrl,alt:"favicon preview",className:"h-full w-full object-cover"}):(0,e.jsx)("img",{src:"/favicon.png",alt:"current favicon",className:"h-full w-full object-cover"}),(0,e.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center rounded-lg bg-black/40 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsx)("span",{className:"text-xs text-white",children:c?"更换":"上传"})}),c&&(0,e.jsx)("div",{className:"absolute top-1 right-1 hidden group-hover:block",children:(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:a=>{a.stopPropagation(),c?.type==="file"&&URL.revokeObjectURL(c.previewUrl),d(null)},className:"rounded-md bg-white/90 px-2 py-1 text-xs text-red-500 shadow hover:bg-white",children:"清除"})}),(0,e.jsx)("div",{className:"absolute inset-0",onClick:()=>j.current?.click()})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"Avatar"}),(0,e.jsx)("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:o}),(0,e.jsxs)("div",{className:"group relative h-20 w-20 cursor-pointer overflow-hidden rounded-full border bg-white/60",children:[f?.type==="file"?(0,e.jsx)("img",{src:f.previewUrl,alt:"avatar preview",className:"h-full w-full object-cover"}):(0,e.jsx)("img",{src:"/images/avatar.png",alt:"current avatar",className:"h-full w-full object-cover"}),(0,e.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center rounded-full bg-black/40 opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsx)("span",{className:"text-xs text-white",children:f?"更换":"上传"})}),f&&(0,e.jsx)("div",{className:"absolute top-1 right-1 hidden group-hover:block",children:(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:a=>{a.stopPropagation(),f?.type==="file"&&URL.revokeObjectURL(f.previewUrl),g(null)},className:"rounded-md bg-white/90 px-2 py-1 text-xs text-red-500 shadow hover:bg-white",children:"清除"})}),(0,e.jsx)("div",{className:"absolute inset-0",onClick:()=>k.current?.click()})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"站点标题"}),(0,e.jsx)("input",{type:"text",value:a.meta.title,onChange:c=>b({...a,meta:{...a.meta,title:c.target.value}}),className:"bg-secondary/10 w-full rounded-lg border px-4 py-2 text-sm"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"站点描述"}),(0,e.jsx)("textarea",{value:a.meta.description,onChange:c=>b({...a,meta:{...a.meta,description:c.target.value}}),rows:3,className:"bg-secondary/10 w-full rounded-lg border px-4 py-2 text-sm"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"首页图片"}),(0,e.jsx)("input",{ref:l,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:p}),(a.artImages?.length??0)===0&&(0,e.jsx)("p",{className:"mb-2 text-xs text-gray-500",children:"暂未配置 Art 图片，点击下方「+」添加。"}),(0,e.jsxs)("div",{className:"grid grid-cols-4 gap-3 max-sm:grid-cols-3",children:[a.artImages?.map(c=>{let d=a.currentArtImageId===c.id,f=h[c.id],g=f?.type==="file"?f.previewUrl:c.url;return(0,e.jsxs)("div",{className:"group relative",children:[(0,e.jsx)("button",{type:"button",onClick:()=>{var a;return a=c.id,void b(b=>({...b,currentArtImageId:a}))},className:`block w-full overflow-hidden rounded-xl border bg-white/60 transition-all ${d?"ring-brand shadow-md ring-2":"hover:border-brand/60"}`,children:(0,e.jsx)("img",{src:g,alt:"art preview",className:"h-24 w-full object-cover"})}),d&&(0,e.jsx)("span",{className:"bg-brand pointer-events-none absolute top-1 left-1 rounded-full px-2 py-0.5 text-[10px] text-white shadow",children:"当前使用"}),(0,e.jsx)("button",{type:"button",onClick:()=>{var a;let d;return d=h[a=c.id],void(d?.type==="file"&&URL.revokeObjectURL(d.previewUrl),i(b=>{let c={...b};return delete c[a],c}),b(b=>{let c=(b.artImages??[]).filter(b=>b.id!==a),d=b.currentArtImageId===a;return{...b,artImages:c,currentArtImageId:d?c[0]?.id||"":b.currentArtImageId}}))},className:"text-secondary absolute top-1 right-1 hidden rounded-full bg-white/90 px-1.5 py-0.5 text-[10px] shadow group-hover:block",children:"删除"})]},c.id)}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)("button",{type:"button",onClick:()=>l.current?.click(),className:"hover:border-brand/60 flex h-24 w-full items-center justify-center rounded-xl border border-dashed bg-white/40 text-2xl text-gray-400 hover:bg-white/80",children:"+"})})]})]})]})}var V=a.i(24656);function W(a,b,c){let d=c*(2-b)/2;return 0!=d&&(b=1==d?0:d<.5?b*c/(2*d):b*c/(2-2*d)),{h:a,s:b,l:d}}function X(a){var b,c,d;let e,f=function(a){let b=a.replace("#","");if(6===b.length){let a=parseInt(b.slice(0,2),16);return{r:a,g:parseInt(b.slice(2,4),16),b:parseInt(b.slice(4,6),16),a:1}}if(8===b.length){let a=parseInt(b.slice(0,2),16),c=parseInt(b.slice(2,4),16);return{r:a,g:c,b:parseInt(b.slice(4,6),16),a:parseInt(b.slice(6,8),16)/255}}return{r:0,g:0,b:0,a:1}}(a),g=function(a,b,c){let d=Math.max(a/=255,b/=255,c/=255),e=Math.min(a,b,c),f=0,g=0,h=(d+e)/2;if(d!==e){let i=d-e;switch(g=h>.5?i/(2-d-e):i/(d+e),d){case a:f=((b-c)/i+6*(b<c))/6;break;case b:f=((c-a)/i+2)/6;break;case c:f=((a-b)/i+4)/6}}return{h:360*f,s:g,l:h}}(f.r,f.g,f.b),h=(b=g.h,c=g.s,{h:b,s:0===(e=(d=g.l)+c*Math.min(d,1-d))?0:2*(1-d/e),v:e,a:1});return{h:h.h,s:h.s,v:h.v,a:f.a}}function Y(a,b,c){return Math.min(Math.max(a,b),c)}function Z(a,b=2){return Number(a.toFixed(b))}function $({value:a,onChange:b,style:c,className:d}){let[f,g]=(0,m.useState)(!1),[h,i]=(0,m.useState)(0),[j,k]=(0,m.useState)(255),[l,n]=(0,m.useState)(255),[o,p]=(0,m.useState)(0),q=(0,m.useRef)(null),s=(0,m.useRef)(null),t=(0,m.useRef)(null),[u,v]=(0,m.useState)(!1),[w,x]=(0,m.useState)(!1),[y,z]=(0,m.useState)(!1),[A,B]=(0,m.useState)(!1),C=(0,m.useRef)(a);(0,m.useEffect)(()=>{if(a){let b=X(a);C.current=a,setTimeout(()=>{if(q.current&&s.current&&t.current){let a=q.current.getBoundingClientRect().width,c=s.current.getBoundingClientRect().width,d=s.current.getBoundingClientRect().height,e=t.current.getBoundingClientRect().width;i(b.h/360*a),n(b.s*c),p((1-b.v)*d),k(b.a*e),g(!0)}},0)}},[]);let D=(0,m.useMemo)(()=>{if(q.current){let{width:a}=q.current.getBoundingClientRect();return Z(h/a*360)}return 0},[h,q.current]),E=(0,m.useMemo)(()=>{if(t.current){let{width:a}=t.current.getBoundingClientRect();return Y(Z(j/a,4),0,1)}return 1},[j,t.current]),F=(0,m.useMemo)(()=>{if(s.current){let{width:a}=s.current.getBoundingClientRect();return Y(Z(l/a,4),0,1)}return 1},[l,s.current]),G=(0,m.useMemo)(()=>{if(s.current){let{height:a}=s.current.getBoundingClientRect();return 1-Y(Z(o/a,4),0,1)}return 0},[o,s.current]),H=(0,m.useMemo)(()=>W(D,F,G),[D,F,G]),I=(0,m.useMemo)(()=>(function(a,b,c,d=1){var e;let f=W(a,b,c),g=function(a,b,c){let d,e,f;if(a/=360,0===b)d=e=f=c;else{let g=(a,b,c)=>(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a,h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;d=g(i,h,a+1/3),e=g(i,h,a),f=g(i,h,a-1/3)}return{r:Math.round(255*d),g:Math.round(255*e),b:Math.round(255*f)}}(f.h,f.s,f.l),h=(e=g.r,"#"+[e,g.g,g.b].map(a=>Math.round(a).toString(16).padStart(2,"0")).join("")),i=Y(d,0,1);if(i>=1)return h;let j=Math.round(255*i).toString(16).padStart(2,"0");return`${h}${j}`})(D,F,G,E),[D,F,G,E]);return(0,m.useEffect)(()=>{b&&I&&I!==C.current&&(C.current=I,b(I))},[I,b]),(0,m.useEffect)(()=>{let a=a=>{if(u&&q.current){let{left:b,right:c,width:d}=q.current.getBoundingClientRect();a.pageX<b?i(0):a.pageX>c?i(d):i(a.pageX-b)}if(w&&t.current){let{left:b,right:c,width:d}=t.current.getBoundingClientRect();a.pageX<b?k(0):a.pageX>c?k(d):k(a.pageX-b)}if((y||A)&&s.current){let{left:b,top:c,right:d,bottom:e,width:f,height:g}=s.current.getBoundingClientRect();y&&(a.pageX<b?n(0):a.pageX>d?n(f):n(a.pageX-b)),A&&(a.pageY<c?p(0):a.pageY>e?p(g):p(a.pageY-c))}},b=()=>{v(!1),x(!1),z(!1),B(!1)};return(u||w||y||A)&&(document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),document.addEventListener("mouseleave",b)),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b),document.removeEventListener("mouseleave",b)}},[u,w,y,A]),(0,e.jsxs)("div",{"data-color-picker-panel":!0,className:(0,r.cn)("w-56 rounded-lg border bg-white p-3 shadow-lg select-none",d,f?"opacity-100":"opacity-0"),style:c,children:[(0,e.jsx)("div",{ref:s,onMouseDown:a=>{if(0===a.button){let{left:b,top:c,width:d,height:e}=s.current.getBoundingClientRect();n(Y(a.pageX-b,0,d)),p(Y(a.pageY-c,0,e)),z(!0),B(!0)}},className:"relative h-32 w-full cursor-crosshair rounded-t-md",style:{backgroundColor:`hsl(${D}, 100%, 50%)`,backgroundImage:"linear-gradient(0deg, #000, transparent), linear-gradient(90deg, #fff, hsla(0, 0%, 100%, 0))"},children:(0,e.jsx)("div",{className:"absolute z-10 h-4 w-4 -translate-x-1/2 -translate-y-1/2 cursor-crosshair rounded-full border-2 border-white shadow-md",style:{backgroundColor:`hsl(${H.h} ${100*H.s}% ${100*H.l}%)`,left:l,top:o}})}),(0,e.jsx)("div",{ref:q,onMouseDown:a=>{if(0===a.button){let{left:b,width:c}=q.current.getBoundingClientRect();i(Y(a.pageX-b,0,c)),v(!0)}},className:"relative flex h-5 cursor-pointer items-center",style:{background:"linear-gradient(to right, rgb(255, 0, 0), rgb(255, 255, 0), rgb(0, 255, 0), rgb(0, 255, 255), rgb(0, 0, 255), rgb(255, 0, 255), rgb(255, 0, 0))"},children:(0,e.jsx)("div",{className:"absolute h-4 w-4 -translate-x-1/2 cursor-pointer rounded-full border-2 border-white shadow-md",style:{backgroundColor:`hsl(${D} 100% 50%)`,left:h}})}),(0,e.jsx)("div",{style:{backgroundSize:"12px 12px",backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='12' height='12' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='grid' width='12' height='12' patternUnits='userSpaceOnUse'%3E%3Cpath d='M 12 0 L 0 0 0 12' fill='none' stroke='%23e5e7eb' stroke-width='1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23grid)'/%3E%3C/svg%3E\")"},className:"rounded-b-md",children:(0,e.jsx)("div",{ref:t,onMouseDown:a=>{if(0===a.button){let{left:b,width:c}=t.current.getBoundingClientRect();k(Y(a.pageX-b,0,c)),x(!0)}},className:"relative flex h-5 cursor-pointer items-center",style:{background:`linear-gradient(to right, hsl(${H.h} ${100*H.s}% ${100*H.l}% / 0%), hsl(${H.h} ${100*H.s}% ${100*H.l}% / 100%))`},children:(0,e.jsx)("div",{style:{left:j},className:"absolute h-4 w-4 -translate-x-1/2 cursor-pointer rounded-full border-2 border-white bg-white shadow-md",children:(0,e.jsx)("div",{className:"h-full w-full rounded-full",style:{backgroundColor:`hsl(${H.h} ${100*H.s}% ${100*H.l}% / ${100*E}%)`}})})})}),(0,e.jsx)("input",{type:"text",value:I,onChange:a=>{let c=a.target.value;if(/^#[0-9A-Fa-f]{0,8}$/.test(c)&&((7===c.length||9===c.length)&&b&&b(c),7===c.length||9===c.length)){let a=X(c);if(q.current&&s.current&&t.current){let b=q.current.getBoundingClientRect().width,c=s.current.getBoundingClientRect().width,d=s.current.getBoundingClientRect().height,e=t.current.getBoundingClientRect().width;i(a.h/360*b),n(a.s*c),p((1-a.v)*d),k(a.a*e)}}},className:"w-full rounded-md border px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",placeholder:"#000000"})]})}function _({value:a="#000000",onChange:b,className:c}){let[d,f]=(0,m.useState)(!1),[g,h]=(0,m.useState)(!1),i=(0,m.useRef)(null),[j,k]=(0,m.useState)({top:0,left:0});return(0,m.useEffect)(()=>{h(!0)},[]),(0,m.useEffect)(()=>{if(d&&i.current){let a=i.current.getBoundingClientRect();k({top:a.top-240,left:a.left})}},[d]),(0,m.useEffect)(()=>{if(!d)return;let a=a=>{let b=a.target;if(i.current&&!i.current.contains(b)){let a=document.querySelector("[data-color-picker-panel]");a&&!a.contains(b)&&f(!1)}};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[d]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("button",{ref:i,type:"button",onClick:()=>f(!d),className:(0,r.cn)("h-10 w-10 rounded-lg border-2 border-white/20 shadow-sm transition-all hover:scale-105",c),style:{backgroundColor:a},children:(0,e.jsx)("span",{className:"sr-only",children:"Select color"})}),g&&d&&j.top>0&&(0,V.createPortal)((0,e.jsx)($,{value:a,onChange:b,style:{position:"fixed",top:`${j.top}px`,left:`${j.left}px`,zIndex:1e3}}),document.body)]})}let aa=(0,a.i(63535).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ab=a.i(17431).default.theme,ac=[{name:"春暖",theme:{colorBrand:"#35bfab",colorBrandSecondary:"#1fc9e7",colorPrimary:"#334f52",colorSecondary:"#7b888e",colorBg:"#eeeeee",colorBorder:"#ffffff",colorCard:"#ffffff66",colorArticle:"#ffffffcc"},backgroundColors:["#EDDD62","#9EE7D1","#84D68A","#EDDD62","#88E6E5","#a7f3d0"]},{name:"秋实",theme:{colorPrimary:"#4E3F42",colorBrand:"#de4331",colorBrandSecondary:"#FCC841"},backgroundColors:["#FCC841","#DFEFFC","#DEDE92","#DE4331","#FE9750","#FCC841"]},{name:"夜晚",theme:{colorBrand:"#3a8fac",colorPrimary:"#e6e8e8",colorSecondary:"#acadae",colorBrandSecondary:"#51d0b9",colorBg:"#505050",colorBorder:"#8a8a8a5e",colorCard:"#34343466",colorArticle:"#333c"},backgroundColors:["#669590","#9ec3e7"]}];function ad({formData:a,setFormData:b}){let c=a.theme??{},d=(a,c)=>{b(b=>({...b,theme:{...b.theme,[a]:c}}))},f=()=>{let a=()=>Math.floor(256*Math.random());return`#${[a(),a(),a()].map(a=>a.toString(16).padStart(2,"0")).join("").toUpperCase()}`};return(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"mb-2 block text-sm font-medium",children:"基础颜色"}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:a.theme?.colorBrand??"#35bfab",onChange:a=>{b(b=>({...b,theme:{...b.theme,colorBrand:a}}))}}),(0,e.jsx)("span",{className:"text-xs",children:"主题色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorBrandSecondary??ab.colorBrandSecondary,onChange:a=>d("colorBrandSecondary",a)}),(0,e.jsx)("span",{className:"text-xs",children:"次级主题色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorPrimary??ab.colorPrimary,onChange:a=>d("colorPrimary",a)}),(0,e.jsx)("span",{className:"text-xs",children:"主色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorSecondary??ab.colorSecondary,onChange:a=>d("colorSecondary",a)}),(0,e.jsx)("span",{className:"text-xs",children:"次色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorBg??ab.colorBg,onChange:a=>d("colorBg",a)}),(0,e.jsx)("span",{className:"text-xs",children:"背景色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorBorder??ab.colorBorder,onChange:a=>d("colorBorder",a)}),(0,e.jsx)("span",{className:"text-xs",children:"边框色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorCard??ab.colorCard,onChange:a=>d("colorCard",a)}),(0,e.jsx)("span",{className:"text-xs",children:"卡片色"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(_,{value:c.colorArticle??ab.colorArticle,onChange:a=>d("colorArticle",a)}),(0,e.jsx)("span",{className:"text-xs",children:"文章背景"})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-3",children:[(0,e.jsx)("label",{className:"block text-sm font-medium",children:"背景颜色"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{let a=Array.from({length:Math.floor(5*Math.random())+4},()=>f()),c=f();b(b=>({...b,backgroundColors:a,theme:{...b.theme,colorBrand:c}}))},className:"rounded-lg border bg-white/60 px-3 py-1 text-xs whitespace-nowrap",children:"随机配色"}),(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{b({...a,backgroundColors:[...a.backgroundColors,"#EDDD62"]})},className:"rounded-lg border bg-white/60 px-3 py-1 text-xs whitespace-nowrap",children:"+ 添加颜色"})]})]}),(0,e.jsx)("div",{className:"flex gap-3",children:a.backgroundColors.map((c,d)=>(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsxs)("div",{className:"group relative",children:[(0,e.jsx)(_,{value:c,onChange:c=>{let e;(e=[...a.backgroundColors])[d]=c,b({...a,backgroundColors:e})}}),a.backgroundColors.length>1&&(0,e.jsx)("button",{onClick:()=>(c=>{if(a.backgroundColors.length>1){let d=a.backgroundColors.filter((a,b)=>b!==c);b({...a,backgroundColors:d})}})(d),className:"text-secondary absolute -top-1 -right-2 rounded-lg border bg-white/60 text-xs whitespace-nowrap opacity-0 transition-opacity group-hover:opacity-100",children:(0,e.jsx)(aa,{className:"size-3"})})]})},d))})]}),(0,e.jsx)("div",{className:"flex flex-col gap-3",children:ac.map(a=>(0,e.jsxs)("button",{onClick:()=>{b(b=>({...b,backgroundColors:[...a.backgroundColors],theme:{...b.theme,...a.theme}}))},className:"flex items-center gap-3 rounded-lg border bg-white/60 p-3 transition-colors hover:bg-white/80",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("div",{className:"h-10 w-10 rounded-lg border-2 border-white/20 shadow-sm",style:{backgroundColor:a.theme.colorBrand??ab.colorBrand}}),a.backgroundColors.map((a,b)=>(0,e.jsx)("div",{className:"h-10 w-10 rounded-lg border-2 border-white/20 shadow-sm",style:{backgroundColor:a}},b))]}),(0,e.jsx)("span",{className:"text-sm font-medium whitespace-nowrap",children:a.name})]},a.name))})]})}let ae={artCard:"首图",hiCard:"中心",clockCard:"时钟",calendarCard:"日历",musicCard:"音乐",socialButtons:"联系",shareCard:"分享",articleCard:"文章",writeButtons:"写作",navCard:"导航"};function af({cardStylesData:a,setCardStylesData:b}){return(0,e.jsxs)("div",{className:"overflow-x-auto",children:[(0,e.jsx)("div",{className:"text-secondary text-sm",children:"（偏移代表相对平面中心的偏移，比如 (0,0) 代表卡牌左上角为屏幕中心）"}),(0,e.jsxs)("table",{className:"mt-3 w-full border-collapse text-sm",children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{className:"border-b text-xs text-gray-500",children:[(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"卡片"}),(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"宽度"}),(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"高度"}),(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"显示顺序"}),(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"横向偏移"}),(0,e.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"纵向偏移"})]})}),(0,e.jsx)("tbody",{children:Object.entries(a).map(([a,c])=>(0,e.jsxs)("tr",{className:"border-b last:border-0",children:[(0,e.jsx)("td",{className:"px-3 py-2 align-middle whitespace-nowrap",children:ae[a]??a.replace(/([A-Z])/g," $1").trim()}),(0,e.jsx)("td",{className:"px-3 py-2",children:void 0!==c.width?(0,e.jsx)("input",{type:"number",value:c.width,onChange:c=>b(b=>({...b,[a]:{...b[a],width:parseInt(c.target.value)||0}})),className:"no-spinner w-full rounded-lg border bg-secondary/10 px-3 py-1.5 text-xs"}):(0,e.jsx)("span",{className:"text-xs text-gray-400",children:"-"})}),(0,e.jsx)("td",{className:"px-3 py-2",children:void 0!==c.height?(0,e.jsx)("input",{type:"number",value:c.height,onChange:c=>b(b=>({...b,[a]:{...b[a],height:parseInt(c.target.value)||0}})),className:"no-spinner w-full rounded-lg border bg-secondary/10 px-3 py-1.5 text-xs"}):(0,e.jsx)("span",{className:"text-xs text-gray-400",children:"-"})}),(0,e.jsx)("td",{className:"px-3 py-2",children:(0,e.jsx)("input",{type:"number",value:c.order,onChange:c=>b(b=>({...b,[a]:{...b[a],order:parseInt(c.target.value)||0}})),className:"w-full rounded-lg border bg-secondary/10 px-3 py-1.5 text-xs"})}),(0,e.jsx)("td",{className:"px-3 py-2",children:(0,e.jsx)("input",{type:"number",value:c.offsetX??"",placeholder:"null",onChange:c=>{let d=""===c.target.value?null:parseInt(c.target.value)||0;b(b=>({...b,[a]:{...b[a],offsetX:d}}))},className:"no-spinner w-full rounded-lg border bg-secondary/10 px-3 py-1.5 text-xs"})}),(0,e.jsx)("td",{className:"px-3 py-2",children:(0,e.jsx)("input",{type:"number",value:c.offsetY??"",placeholder:"null",onChange:c=>{let d=""===c.target.value?null:parseInt(c.target.value)||0;b(b=>({...b,[a]:{...b[a],offsetY:d}}))},className:"no-spinner w-full rounded-lg border bg-secondary/10 px-3 py-1.5 text-xs"})})]},a))})]})]})}function ag({open:a,onClose:b}){let{isAuth:c,setPrivateKey:d}=(0,P.useAuthStore)(),{siteContent:f,setSiteContent:g,cardStyles:i,setCardStyles:j,regenerateBubbles:k}=(0,h.useConfigStore)(),[l,n]=(0,m.useState)(f),[o,p]=(0,m.useState)(i),[q,r]=(0,m.useState)(f),[s,t]=(0,m.useState)(i),[u,v]=(0,m.useState)(!1),[w,x]=(0,m.useState)("site"),y=(0,m.useRef)(null),[z,A]=(0,m.useState)(null),[D,E]=(0,m.useState)(null),[F,G]=(0,m.useState)({});(0,m.useEffect)(()=>{if(a){let a={...f},b={...i};n(a),p(b),r(a),t(b),A(null),E(null),G({}),x("site")}},[a,f,i]),(0,m.useEffect)(()=>()=>{z?.type==="file"&&URL.revokeObjectURL(z.previewUrl),D?.type==="file"&&URL.revokeObjectURL(D.previewUrl),Object.values(F).forEach(a=>{"file"===a.type&&URL.revokeObjectURL(a.previewUrl)})},[z,D,F]);let H=async a=>{try{let b=await a.text();d(b),await I()}catch(a){console.error("Failed to read private key:",a),C.toast.error("读取密钥文件失败")}},I=async()=>{v(!0);try{let a=q.artImages??[],c=l.artImages??[],d=a.filter(a=>!c.some(b=>b.id===a.id));await T(l,o,z,D,F,d),g(l),j(o),K(l.theme),A(null),E(null),G({}),b()}catch(a){console.error("Failed to save:",a),C.toast.error(`保存失败: ${a?.message||"未知错误"}`)}finally{v(!1)}},J=()=>{if(z?.type==="file"&&URL.revokeObjectURL(z.previewUrl),D?.type==="file"&&URL.revokeObjectURL(D.previewUrl),Object.values(F).forEach(a=>{"file"===a.type&&URL.revokeObjectURL(a.previewUrl)}),g(q),j(s),k(),"undefined"!=typeof document){document.title=q.meta.title;let a=document.querySelector('meta[name="description"]');a&&a.setAttribute("content",q.meta.description)}K(q.theme),A(null),E(null),G({}),b()},K=a=>{if("undefined"==typeof document||!a)return;let{colorBrand:b,colorBrandSecondary:c,colorPrimary:d,colorSecondary:e,colorBg:f,colorBorder:g,colorCard:h,colorArticle:i}=a,j=document.documentElement;b&&j.style.setProperty("--color-brand",b),c&&j.style.setProperty("--color-brand-secondary",c),d&&j.style.setProperty("--color-primary",d),e&&j.style.setProperty("--color-secondary",e),f&&j.style.setProperty("--color-bg",f),g&&j.style.setProperty("--color-border",g),h&&j.style.setProperty("--color-card",h),i&&j.style.setProperty("--color-article",i)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("input",{ref:y,type:"file",accept:".pem",className:"hidden",onChange:async a=>{let b=a.target.files?.[0];b&&await H(b),a.currentTarget&&(a.currentTarget.value="")}}),(0,e.jsxs)(O.DialogModal,{open:a,onClose:J,className:"card scrollbar-none max-h-[90vh] min-h-[600px] w-[640px] overflow-y-auto",children:[(0,e.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,e.jsx)("div",{className:"flex gap-1",children:[{id:"site",label:"网站设置"},{id:"color",label:"色彩配置"},{id:"layout",label:"首页布局"}].map(a=>(0,e.jsxs)("button",{onClick:()=>x(a.id),className:`relative px-4 py-2 text-sm font-medium transition-colors ${w===a.id?"text-brand":"text-secondary hover:text-primary"}`,children:[a.label,w===a.id&&(0,e.jsx)("div",{className:"bg-brand absolute right-0 bottom-0 left-0 h-0.5"})]},a.id))}),(0,e.jsxs)("div",{className:"flex gap-3",children:[(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{if(console.log("formData",l),g(l),j(o),k(),"undefined"!=typeof document){document.title=l.meta.title;let a=document.querySelector('meta[name="description"]');a&&a.setAttribute("content",l.meta.description)}K(l.theme),b()},className:"rounded-xl border bg-white/60 px-6 py-2 text-sm",children:"预览"}),(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:J,disabled:u,className:"rounded-xl border bg-white/60 px-6 py-2 text-sm",children:"取消"}),(0,e.jsx)(B.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{c?I():y.current?.click()},disabled:u,className:"brand-btn px-6",children:u?"保存中...":c?"保存":"导入密钥"})]})]}),(0,e.jsxs)("div",{className:"min-h-[200px]",children:["site"===w&&(0,e.jsx)(U,{formData:l,setFormData:n,faviconItem:z,setFaviconItem:A,avatarItem:D,setAvatarItem:E,artImageUploads:F,setArtImageUploads:G}),"color"===w&&(0,e.jsx)(ad,{formData:l,setFormData:n}),"layout"===w&&(0,e.jsx)(af,{cardStylesData:o,setCardStylesData:p})]})]})]})}function ah(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),{maxSM:c}=(0,D.useSize)(),d=(0,k.useRouter)(),[g,i]=(0,m.useState)(!1),l=b.writeButtons,n=b.hiCard,o=b.clockCard,[p,q]=(0,m.useState)(!1);if((0,m.useEffect)(()=>{setTimeout(()=>q(!0),l.order*j.ANIMATION_DELAY*1e3)},[l.order]),c||!p)return null;let r=null!==l.offsetX?a.x+l.offsetX:a.x+j.CARD_SPACING+n.width/2,s=null!==l.offsetY?a.y+l.offsetY:a.y-o.offset-l.height-j.CARD_SPACING/2-o.height;return(0,e.jsxs)(B.motion.div,{initial:{left:r,top:s},animate:{left:r,top:s},className:"absolute flex items-center gap-4",children:[(0,e.jsxs)(B.motion.button,{onClick:()=>d.push("/write"),initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},style:{boxShadow:"inset 0 0 12px rgba(255, 255, 255, 0.4)"},className:"brand-btn whitespace-nowrap",children:[(0,e.jsx)(L.default,{}),(0,e.jsx)("span",{children:"写文章"})]}),(0,e.jsx)(B.motion.button,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i(!0),className:"p-2",children:(0,e.jsx)(N,{className:"h-6 w-6"})}),(0,e.jsx)(ag,{open:g,onClose:()=>i(!1)})]})}var ai=a.i(99235);function aj(){let a=(0,f.useCenterStore)(),{cardStyles:b}=(0,h.useConfigStore)(),c=b.hiCard,d=b.socialButtons,g=b.musicCard,i=b.shareCard,k=a.x+c.width/2-d.width+i.width+j.CARD_SPACING,l=a.y+c.height/2+j.CARD_SPACING+d.height+j.CARD_SPACING+g.height+j.CARD_SPACING;return(0,e.jsx)(B.motion.div,{className:"absolute max-sm:static",initial:{left:k,top:l},animate:{left:k,top:l},children:(0,e.jsx)(ai.default,{delay:b.shareCard.order*j.ANIMATION_DELAY*1e3})})}function ak(){let{maxSM:a}=(0,D.useSize)();return(0,e.jsxs)("div",{className:"max-sm:flex max-sm:flex-col max-sm:items-center max-sm:gap-6 max-sm:pt-28 max-sm:pb-20",children:[(0,e.jsx)(l,{}),(0,e.jsx)(i,{}),!a&&(0,e.jsx)(n,{}),!a&&(0,e.jsx)(s,{}),!a&&(0,e.jsx)(w,{}),(0,e.jsx)(F,{}),!a&&(0,e.jsx)(I,{}),(0,e.jsx)(K,{}),!a&&(0,e.jsx)(ah,{}),(0,e.jsx)(aj,{})]})}a.s(["default",()=>ak],63370)}];

//# sourceMappingURL=_6b3be6cb._.js.map