module.exports=[47507,63672,a=>{"use strict";a.s(["useAuthStore",()=>k],47507);var b=a.i(1937);a.s(["clearAllAuthCache",()=>h,"getAuthToken",()=>j,"hasAuth",()=>i],63672);var c=a.i(7565),d=a.i(76139),e=a.i(56916);let f="github_token";function g(){if("undefined"==typeof sessionStorage)return null;try{return sessionStorage.getItem(f)}catch{return null}}function h(){if("undefined"!=typeof sessionStorage)try{sessionStorage.removeItem(f)}catch(a){console.error("Failed to clear token cache:",a)}}function i(){return!!g()}async function j(){let a=g();if(a)return e.toast.info("使用缓存的令牌..."),a;let b=k.getState().privateKey;if(!b)throw Error("需要先设置私钥。请使用 useAuth().setPrivateKey()");e.toast.info("正在签发 JWT...");let h=(0,c.signAppJwt)(d.GITHUB_CONFIG.APP_ID,b);e.toast.info("正在获取安装信息...");let i=await (0,c.getInstallationId)(h,d.GITHUB_CONFIG.OWNER,d.GITHUB_CONFIG.REPO);e.toast.info("正在创建安装令牌...");let j=await (0,c.createInstallationToken)(h,i);if("undefined"!=typeof sessionStorage)try{sessionStorage.setItem(f,j)}catch(a){console.error("Failed to save token to cache:",a)}return j}let k=(0,b.create)((a,b)=>({isAuth:i(),privateKey:null,setPrivateKey:b=>{a({isAuth:!0,privateKey:b})},clearAuth:()=>{h(),a({isAuth:!1})},refreshAuthState:()=>{a({isAuth:i()})},getAuthToken:async()=>{let a=await j();return b().refreshAuthState(),a}}))},8364,(a,b,c)=>{var d,e,f,g,h,i,j,k,l,m,n,o,p={};p.userAgent=!1;var q={},r=r||(Q=Math,U=(T=(S={}).lib={}).Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),V=T.WordArray=U.extend({init:function(a,b){a=this.words=a||[],b!=R?this.sigBytes=b:this.sigBytes=4*a.length},toString:function(a){return(a||X).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=0xffffffff<<32-b%4*8,a.length=Q.ceil(b/4)},clone:function(){var a=U.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(0x100000000*Q.random()|0);return new V.init(b,a)}}),X=(W=S.enc={}).Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new V.init(c,b/2)}},Y=W.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new V.init(c,b)}},Z=W.Utf8={stringify:function(a){try{return decodeURIComponent(escape(Y.stringify(a)))}catch(a){throw Error("Malformed UTF-8 data")}},parse:function(a){return Y.parse(unescape(encodeURIComponent(a)))}},$=T.BufferedBlockAlgorithm=U.extend({reset:function(){this._data=new V.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=Z.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,d=b.sigBytes,e=this.blockSize,f=d/(4*e),g=(f=a?Q.ceil(f):Q.max((0|f)-this._minBufferSize,0))*e,h=Q.min(4*g,d);if(g){for(var i=0;i<g;i+=e)this._doProcessBlock(c,i);var j=c.splice(0,g);b.sigBytes-=h}return new V.init(j,h)},clone:function(){var a=U.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),T.Hasher=$.extend({cfg:U.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){$.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new _.HMAC.init(a,c).finalize(b)}}}),_=S.algo={},S);ab=(aa=(ad=r).lib).Base,ac=aa.WordArray,(ad=ad.x64={}).Word=ab.extend({init:function(a,b){this.high=a,this.low=b}}),ad.WordArray=ab.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=void 0!=b?b:8*a.length},toX32:function(){for(var a=this.words,b=a.length,c=[],d=0;d<b;d++){var e=a[d];c.push(e.high),c.push(e.low)}return ac.create(c,this.sigBytes)},clone:function(){for(var a=ab.clone.call(this),b=a.words=this.words.slice(0),c=b.length,d=0;d<c;d++)b[d]=b[d].clone();return a}}),r.lib.Cipher||(af=(ae=(aq=r).lib).Base,ag=ae.WordArray,ah=ae.BufferedBlockAlgorithm,ai=aq.enc.Base64,aj=aq.algo.EvpKDF,ak=ae.Cipher=ah.extend({cfg:af.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){ah.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?ar:ap).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?ar:ap).decrypt(a,b,c,d)}}}}),ae.StreamCipher=ak.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),ao=aq.mode={},al=function(a,b,c){var d=this._iv;d?this._iv=void 0:d=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=d[e]},(am=(ae.BlockCipherMode=af.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend()).Encryptor=am.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;al.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),am.Decryptor=am.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),al.call(this,a,b,d),this._prevBlock=e}}),ao=ao.CBC=am,am=(aq.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],f=0;f<c;f+=4)e.push(d);c=ag.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},ae.BlockCipher=ak.extend({cfg:ak.cfg.extend({mode:ao,padding:am}),reset:function(){ak.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4}),an=ae.CipherParams=af.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),ao=(aq.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return((a=a.salt)?ag.create([0x53616c74,0x65645f5f]).concat(a).concat(b):b).toString(ai)},parse:function(a){var b=(a=ai.parse(a)).words;if(0x53616c74==b[0]&&0x65645f5f==b[1]){var c=ag.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return an.create({ciphertext:a,salt:c})}},ap=ae.SerializableCipher=af.extend({cfg:af.extend({format:ao}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,an.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),aq=(aq.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=ag.random(8)),a=aj.create({keySize:b+c}).compute(a,d),c=ag.create(a.words.slice(b),4*c),a.sigBytes=4*b,an.create({key:a,iv:c,salt:d})}},ar=ae.PasswordBasedCipher=ap.extend({cfg:ap.cfg.extend({kdf:aq}),encrypt:function(a,b,c,d){return c=(d=this.cfg.extend(d)).kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,(a=ap.encrypt.call(this,a,b,c.key,d)).mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,ap.decrypt.call(this,a,b,c.key,d)}})),function(){for(var a=r.lib.BlockCipher,b=r.algo,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=0;256>n;n++)m[n]=128>n?n<<1:n<<1^283;for(var o=0,p=0,n=0;256>n;n++){var q=p^p<<1^p<<2^p<<3^p<<4,q=q>>>8^255&q^99;c[o]=q,d[q]=o;var s=m[o],t=m[s],u=m[t],v=257*m[q]^0x1010100*q;e[o]=v<<24|v>>>8,f[o]=v<<16|v>>>16,g[o]=v<<8|v>>>24,h[o]=v,v=0x1010101*u^65537*t^257*s^0x1010100*o,i[q]=v<<24|v>>>8,j[q]=v<<16|v>>>16,k[q]=v<<8|v>>>24,l[q]=v,o?(o=s^m[m[m[u^s]]],p^=m[m[p]]):o=p=1}var w=[0,1,2,4,8,16,32,64,128,27,54],b=b.AES=a.extend({_doReset:function(){for(var a=this._key,b=a.words,d=a.sigBytes/4,a=4*((this._nRounds=d+6)+1),e=this._keySchedule=[],f=0;f<a;f++)if(f<d)e[f]=b[f];else{var g=e[f-1];f%d?6<d&&4==f%d&&(g=c[g>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[255&g]):g=(c[(g=g<<8|g>>>24)>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[255&g])^w[f/d|0]<<24,e[f]=e[f-d]^g}for(d=0,b=this._invKeySchedule=[];d<a;d++)f=a-d,g=d%4?e[f]:e[f-4],b[d]=4>d||4>=f?g:i[c[g>>>24]]^j[c[g>>>16&255]]^k[c[g>>>8&255]]^l[c[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,e,f,g,h,c)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,i,j,k,l,d),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;o<i;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});r.AES=a._createHelper(b)}(),function(){function a(a,b){var c=(this._lBlock>>>a^this._rBlock)&b;this._rBlock^=c,this._lBlock^=c<<a}function b(a,b){var c=(this._rBlock>>>a^this._lBlock)&b;this._lBlock^=c,this._rBlock^=c<<a}var c=r.lib,d=c.WordArray,c=c.BlockCipher,e=r.algo,f=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],g=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],i=[{0:8421888,0x10000000:32768,0x20000000:8421378,0x30000000:2,0x40000000:512,0x50000000:8421890,0x60000000:8389122,0x70000000:8388608,0x80000000:514,0x90000000:8389120,0xa0000000:33280,0xb0000000:8421376,0xc0000000:32770,0xd0000000:8388610,0xe0000000:0,0xf0000000:33282,0x8000000:0,0x18000000:8421890,0x28000000:33282,0x38000000:32768,0x48000000:8421888,0x58000000:512,0x68000000:8421378,0x78000000:2,0x88000000:8389120,0x98000000:33280,0xa8000000:8421376,0xb8000000:8389122,0xc8000000:8388610,0xd8000000:32770,0xe8000000:514,0xf8000000:8388608,1:32768,0x10000001:2,0x20000001:8421888,0x30000001:8388608,0x40000001:8421378,0x50000001:33280,0x60000001:512,0x70000001:8389122,0x80000001:8421890,0x90000001:8421376,0xa0000001:8388610,0xb0000001:33282,0xc0000001:514,0xd0000001:8389120,0xe0000001:32770,0xf0000001:0,0x8000001:8421890,0x18000001:8421376,0x28000001:8388608,0x38000001:512,0x48000001:32768,0x58000001:8388610,0x68000001:2,0x78000001:33282,0x88000001:32770,0x98000001:8389122,0xa8000001:514,0xb8000001:8421888,0xc8000001:8389120,0xd8000001:0,0xe8000001:33280,0xf8000001:8421378},{0:0x40084010,0x1000000:16384,0x2000000:524288,0x3000000:0x40080010,0x4000000:0x40000010,0x5000000:0x40084000,0x6000000:0x40004000,0x7000000:16,0x8000000:540672,0x9000000:0x40004010,0xa000000:0x40000000,0xb000000:540688,0xc000000:524304,0xd000000:0,0xe000000:16400,0xf000000:0x40080000,8388608:0x40004000,0x1800000:540688,0x2800000:16,0x3800000:0x40004010,0x4800000:0x40084010,0x5800000:0x40000000,0x6800000:524288,0x7800000:0x40080010,0x8800000:524304,0x9800000:0,0xa800000:16384,0xb800000:0x40080000,0xc800000:0x40000010,0xd800000:540672,0xe800000:0x40084000,0xf800000:16400,0x10000000:0,0x11000000:0x40080010,0x12000000:0x40004010,0x13000000:0x40084000,0x14000000:0x40080000,0x15000000:16,0x16000000:540688,0x17000000:16384,0x18000000:16400,0x19000000:524288,0x1a000000:524304,0x1b000000:0x40000010,0x1c000000:540672,0x1d000000:0x40004000,0x1e000000:0x40000000,0x1f000000:0x40084010,0x10800000:540688,0x11800000:524288,0x12800000:0x40080000,0x13800000:16384,0x14800000:0x40004000,0x15800000:0x40084010,0x16800000:16,0x17800000:0x40000000,0x18800000:0x40084000,0x19800000:0x40000010,0x1a800000:0x40004010,0x1b800000:524304,0x1c800000:0,0x1d800000:16400,0x1e800000:0x40080010,0x1f800000:540672},{0:260,1048576:0,2097152:0x4000100,3145728:65796,4194304:65540,5242880:0x4000004,6291456:0x4010104,7340032:0x4010000,8388608:0x4000000,9437184:0x4010100,0xa00000:65792,0xb00000:0x4010004,0xc00000:0x4000104,0xd00000:65536,0xe00000:4,0xf00000:256,524288:0x4010100,1572864:0x4010004,2621440:0,3670016:0x4000100,4718592:0x4000004,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,0xa80000:0x4010000,0xb80000:65796,0xc80000:65792,0xd80000:0x4000104,0xe80000:0x4010104,0xf80000:0x4000000,0x1000000:0x4010100,0x1100000:65540,0x1200000:65536,0x1300000:0x4000100,0x1400000:256,0x1500000:0x4010104,0x1600000:0x4000004,0x1700000:0,0x1800000:0x4000104,0x1900000:0x4000000,0x1a00000:4,0x1b00000:65792,0x1c00000:0x4010000,0x1d00000:260,0x1e00000:65796,0x1f00000:0x4010004,0x1080000:0x4000000,0x1180000:260,0x1280000:0x4010100,0x1380000:0,0x1480000:65540,0x1580000:0x4000100,0x1680000:256,0x1780000:0x4010004,0x1880000:65536,0x1980000:0x4010104,0x1a80000:65796,0x1b80000:0x4000004,0x1c80000:0x4000104,0x1d80000:0x4010000,0x1e80000:4,0x1f80000:65792},{0:0x80401000,65536:0x80001040,131072:4198464,196608:0x80400000,262144:0,327680:4198400,393216:0x80000040,458752:4194368,524288:0x80000000,589824:4194304,655360:64,720896:0x80001000,786432:0x80400040,851968:4160,917504:4096,983040:0x80401040,32768:0x80001040,98304:64,163840:0x80400040,229376:0x80001000,294912:4198400,360448:0x80401040,425984:0,491520:0x80400000,557056:4096,622592:0x80401000,688128:4194304,753664:4160,819200:0x80000000,884736:4194368,950272:4198464,1015808:0x80000040,1048576:4194368,1114112:4198400,1179648:0x80000040,1245184:0,1310720:4160,1376256:0x80400040,1441792:0x80401000,1507328:0x80001040,1572864:0x80401040,1638400:0x80000000,1703936:0x80400000,1769472:4198464,1835008:0x80001000,1900544:4194304,1966080:64,2031616:4096,1081344:0x80400000,1146880:0x80401040,1212416:0,1277952:4198400,1343488:4194368,1409024:0x80000000,1474560:0x80001040,1540096:64,1605632:0x80000040,1671168:4096,1736704:0x80001000,1802240:0x80400040,1867776:4160,1933312:0x80401000,1998848:4194304,2064384:4198464},{0:128,4096:0x1040000,8192:262144,12288:0x20000000,16384:0x20040080,20480:0x1000080,24576:0x21000080,28672:262272,32768:0x1000000,36864:0x20040000,40960:0x20000080,45056:0x21040080,49152:0x21040000,53248:0,57344:0x1040080,61440:0x21000000,2048:0x1040080,6144:0x21000080,10240:128,14336:0x1040000,18432:262144,22528:0x20040080,26624:0x21040000,30720:0x20000000,34816:0x20040000,38912:0,43008:0x21040080,47104:0x1000080,51200:0x20000080,55296:0x21000000,59392:0x1000000,63488:262272,65536:262144,69632:128,73728:0x20000000,77824:0x21000080,81920:0x1000080,86016:0x21040000,90112:0x20040080,94208:0x1000000,98304:0x21040080,102400:0x21000000,106496:0x1040000,110592:0x20040000,114688:262272,118784:0x20000080,122880:0,126976:0x1040080,67584:0x21000080,71680:0x1000000,75776:0x1040000,79872:0x20040080,83968:0x20000000,88064:0x1040080,92160:128,96256:0x21040000,100352:262272,104448:0x21040080,108544:0,112640:0x21000000,116736:0x1000080,120832:262144,124928:0x20040000,129024:0x20000080},{0:0x10000008,256:8192,512:0x10200000,768:0x10202008,1024:0x10002000,1280:2097152,1536:2097160,1792:0x10000000,2048:0,2304:0x10002008,2560:2105344,2816:8,3072:0x10200008,3328:2105352,3584:8200,3840:0x10202000,128:0x10200000,384:0x10202008,640:8,896:2097152,1152:2105352,1408:0x10000008,1664:0x10002000,1920:8200,2176:2097160,2432:8192,2688:0x10002008,2944:0x10200008,3200:0,3456:0x10202000,3712:2105344,3968:0x10000000,4096:0x10002000,4352:0x10200008,4608:0x10202008,4864:8200,5120:2097152,5376:0x10000000,5632:0x10000008,5888:2105344,6144:2105352,6400:0,6656:8,6912:0x10200000,7168:8192,7424:0x10002008,7680:0x10202000,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:0x10000008,5248:0x10002000,5504:8200,5760:0x10202008,6016:0x10200000,6272:0x10202000,6528:0x10200008,6784:8192,7040:2105352,7296:2097160,7552:0,7808:0x10000000,8064:0x10002008},{0:1048576,16:0x2000401,32:1024,48:1049601,64:0x2100401,80:0,96:1,112:0x2100001,128:0x2000400,144:1048577,160:0x2000001,176:0x2100400,192:0x2100000,208:1025,224:1049600,240:0x2000000,8:0x2100001,24:0,40:0x2000401,56:0x2100400,72:1048576,88:0x2000001,104:0x2000000,120:1025,136:1049601,152:0x2000400,168:0x2100000,184:1048577,200:1024,216:0x2100401,232:1,248:1049600,256:0x2000000,272:1048576,288:0x2000401,304:0x2100001,320:1048577,336:0x2000400,352:0x2100400,368:1049601,384:1025,400:0x2100401,416:1049600,432:1,448:0,464:0x2100000,480:0x2000001,496:1024,264:1049600,280:0x2000401,296:0x2100001,312:1,328:0x2000000,344:1048576,360:1025,376:0x2100400,392:0x2000001,408:0x2100000,424:0,440:0x2100401,456:1049601,472:1024,488:0x2000400,504:1048577},{0:0x8000820,1:131072,2:0x8000000,3:32,4:131104,5:0x8020820,6:0x8020800,7:2048,8:0x8020000,9:0x8000800,10:133120,11:0x8020020,12:2080,13:0,14:0x8000020,15:133152,0x80000000:2048,0x80000001:0x8020820,0x80000002:0x8000820,0x80000003:0x8000000,0x80000004:0x8020000,0x80000005:133120,0x80000006:133152,0x80000007:32,0x80000008:0x8000020,0x80000009:2080,0x8000000a:131104,0x8000000b:0x8020800,0x8000000c:0,0x8000000d:0x8020020,0x8000000e:0x8000800,0x8000000f:131072,16:133152,17:0x8020800,18:32,19:2048,20:0x8000800,21:0x8000020,22:0x8020020,23:131072,24:0,25:131104,26:0x8020000,27:0x8000820,28:0x8020820,29:133120,30:2080,31:0x8000000,0x80000010:131072,0x80000011:2048,0x80000012:0x8020020,0x80000013:133152,0x80000014:32,0x80000015:0x8020000,0x80000016:0x8000000,0x80000017:0x8000820,0x80000018:0x8020820,0x80000019:0x8000020,0x8000001a:0x8000800,0x8000001b:0,0x8000001c:133120,0x8000001d:2080,0x8000001e:131104,0x8000001f:0x8020800}],j=[0xf8000001,0x1f800000,0x1f80000,2064384,129024,8064,504,0x8000001f],k=e.DES=c.extend({_doReset:function(){for(var a=this._key.words,b=[],c=0;56>c;c++){var d=f[c]-1;b[c]=a[d>>>5]>>>31-d%32&1}for(d=0,a=this._subKeys=[];16>d;d++){for(var e=a[d]=[],i=h[d],c=0;24>c;c++)e[c/6|0]|=b[(g[c]-1+i)%28]<<31-c%6,e[4+(c/6|0)]|=b[28+(g[c+24]-1+i)%28]<<31-c%6;for(c=1,e[0]=e[0]<<1|e[0]>>>31;7>c;c++)e[c]>>>=4*(c-1)+3;e[7]=e[7]<<5|e[7]>>>27}for(c=0,b=this._invSubKeys=[];16>c;c++)b[c]=a[15-c]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._subKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invSubKeys)},_doCryptBlock:function(c,d,e){this._lBlock=c[d],this._rBlock=c[d+1],a.call(this,4,0xf0f0f0f),a.call(this,16,65535),b.call(this,2,0x33333333),b.call(this,8,0xff00ff),a.call(this,1,0x55555555);for(var f=0;16>f;f++){for(var g=e[f],h=this._lBlock,k=this._rBlock,l=0,m=0;8>m;m++)l|=i[m][((k^g[m])&j[m])>>>0];this._lBlock=k,this._rBlock=h^l}e=this._lBlock,this._lBlock=this._rBlock,this._rBlock=e,a.call(this,1,0x55555555),b.call(this,8,0xff00ff),b.call(this,2,0x33333333),a.call(this,16,65535),a.call(this,4,0xf0f0f0f),c[d]=this._lBlock,c[d+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=c._createHelper(k),e=e.TripleDES=c.extend({_doReset:function(){var a=this._key.words;this._des1=k.createEncryptor(d.create(a.slice(0,2))),this._des2=k.createEncryptor(d.create(a.slice(2,4))),this._des3=k.createEncryptor(d.create(a.slice(4,6)))},encryptBlock:function(a,b){this._des1.encryptBlock(a,b),this._des2.decryptBlock(a,b),this._des3.encryptBlock(a,b)},decryptBlock:function(a,b){this._des3.decryptBlock(a,b),this._des2.encryptBlock(a,b),this._des1.decryptBlock(a,b)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=c._createHelper(e)}(),as=r.lib.WordArray,r.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;e<c;e+=3)for(var f=(b[e>>>2]>>>24-e%4*8&255)<<16|(b[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|b[e+2>>>2]>>>24-(e+2)%4*8&255,g=0;4>g&&e+.75*g<c;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var b=a.length,c=this._map,d=c.charAt(64);d&&-1!=(d=a.indexOf(d))&&(b=d);for(var d=[],e=0,f=0;f<b;f++)if(f%4){var g=c.indexOf(a.charAt(f-1))<<f%4*2,h=c.indexOf(a.charAt(f))>>>6-f%4*2;d[e>>>2]|=(g|h)<<24-e%4*8,e++}return as.create(d,e)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(a){function b(a,b,c,d,e,f,g){return((a=a+(b&c|~b&d)+e+g)<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return((a=a+(b&d|c&~d)+e+g)<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return((a=a+(b^c^d)+e+g)<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return((a=a+(c^(b|~d))+e+g)<<f|a>>>32-f)+b}for(var f=r.lib,g=f.WordArray,h=f.Hasher,f=r.algo,i=[],j=0;64>j;j++)i[j]=0x100000000*a.abs(a.sin(j+1))|0;f=f.MD5=h.extend({_doReset:function(){this._hash=new g.init([0x67452301,0xefcdab89,0x98badcfe,0x10325476])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,j=a[h];a[h]=(j<<8|j>>>24)&0xff00ff|(j<<24|j>>>8)&0xff00ff00}var g=this._hash.words,h=a[f+0],j=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,i[0]),B=b(B,y,z,A,j,12,i[1]),A=b(A,B,y,z,k,17,i[2]),z=b(z,A,B,y,l,22,i[3]),y=b(y,z,A,B,m,7,i[4]),B=b(B,y,z,A,n,12,i[5]),A=b(A,B,y,z,o,17,i[6]),z=b(z,A,B,y,p,22,i[7]),y=b(y,z,A,B,q,7,i[8]),B=b(B,y,z,A,r,12,i[9]),A=b(A,B,y,z,s,17,i[10]),z=b(z,A,B,y,t,22,i[11]),y=b(y,z,A,B,u,7,i[12]),B=b(B,y,z,A,v,12,i[13]),A=b(A,B,y,z,w,17,i[14]),z=b(z,A,B,y,x,22,i[15]),y=c(y,z,A,B,j,5,i[16]),B=c(B,y,z,A,o,9,i[17]),A=c(A,B,y,z,t,14,i[18]),z=c(z,A,B,y,h,20,i[19]),y=c(y,z,A,B,n,5,i[20]),B=c(B,y,z,A,s,9,i[21]),A=c(A,B,y,z,x,14,i[22]),z=c(z,A,B,y,m,20,i[23]),y=c(y,z,A,B,r,5,i[24]),B=c(B,y,z,A,w,9,i[25]),A=c(A,B,y,z,l,14,i[26]),z=c(z,A,B,y,q,20,i[27]),y=c(y,z,A,B,v,5,i[28]),B=c(B,y,z,A,k,9,i[29]),A=c(A,B,y,z,p,14,i[30]),z=c(z,A,B,y,u,20,i[31]),y=d(y,z,A,B,n,4,i[32]),B=d(B,y,z,A,q,11,i[33]),A=d(A,B,y,z,t,16,i[34]),z=d(z,A,B,y,w,23,i[35]),y=d(y,z,A,B,j,4,i[36]),B=d(B,y,z,A,m,11,i[37]),A=d(A,B,y,z,p,16,i[38]),z=d(z,A,B,y,s,23,i[39]),y=d(y,z,A,B,v,4,i[40]),B=d(B,y,z,A,h,11,i[41]),A=d(A,B,y,z,l,16,i[42]),z=d(z,A,B,y,o,23,i[43]),y=d(y,z,A,B,r,4,i[44]),B=d(B,y,z,A,u,11,i[45]),A=d(A,B,y,z,x,16,i[46]),z=d(z,A,B,y,k,23,i[47]),y=e(y,z,A,B,h,6,i[48]),B=e(B,y,z,A,p,10,i[49]),A=e(A,B,y,z,w,15,i[50]),z=e(z,A,B,y,n,21,i[51]),y=e(y,z,A,B,u,6,i[52]),B=e(B,y,z,A,l,10,i[53]),A=e(A,B,y,z,s,15,i[54]),z=e(z,A,B,y,j,21,i[55]),y=e(y,z,A,B,q,6,i[56]),B=e(B,y,z,A,x,10,i[57]),A=e(A,B,y,z,o,15,i[58]),z=e(z,A,B,y,v,21,i[59]),y=e(y,z,A,B,m,6,i[60]),B=e(B,y,z,A,t,10,i[61]),A=e(A,B,y,z,k,15,i[62]),z=e(z,A,B,y,r,21,i[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/0x100000000);for(c[(e+64>>>9<<4)+15]=(f<<8|f>>>24)&0xff00ff|(f<<24|f>>>8)&0xff00ff00,c[(e+64>>>9<<4)+14]=(d<<8|d>>>24)&0xff00ff|(d<<24|d>>>8)&0xff00ff00,b.sigBytes=4*(c.length+1),this._process(),c=(b=this._hash).words,d=0;4>d;d++)e=c[d],c[d]=(e<<8|e>>>24)&0xff00ff|(e<<24|e>>>8)&0xff00ff00;return b},clone:function(){var a=h.clone.call(this);return a._hash=this._hash.clone(),a}}),r.MD5=h._createHelper(f),r.HmacMD5=h._createHmacHelper(f)}(Math),at=(aw=r.lib).WordArray,au=aw.Hasher,av=[],aw=r.algo.SHA1=au.extend({_doReset:function(){this._hash=new at.init([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=0;80>i;i++){if(16>i)av[i]=0|a[b+i];else{var j=av[i-3]^av[i-8]^av[i-14]^av[i-16];av[i]=j<<1|j>>>31}j=(d<<5|d>>>27)+h+av[i],j=20>i?j+((e&f|~e&g)+0x5a827999):40>i?j+((e^f^g)+0x6ed9eba1):60>i?j+((e&f|e&g|f&g)-0x70e44324):j+((e^f^g)-0x359d3e2a),h=g,g=f,f=e<<30|e>>>2,e=d,d=j}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+g|0,c[4]=c[4]+h|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/0x100000000),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=au.clone.call(this);return a._hash=this._hash.clone(),a}}),r.SHA1=au._createHelper(aw),r.HmacSHA1=au._createHmacHelper(aw),function(a){for(var b,c=r.lib,d=c.WordArray,e=c.Hasher,c=r.algo,f=[],g=[],h=function(a){return 0x100000000*(a-(0|a))|0},i=2,j=0;64>j;){a:{b=i;for(var k=a.sqrt(b),l=2;l<=k;l++)if(!(b%l)){b=!1;break a}b=!0}b&&(8>j&&(f[j]=h(a.pow(i,.5))),g[j]=h(a.pow(i,1/3)),j++),i++}var m=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],n=0;64>n;n++){if(16>n)m[n]=0|a[b+n];else{var o=m[n-15],p=m[n-2];m[n]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+m[n-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+m[n-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[n]+m[n],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/0x100000000),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});r.SHA256=e._createHelper(c),r.HmacSHA256=e._createHmacHelper(c)}(Math),ax=r.lib.WordArray,ay=(az=r.algo).SHA256,az=az.SHA224=ay.extend({_doReset:function(){this._hash=new ax.init([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4])},_doFinalize:function(){var a=ay._doFinalize.call(this);return a.sigBytes-=4,a}}),r.SHA224=ay._createHelper(az),r.HmacSHA224=ay._createHmacHelper(az),function(){function a(){return d.create.apply(d,arguments)}for(var b=r.lib.Hasher,c=r.x64,d=c.Word,e=c.WordArray,c=r.algo,f=[a(0x428a2f98,0xd728ae22),a(0x71374491,0x23ef65cd),a(0xb5c0fbcf,0xec4d3b2f),a(0xe9b5dba5,0x8189dbbc),a(0x3956c25b,0xf348b538),a(0x59f111f1,0xb605d019),a(0x923f82a4,0xaf194f9b),a(0xab1c5ed5,0xda6d8118),a(0xd807aa98,0xa3030242),a(0x12835b01,0x45706fbe),a(0x243185be,0x4ee4b28c),a(0x550c7dc3,0xd5ffb4e2),a(0x72be5d74,0xf27b896f),a(0x80deb1fe,0x3b1696b1),a(0x9bdc06a7,0x25c71235),a(0xc19bf174,0xcf692694),a(0xe49b69c1,0x9ef14ad2),a(0xefbe4786,0x384f25e3),a(0xfc19dc6,0x8b8cd5b5),a(0x240ca1cc,0x77ac9c65),a(0x2de92c6f,0x592b0275),a(0x4a7484aa,0x6ea6e483),a(0x5cb0a9dc,0xbd41fbd4),a(0x76f988da,0x831153b5),a(0x983e5152,0xee66dfab),a(0xa831c66d,0x2db43210),a(0xb00327c8,0x98fb213f),a(0xbf597fc7,0xbeef0ee4),a(0xc6e00bf3,0x3da88fc2),a(0xd5a79147,0x930aa725),a(0x6ca6351,0xe003826f),a(0x14292967,0xa0e6e70),a(0x27b70a85,0x46d22ffc),a(0x2e1b2138,0x5c26c926),a(0x4d2c6dfc,0x5ac42aed),a(0x53380d13,0x9d95b3df),a(0x650a7354,0x8baf63de),a(0x766a0abb,0x3c77b2a8),a(0x81c2c92e,0x47edaee6),a(0x92722c85,0x1482353b),a(0xa2bfe8a1,0x4cf10364),a(0xa81a664b,0xbc423001),a(0xc24b8b70,0xd0f89791),a(0xc76c51a3,0x654be30),a(0xd192e819,0xd6ef5218),a(0xd6990624,0x5565a910),a(0xf40e3585,0x5771202a),a(0x106aa070,0x32bbd1b8),a(0x19a4c116,0xb8d2d0c8),a(0x1e376c08,0x5141ab53),a(0x2748774c,0xdf8eeb99),a(0x34b0bcb5,0xe19b48a8),a(0x391c0cb3,0xc5c95a63),a(0x4ed8aa4a,0xe3418acb),a(0x5b9cca4f,0x7763e373),a(0x682e6ff3,0xd6b2b8a3),a(0x748f82ee,0x5defb2fc),a(0x78a5636f,0x43172f60),a(0x84c87814,0xa1f0ab72),a(0x8cc70208,0x1a6439ec),a(0x90befffa,0x23631e28),a(0xa4506ceb,0xde82bde9),a(0xbef9a3f7,0xb2c67915),a(0xc67178f2,0xe372532b),a(0xca273ece,0xea26619c),a(0xd186b8c7,0x21c0c207),a(0xeada7dd6,0xcde0eb1e),a(0xf57d4f7f,0xee6ed178),a(0x6f067aa,0x72176fba),a(0xa637dc5,0xa2c898a6),a(0x113f9804,0xbef90dae),a(0x1b710b35,0x131c471b),a(0x28db77f5,0x23047d84),a(0x32caab7b,0x40c72493),a(0x3c9ebe0a,0x15c9bebc),a(0x431d67c4,0x9c100d4c),a(0x4cc5d4be,0xcb3e42b6),a(0x597f299c,0xfc657e2a),a(0x5fcb6fab,0x3ad6faec),a(0x6c44198c,0x4a475817)],g=[],h=0;80>h;h++)g[h]=a();c=c.SHA512=b.extend({_doReset:function(){this._hash=new e.init([new d.init(0x6a09e667,0xf3bcc908),new d.init(0xbb67ae85,0x84caa73b),new d.init(0x3c6ef372,0xfe94f82b),new d.init(0xa54ff53a,0x5f1d36f1),new d.init(0x510e527f,0xade682d1),new d.init(0x9b05688c,0x2b3e6c1f),new d.init(0x1f83d9ab,0xfb41bd6b),new d.init(0x5be0cd19,0x137e2179)])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],h=c[2],i=c[3],j=c[4],k=c[5],l=c[6],c=c[7],m=d.high,n=d.low,o=e.high,p=e.low,q=h.high,r=h.low,s=i.high,t=i.low,u=j.high,v=j.low,w=k.high,x=k.low,y=l.high,z=l.low,A=c.high,B=c.low,C=m,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=v,M=w,N=x,O=y,P=z,Q=A,R=B,S=0;80>S;S++){var T=g[S];if(16>S)var U=T.high=0|a[b+2*S],V=T.low=0|a[b+2*S+1];else{var U=g[S-15],V=U.high,W=U.low,U=(V>>>1|W<<31)^(V>>>8|W<<24)^V>>>7,W=(W>>>1|V<<31)^(W>>>8|V<<24)^(W>>>7|V<<25),X=g[S-2],V=X.high,Y=X.low,X=(V>>>19|Y<<13)^(V<<3|Y>>>29)^V>>>6,Y=(Y>>>19|V<<13)^(Y<<3|V>>>29)^(Y>>>6|V<<26),V=g[S-7],Z=V.high,$=g[S-16],_=$.high,$=$.low,V=W+V.low,U=U+Z+ +(V>>>0<W>>>0),V=V+Y,U=U+X+ +(V>>>0<Y>>>0),V=V+$,U=U+_+ +(V>>>0<$>>>0);T.high=U,T.low=V}var Z=K&M^~K&O,$=L&N^~L&P,T=C&E^C&G^E&G,aa=D&F^D&H^F&H,W=(C>>>28|D<<4)^(C<<30|D>>>2)^(C<<25|D>>>7),X=(D>>>28|C<<4)^(D<<30|C>>>2)^(D<<25|C>>>7),Y=f[S],ab=Y.high,ac=Y.low,Y=R+((L>>>14|K<<18)^(L>>>18|K<<14)^(L<<23|K>>>9)),_=Q+((K>>>14|L<<18)^(K>>>18|L<<14)^(K<<23|L>>>9))+ +(Y>>>0<R>>>0),Y=Y+$,_=_+Z+ +(Y>>>0<$>>>0),Y=Y+ac,_=_+ab+ +(Y>>>0<ac>>>0),Y=Y+V,_=_+U+ +(Y>>>0<V>>>0),V=X+aa,T=W+T+ +(V>>>0<X>>>0),Q=O,R=P,O=M,P=N,M=K,N=L,L=J+Y|0,K=I+_+ +(L>>>0<J>>>0)|0,I=G,J=H,G=E,H=F,E=C,F=D,D=Y+V|0,C=_+T+ +(D>>>0<Y>>>0)|0}n=d.low=n+D,d.high=m+C+ +(n>>>0<D>>>0),p=e.low=p+F,e.high=o+E+ +(p>>>0<F>>>0),r=h.low=r+H,h.high=q+G+ +(r>>>0<H>>>0),t=i.low=t+J,i.high=s+I+ +(t>>>0<J>>>0),v=j.low=v+L,j.high=u+K+ +(v>>>0<L>>>0),x=k.low=x+N,k.high=w+M+ +(x>>>0<N>>>0),z=l.low=z+P,l.high=y+O+ +(z>>>0<P>>>0),B=c.low=B+R,c.high=A+Q+ +(B>>>0<R>>>0)},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+128>>>10<<5)+30]=Math.floor(c/0x100000000),b[(d+128>>>10<<5)+31]=c,a.sigBytes=4*b.length,this._process(),this._hash.toX32()},clone:function(){var a=b.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:32}),r.SHA512=b._createHelper(c),r.HmacSHA512=b._createHmacHelper(c)}(),aA=(aD=r.x64).Word,aB=aD.WordArray,aC=(aD=r.algo).SHA512,aD=aD.SHA384=aC.extend({_doReset:function(){this._hash=new aB.init([new aA.init(0xcbbb9d5d,0xc1059ed8),new aA.init(0x629a292a,0x367cd507),new aA.init(0x9159015a,0x3070dd17),new aA.init(0x152fecd8,0xf70e5939),new aA.init(0x67332667,0xffc00b31),new aA.init(0x8eb44a87,0x68581511),new aA.init(0xdb0c2e0d,0x64f98fa7),new aA.init(0x47b5481d,0xbefa4fa4)])},_doFinalize:function(){var a=aC._doFinalize.call(this);return a.sigBytes-=16,a}}),r.SHA384=aC._createHelper(aD),r.HmacSHA384=aC._createHmacHelper(aD),aE=(aM=r.lib).WordArray,aF=aM.Hasher,aM=r.algo,aG=aE.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),aH=aE.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),aI=aE.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),aJ=aE.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),aK=aE.create([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),aL=aE.create([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]),aM=aM.RIPEMD160=aF.extend({_doReset:function(){this._hash=aE.create([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0])},_doProcessBlock:function(a,b){for(var c=0;16>c;c++){var d=b+c,e=a[d];a[d]=(e<<8|e>>>24)&0xff00ff|(e<<24|e>>>8)&0xff00ff00}var f,g,h,i,j,k,l,m,n,o,d=this._hash.words,e=aK.words,p=aL.words,q=aG.words,r=aH.words,s=aI.words,t=aJ.words;k=f=d[0],l=g=d[1],m=h=d[2],n=i=d[3],o=j=d[4];for(var u,c=0;80>c;c+=1)u=f+a[b+q[c]]|0,u=(u=(u=(16>c?u+((g^h^i)+e[0]):32>c?u+((g&h|~g&i)+e[1]):48>c?u+(((g|~h)^i)+e[2]):64>c?u+((g&i|h&~i)+e[3]):u+((g^(h|~i))+e[4]))|0)<<s[c]|u>>>32-s[c])+j|0,f=j,j=i,i=h<<10|h>>>22,h=g,g=u,u=k+a[b+r[c]]|0,u=(u=(u=(16>c?u+((l^(m|~n))+p[0]):32>c?u+((l&n|m&~n)+p[1]):48>c?u+(((l|~m)^n)+p[2]):64>c?u+((l&m|~l&n)+p[3]):u+((l^m^n)+p[4]))|0)<<t[c]|u>>>32-t[c])+o|0,k=o,o=n,n=m<<10|m>>>22,m=l,l=u;u=d[1]+h+n|0,d[1]=d[2]+i+o|0,d[2]=d[3]+j+k|0,d[3]=d[4]+f+l|0,d[4]=d[0]+g+m|0,d[0]=u},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;for(b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=(c<<8|c>>>24)&0xff00ff|(c<<24|c>>>8)&0xff00ff00,a.sigBytes=4*(b.length+1),this._process(),b=(a=this._hash).words,c=0;5>c;c++)d=b[c],b[c]=(d<<8|d>>>24)&0xff00ff|(d<<24|d>>>8)&0xff00ff00;return a},clone:function(){var a=aF.clone.call(this);return a._hash=this._hash.clone(),a}}),r.RIPEMD160=aF._createHelper(aM),r.HmacRIPEMD160=aF._createHmacHelper(aM),aN=r.enc.Utf8,r.algo.HMAC=r.lib.Base.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=aN.parse(b));var c=a.blockSize,d=4*c;b.sigBytes>d&&(b=a.finalize(b)),b.clamp();for(var e=this._oKey=b.clone(),f=this._iKey=b.clone(),g=e.words,h=f.words,i=0;i<c;i++)g[i]^=0x5c5c5c5c,h[i]^=0x36363636;e.sigBytes=f.sigBytes=d,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}}),aO=(aQ=r.lib).Base,aP=aQ.WordArray,aR=(aQ=r.algo).HMAC,aS=aQ.PBKDF2=aO.extend({cfg:aO.extend({keySize:4,hasher:aQ.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=aR.create(c.hasher,a),e=aP.create(),f=aP.create([1]),g=e.words,h=f.words,i=c.keySize,c=c.iterations;g.length<i;){var j=d.update(b).finalize(f);d.reset();for(var k=j.words,l=k.length,m=j,n=1;n<c;n++){m=d.finalize(m),d.reset();for(var o=m.words,p=0;p<l;p++)k[p]^=o[p]}e.concat(j),h[0]++}return e.sigBytes=4*i,e}}),r.PBKDF2=function(a,b,c){return aS.create(c).compute(a,b)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function t(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=s.charAt(c>>6)+s.charAt(63&c);for(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=s.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=s.charAt(c>>2)+s.charAt((3&c)<<4));(3&d.length)>0;)d+="=";return d}function u(a){var b,c,d,e="",f=0;for(b=0;b<a.length&&"="!=a.charAt(b);++b)(d=s.indexOf(a.charAt(b)))<0||(0==f?(e+=z(d>>2),c=3&d,f=1):1==f?(e+=z(c<<2|d>>4),c=15&d,f=2):2==f?(e+=z(c),e+=z(d>>2),c=3&d,f=3):(e+=z(c<<2|d>>4),e+=z(15&d),f=0));return 1==f&&(e+=z(c<<2)),e}function v(a){var b,c=u(a),d=[];for(b=0;2*b<c.length;++b)d[b]=parseInt(c.substring(2*b,2*b+2),16);return d}function w(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function x(){return new w(null)}"Microsoft Internet Explorer"==p.appName?(w.prototype.am=function(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;e=((i=g*i+((32767&k)<<15)+c[d]+(0x3fffffff&e))>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=0x3fffffff&i}return e},aT=30):"Netscape"!=p.appName?(w.prototype.am=function(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/0x4000000),c[d++]=0x3ffffff&g}return e},aT=26):(w.prototype.am=function(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;e=((i=g*i+((16383&k)<<14)+c[d]+e)>>28)+(k>>14)+h*j,c[d++]=0xfffffff&i}return e},aT=28),w.prototype.DB=aT,w.prototype.DM=(1<<aT)-1,w.prototype.DV=1<<aT,w.prototype.FV=0x10000000000000,w.prototype.F1=52-aT,w.prototype.F2=2*aT-52;var y=[];for(aV=0,aU=48;aV<=9;++aV)y[aU++]=aV;for(aV=10,aU=97;aV<36;++aV)y[aU++]=aV;for(aV=10,aU=65;aV<36;++aV)y[aU++]=aV;function z(a){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(a)}function A(a,b){var c=y[a.charCodeAt(b)];return null==c?-1:c}function B(a){var b=x();return b.fromInt(a),b}function C(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function D(a){this.m=a}function E(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function F(a,b){return a&b}function G(a,b){return a|b}function H(a,b){return a^b}function I(a,b){return a&~b}function J(){}function K(a){return a}function L(a){this.r2=x(),this.q3=x(),w.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}D.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},D.prototype.revert=function(a){return a},D.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},D.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},D.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},E.prototype.convert=function(a){var b=x();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(w.ZERO)>0&&this.m.subTo(b,b),b},E.prototype.revert=function(a){var b=x();return a.copyTo(b),this.reduce(b),b},E.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},E.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},E.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},w.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},w.prototype.fromInt=function(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0},w.prototype.fromString=function(a,b){if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var c,d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:A(a,d);if(g<0){"-"==a.charAt(d)&&(e=!0);continue}e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,(f+=c)>=this.DB&&(f-=this.DB)}8==c&&(128&a[0])!=0&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&w.ZERO.subTo(this,this)},w.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},w.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},w.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},w.prototype.lShiftTo=function(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()},w.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t){b.t=0;return}var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()},w.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},w.prototype.multiplyTo=function(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&w.ZERO.subTo(b,b)},w.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},w.prototype.divRemTo=function(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t){null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);return}null==c&&(c=x());var f=x(),g=this.s,h=a.s,i=this.DB-C(d[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f[j-1];if(0!=k){var l=k*(1<<this.F1)+(j>1?f[j-2]>>this.F2:0),m=this.FV/l,n=(1<<this.F1)/l,o=1<<this.F2,p=c.t,q=p-j,r=null==b?x():b;for(f.dlShiftTo(q,r),c.compareTo(r)>=0&&(c[c.t++]=1,c.subTo(r,c)),w.ONE.dlShiftTo(j,r),r.subTo(f,f);f.t<j;)f[f.t++]=0;for(;--q>=0;){var s=c[--p]==k?this.DM:Math.floor(c[p]*m+(c[p-1]+o)*n);if((c[p]+=f.am(0,s,c,q,0,j))<s)for(f.dlShiftTo(q,r),c.subTo(r,c);c[p]<--s;)c.subTo(r,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&w.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),g<0&&w.ZERO.subTo(c,c)}}},w.prototype.invDigit=function(){if(this.t<1)return 0;var a=this[0];if((1&a)==0)return 0;var b=3&a;return(b=(b=(b=(b=b*(2-(15&a)*b)&15)*(2-(255&a)*b)&255)*(2-((65535&a)*b&65535))&65535)*(2-a*b%this.DV)%this.DV)>0?this.DV-b:-b},w.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},w.prototype.exp=function(a,b){if(a>0xffffffff||a<1)return w.ONE;var c=x(),d=x(),e=b.convert(this),f=C(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)},w.prototype.toString=function(a){if(this.s<0)return"-"+this.negate().toString(a);if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var b,c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-- >0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f=z(c));g>=0;)h<b?c=(this[g]&(1<<h)-1)<<b-h|this[--g]>>(h+=this.DB-b):(c=this[g]>>(h-=b)&d,h<=0&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=z(c));return e?f:"0"},w.prototype.negate=function(){var a=x();return w.ZERO.subTo(this,a),a},w.prototype.abs=function(){return this.s<0?this.negate():this},w.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(0!=(b=c-a.t))return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0},w.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+C(this[this.t-1]^this.s&this.DM)},w.prototype.mod=function(a){var b=x();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(w.ZERO)>0&&a.subTo(b,b),b},w.prototype.modPowInt=function(a,b){var c;return c=a<256||b.isEven()?new D(b):new E(b),this.exp(a,c)},w.ZERO=B(0),w.ONE=B(1),J.prototype.convert=K,J.prototype.revert=K,J.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},J.prototype.sqrTo=function(a,b){a.squareTo(b)},L.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=x();return a.copyTo(b),this.reduce(b),b},L.prototype.revert=function(a){return a},L.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},L.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},L.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)};var M=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],N=0x4000000/M[M.length-1];function O(){this.i=0,this.j=0,this.S=[]}function P(){var a;a=new Date().getTime(),aX[aY++]^=255&a,aX[aY++]^=a>>8&255,aX[aY++]^=a>>16&255,aX[aY++]^=a>>24&255,aY>=256&&(aY-=256)}if(w.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},w.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=B(c),e=x(),f=x(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g},w.prototype.fromRadix=function(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=A(a,h);if(i<0){"-"==a.charAt(h)&&0==this.signum()&&(e=!0);continue}g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0)}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&w.ZERO.subTo(this,this)},w.prototype.fromNumber=function(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(w.ONE.shiftLeft(a-1),G,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(w.ONE.shiftLeft(a-1),this);else{var d=[],e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}},w.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},w.prototype.changeBit=function(a,b){var c=w.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c},w.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b[c++]=d:d<-1&&(b[c++]=this.DV+d),b.t=c,b.clamp()},w.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},w.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},w.prototype.multiplyLowerTo=function(a,b,c){var d,e=Math.min(this.t+a.t,b);for(c.s=0,c.t=e;e>0;)c[--e]=0;for(d=c.t-this.t;e<d;++e)c[e+this.t]=this.am(0,a[e],c,e,0,this.t);for(d=Math.min(a.t,b);e<d;++e)this.am(0,a[e],c,e,0,b-e);c.clamp()},w.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},w.prototype.modInt=function(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},w.prototype.millerRabin=function(a){var b=this.subtract(w.ONE),c=b.getLowestSetBit();if(c<=0)return!1;var d=b.shiftRight(c);(a=a+1>>1)>M.length&&(a=M.length);for(var e=x(),f=0;f<a;++f){e.fromInt(M[Math.floor(Math.random()*M.length)]);var g=e.modPow(d,this);if(0!=g.compareTo(w.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(0==(g=g.modPowInt(2,this)).compareTo(w.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0},w.prototype.clone=function(){var a=x();return this.copyTo(a),a},w.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;else if(0==this.t)return -1}else if(1==this.t)return this[0];else if(0==this.t)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},w.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},w.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},w.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},w.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?c=(this[a]&(1<<d)-1)<<8-d|this[--a]>>(d+=this.DB-8):(c=this[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),(128&c)!=0&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b},w.prototype.equals=function(a){return 0==this.compareTo(a)},w.prototype.min=function(a){return 0>this.compareTo(a)?this:a},w.prototype.max=function(a){return this.compareTo(a)>0?this:a},w.prototype.and=function(a){var b=x();return this.bitwiseTo(a,F,b),b},w.prototype.or=function(a){var b=x();return this.bitwiseTo(a,G,b),b},w.prototype.xor=function(a){var b=x();return this.bitwiseTo(a,H,b),b},w.prototype.andNot=function(a){var b=x();return this.bitwiseTo(a,I,b),b},w.prototype.not=function(){for(var a=x(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},w.prototype.shiftLeft=function(a){var b=x();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b},w.prototype.shiftRight=function(a){var b=x();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},w.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+function(a){if(0==a)return -1;var b=0;return(65535&a)==0&&(a>>=16,b+=16),(255&a)==0&&(a>>=8,b+=8),(15&a)==0&&(a>>=4,b+=4),(3&a)==0&&(a>>=2,b+=2),(1&a)==0&&++b,b}(this[a]);return this.s<0?this.t*this.DB:-1},w.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=function(a){for(var b=0;0!=a;)a&=a-1,++b;return b}(this[c]^b);return a},w.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:(this[b]&1<<a%this.DB)!=0},w.prototype.setBit=function(a){return this.changeBit(a,G)},w.prototype.clearBit=function(a){return this.changeBit(a,I)},w.prototype.flipBit=function(a){return this.changeBit(a,H)},w.prototype.add=function(a){var b=x();return this.addTo(a,b),b},w.prototype.subtract=function(a){var b=x();return this.subTo(a,b),b},w.prototype.multiply=function(a){var b=x();return this.multiplyTo(a,b),b},w.prototype.divide=function(a){var b=x();return this.divRemTo(a,b,null),b},w.prototype.remainder=function(a){var b=x();return this.divRemTo(a,null,b),b},w.prototype.divideAndRemainder=function(a){var b=x(),c=x();return this.divRemTo(a,b,c),[b,c]},w.prototype.modPow=function(a,b){var c,d,e=a.bitLength(),f=B(1);if(e<=0)return f;c=e<18?1:e<48?3:e<144?4:e<768?5:6,d=e<8?new D(b):b.isEven()?new L(b):new E(b);var g=[],h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=x();for(d.sqrTo(g[1],k);h<=j;)g[h]=x(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,m,n=a.t-1,o=!0,p=x();for(e=C(a[n])-1;n>=0;){for(e>=i?l=a[n]>>e-i&j:(l=(a[n]&(1<<e+1)-1)<<i-e,n>0&&(l|=a[n-1]>>this.DB+e-i)),h=c;(1&l)==0;)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--n),o)g[l].copyTo(f),o=!1;else{for(;h>1;)d.sqrTo(f,p),d.sqrTo(p,f),h-=2;h>0?d.sqrTo(f,p):(m=f,f=p,p=m),d.mulTo(p,g[l],f)}for(;n>=0&&(a[n]&1<<e)==0;)d.sqrTo(f,p),m=f,f=p,p=m,--e<0&&(e=this.DB-1,--n)}return d.revert(f)},w.prototype.modInverse=function(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return w.ZERO;for(var c=a.clone(),d=this.clone(),e=B(1),f=B(0),g=B(0),h=B(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(w.ONE)?w.ZERO:h.compareTo(a)>=0?h.subtract(a):0>h.signum()&&(h.addTo(a,h),0>h.signum())?h.add(a):h},w.prototype.pow=function(a){return this.exp(a,new J)},w.prototype.gcd=function(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(0>b.compareTo(c)){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c},w.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=M[M.length-1]){for(b=0;b<M.length;++b)if(c[0]==M[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<M.length;){for(var d=M[b],e=b+1;e<M.length&&d<N;)d*=M[e++];for(d=c.modInt(d);b<e;)if(d%M[b++]==0)return!1}return c.millerRabin(a)},w.prototype.square=function(){var a=x();return this.squareTo(a),a},O.prototype.init=function(a){var b,c,d;for(b=0;b<256;++b)this.S[b]=b;for(b=0,c=0;b<256;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0},O.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]},null==aX){if(aX=[],aY=0,void 0!==q&&(void 0!==q.crypto||void 0!==q.msCrypto)){var Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$=q.crypto||q.msCrypto;if(a$.getRandomValues){var a_=new Uint8Array(32);for(a$.getRandomValues(a_),aZ=0;aZ<32;++aZ)aX[aY++]=a_[aZ]}else if("Netscape"==p.appName&&p.appVersion<"5"){var a0=q.crypto.random(32);for(aZ=0;aZ<a0.length;++aZ)aX[aY++]=255&a0.charCodeAt(aZ)}}for(;aY<256;)aZ=Math.floor(65536*Math.random()),aX[aY++]=aZ>>>8,aX[aY++]=255&aZ;aY=0,P()}function a1(){}function a2(a,b){return new w(a,b)}function a3(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function a4(a,b){this.x=b,this.q=a}function a5(a,b,c,d){this.curve=a,this.x=b,this.y=c,null==d?this.z=w.ONE:this.z=d,this.zinv=null}function a6(a,b,c){this.q=a,this.a=this.fromBigInteger(b),this.b=this.fromBigInteger(c),this.infinity=new a5(this,null,null)}a1.prototype.nextBytes=function(a){var b;for(b=0;b<a.length;++b)a[b]=function(){if(null==aW){for(P(),(aW=new O).init(aX),aY=0;aY<aX.length;++aY)aX[aY]=0;aY=0}return aW.next()}()},a3.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},a3.prototype.setPublic=function(a,b){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof a)this.n=a,this.e=b;else if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=a2(a,16),this.e=parseInt(b,16);else throw"Invalid RSA public key"},a3.prototype.type="RSA",a3.prototype.doPrivate=function(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);0>b.compareTo(c);)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)},a3.prototype.setPrivate=function(a,b,c){if(this.isPrivate=!0,"string"!=typeof a)this.n=a,this.e=b,this.d=c;else if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=a2(a,16),this.e=parseInt(b,16),this.d=a2(c,16);else throw"Invalid RSA private key"},a3.prototype.setPrivateEx=function(a,b,c,d,e,f,g,h){if(this.isPrivate=!0,this.isPublic=!1,null==a)throw"RSASetPrivateEx N == null";if(null==b)throw"RSASetPrivateEx E == null";if(0==a.length)throw"RSASetPrivateEx N.length == 0";if(0==b.length)throw"RSASetPrivateEx E.length == 0";if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=a2(a,16),this.e=parseInt(b,16),this.d=a2(c,16),this.p=a2(d,16),this.q=a2(e,16),this.dmp1=a2(f,16),this.dmq1=a2(g,16),this.coeff=a2(h,16);else throw"Invalid RSA private key in RSASetPrivateEx"},a3.prototype.generate=function(a,b){var c=new a1,d=a>>1;this.e=parseInt(b,16);for(var e=new w(b,16),f=a/2-100,g=w.ONE.shiftLeft(f);;){for(;this.p=new w(a-d,1,c),!(0==this.p.subtract(w.ONE).gcd(e).compareTo(w.ONE)&&this.p.isProbablePrime(10)););for(;this.q=new w(d,1,c),!(0==this.q.subtract(w.ONE).gcd(e).compareTo(w.ONE)&&this.q.isProbablePrime(10)););if(0>=this.p.compareTo(this.q)){var h=this.p;this.p=this.q,this.q=h}var i=this.q.subtract(this.p).abs();if(!(i.bitLength()<f||0>=i.compareTo(g))){var j=this.p.subtract(w.ONE),k=this.q.subtract(w.ONE),l=j.multiply(k);if(0==l.gcd(e).compareTo(w.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==a)){this.d=e.modInverse(l),this.dmp1=this.d.mod(j),this.dmq1=this.d.mod(k),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},a4.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)},a4.prototype.toBigInteger=function(){return this.x},a4.prototype.negate=function(){return new a4(this.q,this.x.negate().mod(this.q))},a4.prototype.add=function(a){return new a4(this.q,this.x.add(a.toBigInteger()).mod(this.q))},a4.prototype.subtract=function(a){return new a4(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))},a4.prototype.multiply=function(a){return new a4(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))},a4.prototype.square=function(){return new a4(this.q,this.x.square().mod(this.q))},a4.prototype.divide=function(a){return new a4(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))},a4.prototype.sqrt=function(){return new a4(this.q,this.x.sqrt().mod(this.q))},a5.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},a5.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},a5.prototype.equals=function(a){return a==this||(this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():!!a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(w.ZERO)&&a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(w.ZERO))},a5.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(w.ZERO)&&!this.y.toBigInteger().equals(w.ZERO)},a5.prototype.negate=function(){return new a5(this.curve,this.x,this.y.negate(),this.z)},a5.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(w.ZERO.equals(c))return w.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new w("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger();a.x.toBigInteger(),a.y.toBigInteger();var g=c.square(),h=g.multiply(c),i=e.multiply(g),j=b.square().multiply(this.z),k=j.subtract(i.shiftLeft(1)).multiply(a.z).subtract(h).multiply(c).mod(this.curve.q),l=i.multiply(d).multiply(b).subtract(f.multiply(h)).subtract(j.multiply(b)).multiply(a.z).add(b.multiply(h)).mod(this.curve.q),m=h.multiply(this.z).multiply(a.z).mod(this.curve.q);return new a5(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(l),m)},a5.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new w("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q),f=this.curve.a.toBigInteger(),g=b.square().multiply(a);w.ZERO.equals(f)||(g=g.add(this.z.square().multiply(f)));var h=(g=g.mod(this.curve.q)).square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q),i=g.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(g.square().multiply(g)).mod(this.curve.q),j=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new a5(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(i),j)},a5.prototype.multiply=function(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a.multiply(new w("3")),d=this.negate(),e=this,f=this.curve.q.subtract(a),g=f.multiply(new w("3")),h=new a5(this.curve,this.x,this.y),i=h.negate();for(b=c.bitLength()-2;b>0;--b){e=e.twice();var j=c.testBit(b);j!=a.testBit(b)&&(e=e.add(j?this:d))}for(b=g.bitLength()-2;b>0;--b){h=h.twice();var k=g.testBit(b);k!=f.testBit(b)&&(h=h.add(k?h:i))}return e},a5.prototype.multiplyTwo=function(a,b,c){for(var d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1,e=this.curve.getInfinity(),f=this.add(b);d>=0;)e=e.twice(),a.testBit(d)?e=c.testBit(d)?e.add(f):e.add(this):c.testBit(d)&&(e=e.add(b)),--d;return e},a6.prototype.getQ=function(){return this.q},a6.prototype.getA=function(){return this.a},a6.prototype.getB=function(){return this.b},a6.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)},a6.prototype.getInfinity=function(){return this.infinity},a6.prototype.fromBigInteger=function(a){return new a4(this.q,a)},a6.prototype.decodePointHex=function(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var b=a.substr(0,2);a.substr(2);var c=this.fromBigInteger(new w(h,16)),d=this.getA(),e=this.getB(),f=c.square().add(d).multiply(c).add(e).sqrt();return"03"==b&&(f=f.negate()),new a5(this,c,f);case 4:case 6:case 7:var g=(a.length-2)/2,h=a.substr(2,g),i=a.substr(g+2,g);return new a5(this,this.fromBigInteger(new w(h,16)),this.fromBigInteger(new w(i,16)));default:return null}},a4.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},a5.prototype.getEncoded=function(a){var b=function(a,b){var c=a.toByteArrayUnsigned();if(b<c.length)c=c.slice(c.length-b);else for(;b>c.length;)c.unshift(0);return c},c=this.getX().toBigInteger(),d=this.getY().toBigInteger(),e=b(c,32);return a?d.isEven()?e.unshift(2):e.unshift(3):(e.unshift(4),e=e.concat(b(d,32))),e},a5.decodeFrom=function(a,b){b[0];var c=b.length-1,d=b.slice(1,1+c/2),e=b.slice(1+c/2,1+c);d.unshift(0),e.unshift(0);var f=new w(d),g=new w(e);return new a5(a,a.fromBigInteger(f),a.fromBigInteger(g))},a5.decodeFromHex=function(a,b){b.substr(0,2);var c=b.length-2,d=b.substr(2,c/2),e=b.substr(2+c/2,c/2),f=new w(d,16),g=new w(e,16);return new a5(a,a.fromBigInteger(f),a.fromBigInteger(g))},a5.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var b=a.x.subtract(this.x),c=a.y.subtract(this.y).divide(b),d=c.square().subtract(this.x).subtract(a.x),e=c.multiply(this.x.subtract(d)).subtract(this.y);return new a5(this.curve,d,e)},a5.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=this.curve.fromBigInteger(w.valueOf(2)),b=this.curve.fromBigInteger(w.valueOf(3)),c=this.x.square().multiply(b).add(this.curve.a).divide(this.y.multiply(a)),d=c.square().subtract(this.x.multiply(a)),e=c.multiply(this.x.subtract(d)).subtract(this.y);return new a5(this.curve,d,e)},a5.prototype.multiply2D=function(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a.multiply(new w("3")),d=this.negate(),e=this;for(b=c.bitLength()-2;b>0;--b){e=e.twice();var f=c.testBit(b);f!=a.testBit(b)&&(e=e.add2D(f?this:d))}return e},a5.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),b=this.getY().toBigInteger(),c=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),e=this.curve.getQ(),f=b.multiply(b).mod(e),g=a.multiply(a).multiply(a).add(c.multiply(a)).add(d).mod(e);return f.equals(g)},a5.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},a5.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw Error("Point is at infinity.");var b=this.getX().toBigInteger(),c=this.getY().toBigInteger();if(0>b.compareTo(w.ONE)||b.compareTo(a.subtract(w.ONE))>0)throw Error("x coordinate out of bounds");if(0>c.compareTo(w.ONE)||c.compareTo(a.subtract(w.ONE))>0)throw Error("y coordinate out of bounds");if(!this.isOnCurve())throw Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw Error("Point is not a scalar multiple of G.");return!0};var a7=function(){var a=RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),b=RegExp("\\\\(?:([^u])|u(.{4}))","g"),c={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function d(a,b,d){return b?c[b]:String.fromCharCode(parseInt(d,16))}var e=new String(""),f=Object.hasOwnProperty;return function(c,g){var h,i,j,k=c.match(a),l=k[0],m=!1;"{"===l?h={}:"["===l?h=[]:(h=[],m=!0);for(var n=[h],o=1-m,p=k.length;o<p;++o)switch((l=k[o]).charCodeAt(0)){default:(j=n[0])[i||j.length]=+l,i=void 0;break;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(b,d)),j=n[0],!i)if(j instanceof Array)i=j.length;else{i=l||e;break}j[i]=l,i=void 0;break;case 91:j=n[0],n.unshift(j[i||j.length]=[]),i=void 0;break;case 93:case 125:n.shift();break;case 102:(j=n[0])[i||j.length]=!1,i=void 0;break;case 110:(j=n[0])[i||j.length]=null,i=void 0;break;case 116:(j=n[0])[i||j.length]=!0,i=void 0;break;case 123:j=n[0],n.unshift(j[i||j.length]={}),i=void 0}if(m){if(1!==n.length)throw Error();h=h[0]}else if(n.length)throw Error();if(g){var q=function(a,b){var c=a[b];if(c&&"object"==typeof c){var d=null;for(var e in c)if(f.call(c,e)&&c!==a){var h=q(c,e);void 0!==h?c[e]=h:(d||(d=[]),d.push(e))}if(d)for(var i=d.length;--i>=0;)delete c[d[i]]}return g.call(a,b,c)};h=q({"":h},"")}return h}}();void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),m.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return b.length%2==1&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(a){return bI(a)},this.getPEMStringFromHex=function(a,b){return bn(a,b)},this.newObject=function(a){var b=m.asn1,c=b.ASN1Object,d=b.DERBoolean,e=b.DERInteger,f=b.DERBitString,g=b.DEROctetString,h=b.DERNull,i=b.DERObjectIdentifier,j=b.DEREnumerated,k=b.DERUTF8String,l=b.DERNumericString,n=b.DERPrintableString,o=b.DERTeletexString,p=b.DERIA5String,q=b.DERUTCTime,r=b.DERGeneralizedTime,s=b.DERVisibleString,t=b.DERBMPString,u=b.DERSequence,v=b.DERSet,w=b.DERTaggedObject,x=b.ASN1Util.newObject;if(a instanceof b.ASN1Object)return a;var y=Object.keys(a);if(1!=y.length)throw Error("key of param shall be only one.");var z=y[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+z+":"))throw Error("undefined key: "+z);if("bool"==z)return new d(a[z]);if("int"==z)return new e(a[z]);if("bitstr"==z)return new f(a[z]);if("octstr"==z)return new g(a[z]);if("null"==z)return new h(a[z]);if("oid"==z)return new i(a[z]);if("enum"==z)return new j(a[z]);if("utf8str"==z)return new k(a[z]);if("numstr"==z)return new l(a[z]);if("prnstr"==z)return new n(a[z]);if("telstr"==z)return new o(a[z]);if("ia5str"==z)return new p(a[z]);if("utctime"==z)return new q(a[z]);if("gentime"==z)return new r(a[z]);if("visstr"==z)return new s(a[z]);if("bmpstr"==z)return new t(a[z]);if("asn1"==z)return new c(a[z]);if("seq"==z){for(var A=a[z],B=[],C=0;C<A.length;C++){var D=x(A[C]);B.push(D)}return new u({array:B})}if("set"==z){for(var A=a[z],B=[],C=0;C<A.length;C++){var D=x(A[C]);B.push(D)}return new v({array:B})}if("tag"==z){var E=a[z];if("[object Array]"!==Object.prototype.toString.call(E)||3!=E.length)return new w(E);var F=x(E[2]);return new w({tag:E[0],explicit:E[1],obj:F})}},this.jsonToASN1HEX=function(a){return this.newObject(a).tohex()}},m.asn1.ASN1Util.oidHexToInt=function(a){for(var b="",c=parseInt(a.substr(0,2),16),d=Math.floor(c/40),b=d+"."+c%40,e="",f=2;f<a.length;f+=2){var g=("00000000"+parseInt(a.substr(f,2),16).toString(2)).slice(-8);e+=g.substr(1,7),"0"==g.substr(0,1)&&(b=b+"."+new w(e,2).toString(10),e="")}return b},m.asn1.ASN1Util.oidIntToHex=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var c="",d=a.split(".");c+=b(40*parseInt(d[0])+parseInt(d[1])),d.splice(0,2);for(var e=0;e<d.length;e++)c+=function(a){var c="",d=new w(a,10).toString(2),e=7-d.length%7;7==e&&(e=0);for(var f="",g=0;g<e;g++)f+="0";d=f+d;for(var g=0;g<d.length-1;g+=7){var h=d.substr(g,7);g!=d.length-7&&(h="1"+h),c+=b(parseInt(h,2))}return c}(d[e]);return c},m.asn1.ASN1Object=function(a){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw Error("this.hV is null or undefined");if(this.hV.length%2==1)throw Error("value hex must be even length: n=0,v="+this.hV);var a=this.hV.length/2,b=a.toString(16);if(b.length%2==1&&(b="0"+b),a<128)return b;var c=b.length/2;if(c>15)throw Error("ASN.1 length too long to represent by 8x: n = "+a.toString(16));return(128+c).toString(16)+b},this.tohex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(a){this.params=a},void 0!=a&&void 0!=a.tlv&&(this.hTLV=a.tlv,this.isModified=!1)},m.asn1.DERAbstractString=function(a){m.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=bh(this.s).toLowerCase()},this.setStringHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a?this.setString(a):void 0!==a.str?this.setString(a.str):void 0!==a.hex&&this.setStringHex(a.hex))},bP(m.asn1.DERAbstractString,m.asn1.ASN1Object),m.asn1.DERAbstractTime=function(a){m.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(a){return new Date(a.getTime()+6e4*a.getTimezoneOffset())},this.formatDate=function(a,b,c){var d=this.zeroPadding,e=this.localDateToUTC(a),f=String(e.getFullYear());"utc"==b&&(f=f.substr(2,2));var g=f+d(String(e.getMonth()+1),2)+d(String(e.getDate()),2)+d(String(e.getHours()),2)+d(String(e.getMinutes()),2)+d(String(e.getSeconds()),2);if(!0===c){var h=e.getMilliseconds();if(0!=h){var i=d(String(h),3);g=g+"."+(i=i.replace(/[0]+$/,""))}}return g+"Z"},this.zeroPadding=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a},this.setByParam=function(a){this.hV=null,this.hTLV=null,this.params=a},this.getString=function(){},this.setString=function(a){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.str=a},this.setByDate=function(a){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.date=a},this.setByDateValue=function(a,b,c,d,e,f){var g=new Date(Date.UTC(a,b-1,c,d,e,f,0));this.setByDate(g)},this.getFreshValueHex=function(){return this.hV}},bP(m.asn1.DERAbstractTime,m.asn1.ASN1Object),m.asn1.DERAbstractStructured=function(a){m.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array=a},this.appendASN1Object=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array.push(a)},this.asn1Array=[],void 0!==a&&void 0!==a.array&&(this.asn1Array=a.array)},bP(m.asn1.DERAbstractStructured,m.asn1.ASN1Object),m.asn1.DERBoolean=function(a){m.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",!1==a?this.hTLV="010100":this.hTLV="0101ff"},bP(m.asn1.DERBoolean,m.asn1.ASN1Object),m.asn1.DERInteger=function(a){m.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null,this.setByBigInteger=function(a){this.isModified=!0,this.params={bigint:a}},this.setByInteger=function(a){this.isModified=!0,this.params=a},this.setValueHex=function(a){this.isModified=!0,this.params={hex:a}},this.getFreshValueHex=function(){var a=this.params,b=null;if(null==a)throw Error("value not set");if("object"==typeof a&&void 0!=a.hex)return this.hV=a.hex,this.hV;if("number"==typeof a)b=new w(String(a),10);else if(void 0!=a.int)b=new w(String(a.int),10);else if(void 0!=a.bigint)b=a.bigint;else throw Error("wrong parameter");return this.hV=bI(b),this.hV},void 0!=a&&(this.params=a)},bP(m.asn1.DERInteger,m.asn1.ASN1Object),m.asn1.DERBitString=function(a){if(void 0!==a&&void 0!==a.obj){var b=m.asn1.ASN1Util.newObject(a.obj);a.hex="00"+b.tohex()}m.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null,this.isModified=!0,this.hV=a},this.setUnusedBitsAndHexValue=function(a,b){if(a<0||7<a)throw"unused bits shall be from 0 to 7: u = "+a;this.hTLV=null,this.isModified=!0,this.hV="0"+a+b},this.setByBinaryString=function(a){var b=8-(a=a.replace(/0+$/,"")).length%8;8==b&&(b=0),a+="0000000".substr(0,b);for(var c="",d=0;d<a.length-1;d+=8){var e=parseInt(a.substr(d,8),2).toString(16);1==e.length&&(e="0"+e),c+=e}this.hTLV=null,this.isModified=!0,this.hV="0"+b+c},this.setByBooleanArray=function(a){for(var b="",c=0;c<a.length;c++)!0==a[c]?b+="1":b+="0";this.setByBinaryString(b)},this.newFalseArray=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):void 0!==a.hex?this.setHexValueIncludingUnusedBits(a.hex):void 0!==a.bin?this.setByBinaryString(a.bin):void 0!==a.array&&this.setByBooleanArray(a.array))},bP(m.asn1.DERBitString,m.asn1.ASN1Object),m.asn1.DEROctetString=function(a){if(void 0!==a&&void 0!==a.obj){var b=m.asn1.ASN1Util.newObject(a.obj);a.hex=b.tohex()}m.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},bP(m.asn1.DEROctetString,m.asn1.DERAbstractString),m.asn1.DERNull=function(){m.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},bP(m.asn1.DERNull,m.asn1.ASN1Object),m.asn1.DERObjectIdentifier=function(a){m.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.setValueOidString=function(a){var b=bF(a);if(null==b)throw Error("malformed oid string: "+a);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=b},this.setValueName=function(a){var b=m.asn1.x509.OID.name2oid(a);if(""!==b)this.setValueOidString(b);else throw Error("DERObjectIdentifier oidName undefined: "+a)},this.setValueNameOrOid=function(a){a.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(a):this.setValueName(a)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(a){"string"==typeof a?this.setValueNameOrOid(a):void 0!==a.oid?this.setValueNameOrOid(a.oid):void 0!==a.name?this.setValueNameOrOid(a.name):void 0!==a.hex&&this.setValueHex(a.hex)},void 0!==a&&this.setByParam(a)},bP(m.asn1.DERObjectIdentifier,m.asn1.ASN1Object),m.asn1.DEREnumerated=function(a){m.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=bI(a)},this.setByInteger=function(a){var b=new w(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&(void 0!==a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):void 0!==a.hex&&this.setValueHex(a.hex))},bP(m.asn1.DEREnumerated,m.asn1.ASN1Object),m.asn1.DERUTF8String=function(a){m.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},bP(m.asn1.DERUTF8String,m.asn1.DERAbstractString),m.asn1.DERNumericString=function(a){m.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},bP(m.asn1.DERNumericString,m.asn1.DERAbstractString),m.asn1.DERPrintableString=function(a){m.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},bP(m.asn1.DERPrintableString,m.asn1.DERAbstractString),m.asn1.DERTeletexString=function(a){m.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},bP(m.asn1.DERTeletexString,m.asn1.DERAbstractString),m.asn1.DERIA5String=function(a){m.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},bP(m.asn1.DERIA5String,m.asn1.DERAbstractString),m.asn1.DERVisibleString=function(a){m.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="1a"},bP(m.asn1.DERVisibleString,m.asn1.DERAbstractString),m.asn1.DERBMPString=function(a){m.asn1.DERBMPString.superclass.constructor.call(this,a),this.hT="1e"},bP(m.asn1.DERBMPString,m.asn1.DERAbstractString),m.asn1.DERUTCTime=function(a){m.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var a=this.params;if(void 0==this.params&&(a={date:new Date}),"string"==typeof a)if(a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=bc(a);else throw Error("malformed string for UTCTime: "+a);else if(void 0!=a.str)this.hV=bc(a.str);else if(void 0==a.date&&!0==a.millis){var b=new Date;this.hV=bc(this.formatDate(b,"utc",!0))}else if(void 0!=a.date&&a.date instanceof Date){var c=!0===a.millis;this.hV=bc(this.formatDate(a.date,"utc",c))}else a instanceof Date&&(this.hV=bc(this.formatDate(a,"utc")));if(void 0==this.hV)throw Error("parameter not specified properly for UTCTime");return this.hV},void 0!=a&&this.setByParam(a)},bP(m.asn1.DERUTCTime,m.asn1.DERAbstractTime),m.asn1.DERGeneralizedTime=function(a){m.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.params=a,this.getFreshValueHex=function(){var a=this.params;if(void 0==this.params&&(a={date:new Date}),"string"==typeof a)if(a.match(/^[0-9]{14}Z$/)||a.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=bc(a);else throw Error("malformed string for GeneralizedTime: "+a);else if(void 0!=a.str)this.hV=bc(a.str);else if(void 0==a.date&&!0==a.millis){var b=new Date;this.hV=bc(this.formatDate(b,"gen",!0))}else if(void 0!=a.date&&a.date instanceof Date){var c=!0===a.millis;this.hV=bc(this.formatDate(a.date,"gen",c))}else a instanceof Date&&(this.hV=bc(this.formatDate(a,"gen")));if(void 0==this.hV)throw Error("parameter not specified properly for GeneralizedTime");return this.hV},void 0!=a&&this.setByParam(a)},bP(m.asn1.DERGeneralizedTime,m.asn1.DERAbstractTime),m.asn1.DERSequence=function(a){m.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var a="",b=0;b<this.asn1Array.length;b++)a+=this.asn1Array[b].tohex();return this.hV=a,this.hV}},bP(m.asn1.DERSequence,m.asn1.DERAbstractStructured),m.asn1.DERSet=function(a){m.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var a=[],b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a.push(c.tohex())}return!0==this.sortFlag&&a.sort(),this.hV=a.join(""),this.hV},void 0!==a&&void 0!==a.sortflag&&!1==a.sortflag&&(this.sortFlag=!1)},bP(m.asn1.DERSet,m.asn1.DERAbstractStructured),m.asn1.DERTaggedObject=function(a){m.asn1.DERTaggedObject.superclass.constructor.call(this);var b=m.asn1,c=a8.getV,d=(a8.isASN1HEX,b.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(a,b,c){this.params={tag:b,explicit:a,obj:c}},this.getFreshValueHex=function(){var a,e=this.params;if(void 0==e.explicit&&(e.explicit=!0),void 0!=e.tage&&(e.tag=e.tage,e.explicit=!0),void 0!=e.tagi&&(e.tag=e.tagi,e.explicit=!1),void 0!=e.str)this.hV=bh(e.str);else if(void 0!=e.hex)this.hV=e.hex;else if(void 0!=e.obj)e.obj instanceof b.ASN1Object?a=e.obj.tohex():"object"==typeof e.obj&&(a=d(e.obj).tohex()),e.explicit?this.hV=a:this.hV=c(a,0);else throw Error("str, hex nor obj not specified");return void 0==e.tag&&(e.tag="a0"),this.hT=e.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.DERTaggedObject,m.asn1.ASN1Object);var a8=new function(){};function a9(a){for(var b=[],c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}function ba(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}function bb(a){for(var b="",c=0;c<a.length;c++){var d=a[c].toString(16);1==d.length&&(d="0"+d),b+=d}return b}function bc(a){return bb(a9(a))}function bd(a){return(a=(a=a.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function be(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),a=(a=a.replace(/-/g,"+")).replace(/_/g,"/")}function bf(a){return a.length%2==1&&(a="0"+a),bd(t(a))}function bg(a){return u(be(a))}function bh(a){return bs(bB(a)).toLowerCase()}function bi(a){try{return decodeURIComponent(bt(a))}catch(a){return null}}a8.getLblen=function(a,b){if("8"!=a.substr(b+2,1))return 1;var c=parseInt(a.substr(b+3,1));return 0==c?-1:0<c&&c<10?c+1:-2},a8.getL=function(a,b){var c=a8.getLblen(a,b);return c<1?"":a.substr(b+2,2*c)},a8.getVblen=function(a,b){var c;return""==(c=a8.getL(a,b))?-1:("8"===c.substr(0,1)?new w(c.substr(2),16):new w(c,16)).intValue()},a8.getVidx=function(a,b){var c=a8.getLblen(a,b);return c<0?c:b+(c+1)*2},a8.getV=function(a,b){var c=a8.getVidx(a,b),d=a8.getVblen(a,b);return a.substr(c,2*d)},a8.getTLV=function(a,b){return a.substr(b,2)+a8.getL(a,b)+a8.getV(a,b)},a8.getTLVblen=function(a,b){return 2+2*a8.getLblen(a,b)+2*a8.getVblen(a,b)},a8.getNextSiblingIdx=function(a,b){return a8.getVidx(a,b)+2*a8.getVblen(a,b)},a8.getChildIdx=function(a,b){var c,d,e,f=[];c=a8.getVidx(a,b),d=2*a8.getVblen(a,b),"03"==a.substr(b,2)&&(c+=2,d-=2),e=0;for(var g=c;e<=d;){var h=a8.getTLVblen(a,g);if((e+=h)<=d&&f.push(g),g+=h,e>=d)break}return f},a8.getNthChildIdx=function(a,b,c){return a8.getChildIdx(a,b)[c]},a8.getIdxbyList=function(a,b,c,d){var e,f;return 0==c.length?void 0!==d&&a.substr(b,2)!==d?-1:b:(e=c.shift())>=(f=a8.getChildIdx(a,b)).length?-1:a8.getIdxbyList(a,f[e],c,d)},a8.getIdxbyListEx=function(a,b,c,d){if(0==c.length)return void 0!==d&&a.substr(b,2)!==d?-1:b;e=c.shift(),f=a8.getChildIdx(a,b);for(var e,f,g=0,h=0;h<f.length;h++){var i=a.substr(f[h],2);if("number"==typeof e&&!a8.isContextTag(i)&&g==e||"string"==typeof e&&a8.isContextTag(i,e))return a8.getIdxbyListEx(a,f[h],c,d);!a8.isContextTag(i)&&g++}return -1},a8.getTLVbyList=function(a,b,c,d){var e=a8.getIdxbyList(a,b,c,d);return -1==e||e>=a.length?null:a8.getTLV(a,e)},a8.getTLVbyListEx=function(a,b,c,d){var e=a8.getIdxbyListEx(a,b,c,d);return -1==e?null:a8.getTLV(a,e)},a8.getVbyList=function(a,b,c,d,e){var f,g;return -1==(f=a8.getIdxbyList(a,b,c,d))||f>=a.length?null:(g=a8.getV(a,f),!0===e&&(g=g.substr(2)),g)},a8.getVbyListEx=function(a,b,c,d,e){var f,g;return -1==(f=a8.getIdxbyListEx(a,b,c,d))?null:(g=a8.getV(a,f),"03"==a.substr(f,2)&&!1!==e&&(g=g.substr(2)),g)},a8.getInt=function(a,b,c){void 0==c&&(c=-1);try{var d=a.substr(b,2);if("02"!=d&&"03"!=d)return c;var e=a8.getV(a,b);if("02"==d)return parseInt(e,16);return bK(e)}catch(a){return c}},a8.getOID=function(a,b,c){void 0==c&&(c=null);try{if("06"!=a.substr(b,2))return c;var d=a8.getV(a,b);return bG(d)}catch(a){return c}},a8.getOIDName=function(a,b,c){void 0==c&&(c=null);try{var d=a8.getOID(a,b,c);if(d==c)return c;var e=m.asn1.x509.OID.oid2name(d);if(""==e)return d;return e}catch(a){return c}},a8.getString=function(a,b,c){void 0==c&&(c=null);try{var d=a8.getV(a,b);return bj(d)}catch(a){return c}},a8.hextooidstr=function(a){var b=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a},c=[],d=parseInt(a.substr(0,2),16);c[0]=new String(Math.floor(d/40)),c[1]=new String(d%40);for(var e=a.substr(2),f=[],g=0;g<e.length/2;g++)f.push(parseInt(e.substr(2*g,2),16));for(var h=[],i="",g=0;g<f.length;g++)128&f[g]?i+=b((127&f[g]).toString(2),7):(h.push(new String(parseInt(i+=b((127&f[g]).toString(2),7),2))),i="");var j=c.join(".");return h.length>0&&(j=j+"."+h.join(".")),j},a8.dump=function(a,b,c,d){var e=a8.getV,f=a8.dump,g=a8.getChildIdx,h=a;a instanceof m.asn1.ASN1Object&&(h=a.tohex());var i=function(a,b){return a.length<=2*b?a:a.substr(0,b)+"..(total "+a.length/2+"bytes).."+a.substr(a.length-b,b)};void 0===b&&(b={ommit_long_octet:32}),void 0===c&&(c=0),void 0===d&&(d="");var j=b.ommit_long_octet,k=h.substr(c,2);if("01"==k){var l=e(h,c);return"00"==l?d+"BOOLEAN FALSE\n":d+"BOOLEAN TRUE\n"}if("02"==k){var l=e(h,c);return d+"INTEGER "+i(l,j)+"\n"}if("03"==k){var l=e(h,c);if(!a8.isASN1HEX(l.substr(2)))return d+"BITSTRING "+i(l,j)+"\n";var n=d+"BITSTRING, encapsulates\n";return n+f(l.substr(2),b,0,d+"  ")}if("04"==k){var l=e(h,c);if(!a8.isASN1HEX(l))return d+"OCTETSTRING "+i(l,j)+"\n";var n=d+"OCTETSTRING, encapsulates\n";return n+f(l,b,0,d+"  ")}if("05"==k)return d+"NULL\n";if("06"==k){var o=e(h,c),p=m.asn1.ASN1Util.oidHexToInt(o),q=m.asn1.x509.OID.oid2name(p),r=p.replace(/\./g," ");return""!=q?d+"ObjectIdentifier "+q+" ("+r+")\n":d+"ObjectIdentifier ("+r+")\n"}if("0a"==k)return d+"ENUMERATED "+parseInt(e(h,c))+"\n";if("0c"==k)return d+"UTF8String '"+bi(e(h,c))+"'\n";if("13"==k)return d+"PrintableString '"+bi(e(h,c))+"'\n";if("14"==k)return d+"TeletexString '"+bi(e(h,c))+"'\n";if("16"==k)return d+"IA5String '"+bi(e(h,c))+"'\n";if("17"==k)return d+"UTCTime "+bi(e(h,c))+"\n";if("18"==k)return d+"GeneralizedTime "+bi(e(h,c))+"\n";if("1a"==k)return d+"VisualString '"+bi(e(h,c))+"'\n";if("1e"==k)return d+"BMPString '"+bA(e(h,c))+"'\n";if("30"==k){if("3000"==h.substr(c,4))return d+"SEQUENCE {}\n";var n=d+"SEQUENCE\n",s=g(h,c),t=b;if((2==s.length||3==s.length)&&"06"==h.substr(s[0],2)&&"04"==h.substr(s[s.length-1],2)){var q=a8.oidname(e(h,s[0])),u=JSON.parse(JSON.stringify(b));u.x509ExtName=q,t=u}for(var v=0;v<s.length;v++)n+=f(h,t,s[v],d+"  ");return n}if("31"==k){for(var n=d+"SET\n",s=g(h,c),v=0;v<s.length;v++)n+=f(h,b,s[v],d+"  ");return n}var k=parseInt(k,16);if((128&k)!=0){var w=31&k;if((32&k)!=0){for(var n=d+"["+w+"]\n",s=g(h,c),v=0;v<s.length;v++)n+=f(h,b,s[v],d+"  ");return n}var l=e(h,c);if(a8.isASN1HEX(l)){var n=d+"["+w+"]\n";return n+f(l,b,0,d+"  ")}"68747470"==l.substr(0,8)?l=bi(l):"subjectAltName"===b.x509ExtName&&2==w&&(l=bi(l));var n=d+"["+w+"] "+l+"\n";return n}return d+"UNKNOWN("+k+") "+e(h,c)+"\n"},a8.parse=function(a){var b=a8.parse,c=a8.isASN1HEX,d=a8.getV,e=a8.getTLV,f=a8.getChildIdx,g=m.asn1,h=g.ASN1Util.oidHexToInt,i=g.x509.OID.oid2name,j=bi,k={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},l=a.substr(0,2),n={},o=d(a,0);if("01"==l)return"0101ff"==a?{bool:!0}:{bool:!1};if("02"==l)return{int:{hex:o}};if("03"==l)try{if("00"!=o.substr(0,2))throw"not encap";var p=o.substr(2);if(!c(p))throw"not encap";return{bitstr:{obj:b(p)}}}catch(a){var q=null;if(o.length<=10&&(q=bM(o)),null==q)return{bitstr:{hex:o}};return{bitstr:{bin:q}}}if("04"==l)try{if(!c(o))throw"not encap";return{octstr:{obj:b(o)}}}catch(a){return{octstr:{hex:o}}}if("05"==l)return{null:""};else if("06"==l){var r=h(o),s=i(r);return""==s?{oid:r}:{oid:s}}else if("0a"==l)if(o.length>4)return{enum:{hex:o}};else return{enum:parseInt(o,16)};else if("30"==l||"31"==l)return n[k[l]]=function(a){for(var c=[],d=f(a,0),g=0;g<d.length;g++){var h=b(e(a,d[g]));c.push(h)}return c}(a),n;else if("14"==l){var t=function(a){return bi(function(a){for(var b=a.match(/.{1,2}/g),c=[],d=0;d<b.length;d++){var e=parseInt(b[d],16);161<=e&&e<=191?(c.push("c2"),c.push(b[d])):192<=e&&e<=255?(c.push("c3"),c.push((e-64).toString(16))):c.push(b[d])}return c.join("")}(a))}(o);return n[k[l]]={str:t},n}else if("1e"==l){var t=bA(o);return n[k[l]]={str:t},n}else if(-1!=":0c:12:13:16:17:18:1a:".indexOf(l)){var t=j(o);return n[k[l]]={str:t},n}else if(l.match(/^8[0-9]$/)){var t=j(o);return null==t|""==t||null!=t.match(/[\x00-\x1F\x7F-\x9F]/)||null!=t.match(/[\u0000-\u001F\u0080–\u009F]/)?{tag:{tag:l,explicit:!1,hex:o}}:{tag:{tag:l,explicit:!1,str:t}}}else if(l.match(/^a[0-9]$/))try{if(!c(o))throw Error("not encap");return{tag:{tag:l,explicit:!0,obj:b(o)}}}catch(a){return{tag:{tag:l,explicit:!0,hex:o}}}else{var u=new m.asn1.ASN1Object;return u.hV=o,{asn1:{tlv:l+u.getLengthHexFromValue()+o}}}},a8.isContextTag=function(a,b){a=a.toLowerCase();try{c=parseInt(a,16)}catch(a){return -1}if(void 0===b)if((192&c)==128)return!0;else return!1;try{var c,d,e=b.match(/^\[[0-9]+\]$/);if(null==e||(d=parseInt(b.substr(1,b.length-1),10))>31)return!1;if((192&c)==128&&(31&c)==d)return!0;return!1}catch(a){return!1}},a8.isASN1HEX=function(a){if(a.length%2==1)return!1;var b=a8.getVblen(a,0),c=a.substr(0,2),d=a8.getL(a,0);return a.length-c.length-d.length==2*b},a8.checkStrictDER=function(a,b,c,d,e){if(void 0===c){if("string"!=typeof a||(a=a.toLowerCase(),!m.lang.String.isHex(a)))throw Error("not hex string");c=a.length,e=(d=a.length/2)<128?1:Math.ceil(d.toString(16))+1}if(a8.getL(a,b).length>2*e)throw Error("L of TLV too long: idx="+b);var f=a8.getVblen(a,b);if(f>d)throw Error("value of L too long than hex: idx="+b);var g=a8.getTLV(a,b),h=g.length-2-a8.getL(a,b).length;if(h!==2*f)throw Error("V string length and L's value not the same:"+h+"/"+2*f);if(0===b&&a.length!=g.length)throw Error("total length and TLV length unmatch:"+a.length+"!="+g.length);var i=a.substr(b,2);if("02"===i){var j=a8.getVidx(a,b);if("00"==a.substr(j,2)&&56>a.charCodeAt(j+2))throw Error("not least zeros for DER INTEGER")}if(32&parseInt(i,16)){for(var k=a8.getVblen(a,b),l=0,n=a8.getChildIdx(a,b),o=0;o<n.length;o++)l+=a8.getTLV(a,n[o]).length,a8.checkStrictDER(a,n[o],c,d,e);if(2*k!=l)throw Error("sum of children's TLV length and L unmatch: "+2*k+"!="+l)}},a8.oidname=function(a){var b=m.asn1;m.lang.String.isHex(a)&&(a=b.ASN1Util.oidHexToInt(a));var c=b.x509.OID.oid2name(a);return""===c&&(c=a),c},void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),void 0!==m.asn1.x509&&m.asn1.x509||(m.asn1.x509={}),m.asn1.x509.Certificate=function(a){m.asn1.x509.Certificate.superclass.constructor.call(this);var b=m.asn1,c=b.DERBitString,d=b.DERSequence,e=b.x509,f=e.TBSCertificate,g=e.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(a){this.params=a},this.sign=function(){var a=this.params,b=a.sigalg;void 0!=a.sigalg.name&&(b=a.sigalg.name);var c=a.tbsobj.tohex(),d=new m.crypto.Signature({alg:b});d.init(a.cakey),d.updateHex(c),a.sighex=d.sign()},this.getPEM=function(){return bn(this.tohex(),"CERTIFICATE")},this.tohex=function(){var a=this.params;if((void 0==a.tbsobj||null==a.tbsobj)&&(a.tbsobj=new f(a)),void 0==a.sighex&&void 0!=a.cakey&&this.sign(),void 0==a.sighex)throw Error("sighex or cakey parameter not defined");var b=[];return b.push(a.tbsobj),b.push(new g({name:a.sigalg})),b.push(new c({hex:"00"+a.sighex})),new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&(this.params=a)},bP(m.asn1.x509.Certificate,m.asn1.ASN1Object),m.asn1.x509.TBSCertificate=function(a){m.asn1.x509.TBSCertificate.superclass.constructor.call(this);var b=m.asn1,c=b.x509,d=b.DERTaggedObject,e=b.DERInteger,f=b.DERSequence,g=c.AlgorithmIdentifier,h=c.Time,i=c.X500Name,j=c.Extensions,k=c.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=[],b=this.params;if(void 0!=b.version||1!=b.version){var c=2;void 0!=b.version&&(c=b.version-1);var l=new d({obj:new e({int:c})});a.push(l)}return a.push(new e(b.serial)),a.push(new g({name:b.sigalg})),a.push(new i(b.issuer)),a.push(new f({array:[new h(b.notbefore),new h(b.notafter)]})),a.push(new i(b.subject)),a.push(new k(bQ.getKey(b.sbjpubkey))),void 0!==b.ext&&b.ext.length>0&&a.push(new d({tag:"a3",obj:new j(b.ext)})),new m.asn1.DERSequence({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.TBSCertificate,m.asn1.ASN1Object),m.asn1.x509.Extensions=function(a){m.asn1.x509.Extensions.superclass.constructor.call(this);var b=m.asn1,c=b.DERSequence,d=b.x509;this.aParam=[],this.setByParam=function(a){this.aParam=a},this.tohex=function(){for(var a=[],b=0;b<this.aParam.length;b++){var e=this.aParam[b],f=e.extname,g=null;if(void 0!=e.extn)g=new d.PrivateExtension(e);else if("subjectKeyIdentifier"==f)g=new d.SubjectKeyIdentifier(e);else if("keyUsage"==f)g=new d.KeyUsage(e);else if("subjectAltName"==f)g=new d.SubjectAltName(e);else if("issuerAltName"==f)g=new d.IssuerAltName(e);else if("basicConstraints"==f)g=new d.BasicConstraints(e);else if("nameConstraints"==f)g=new d.NameConstraints(e);else if("cRLDistributionPoints"==f)g=new d.CRLDistributionPoints(e);else if("certificatePolicies"==f)g=new d.CertificatePolicies(e);else if("policyMappings"==f)g=new d.PolicyMappings(e);else if("policyConstraints"==f)g=new d.PolicyConstraints(e);else if("inhibitAnyPolicy"==f)g=new d.InhibitAnyPolicy(e);else if("authorityKeyIdentifier"==f)g=new d.AuthorityKeyIdentifier(e);else if("extKeyUsage"==f)g=new d.ExtKeyUsage(e);else if("authorityInfoAccess"==f)g=new d.AuthorityInfoAccess(e);else if("cRLNumber"==f)g=new d.CRLNumber(e);else if("cRLReason"==f)g=new d.CRLReason(e);else if("ocspNonce"==f)g=new d.OCSPNonce(e);else if("ocspNoCheck"==f)g=new d.OCSPNoCheck(e);else if("adobeTimeStamp"==f)g=new d.AdobeTimeStamp(e);else if("subjectDirectoryAttributes"==f)g=new d.SubjectDirectoryAttributes(e);else throw Error("extension not supported:"+JSON.stringify(e));null!=g&&a.push(g)}return new c({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.x509.Extensions,m.asn1.ASN1Object),m.asn1.x509.Extension=function(a){m.asn1.x509.Extension.superclass.constructor.call(this);var b=m.asn1,c=b.DERObjectIdentifier,d=b.DEROctetString,e=(b.DERBitString,b.DERBoolean),f=b.DERSequence;this.tohex=function(){var a=new c({oid:this.oid}),b=new d({hex:this.getExtnValueHex()}),g=[];return g.push(a),this.critical&&g.push(new e),g.push(b),new f({array:g}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,void 0!==a&&void 0!==a.critical&&(this.critical=a.critical)},bP(m.asn1.x509.Extension,m.asn1.ASN1Object),m.asn1.x509.KeyUsage=function(a){m.asn1.x509.KeyUsage.superclass.constructor.call(this,a);var b=Error,c={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var a=this.getBinValue();return this.asn1ExtnValue=new m.asn1.DERBitString({bin:a}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var a=this.params;if("object"!=typeof a||"object"!=typeof a.names&&"string"!=typeof a.bin)throw new b("parameter not yet set");if(void 0!=a.names)return bN(a.names,c);if(void 0!=a.bin)return a.bin;throw new b("parameter not set properly")},this.oid="2.5.29.15",void 0!==a&&(this.params=a)},bP(m.asn1.x509.KeyUsage,m.asn1.x509.Extension),m.asn1.x509.BasicConstraints=function(a){m.asn1.x509.BasicConstraints.superclass.constructor.call(this,a);var b=m.asn1,c=b.DERBoolean,d=b.DERInteger,e=b.DERSequence;this.getExtnValueHex=function(){var a=[];this.cA&&a.push(new c),this.pathLen>-1&&a.push(new d({int:this.pathLen}));var b=new e({array:a});return this.asn1ExtnValue=b,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==a&&(void 0!==a.cA&&(this.cA=a.cA),void 0!==a.pathLen&&(this.pathLen=a.pathLen))},bP(m.asn1.x509.BasicConstraints,m.asn1.x509.Extension),m.asn1.x509.CRLDistributionPoints=function(a){m.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a);var b=m.asn1,c=b.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(a){for(var d=[],e=0;e<a.length;e++)if(a[e]instanceof m.asn1.ASN1Object)d.push(a[e]);else{var f=new c.DistributionPoint(a[e]);d.push(f)}this.asn1ExtnValue=new b.DERSequence({array:d})},this.setByOneURI=function(a){var b=new c.DistributionPoint({fulluri:a});this.setByDPArray([b])},this.oid="2.5.29.31",void 0!==a&&(void 0!==a.array?this.setByDPArray(a.array):void 0!==a.uri&&this.setByOneURI(a.uri))},bP(m.asn1.x509.CRLDistributionPoints,m.asn1.x509.Extension),m.asn1.x509.DistributionPoint=function(a){m.asn1.x509.DistributionPoint.superclass.constructor.call(this);var b=m.asn1,c=b.x509.DistributionPointName;this.tohex=function(){var a=new b.DERSequence;if(null!=this.asn1DP){var c=new b.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});a.appendASN1Object(c)}return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.dpobj?this.asn1DP=a.dpobj:void 0!==a.dpname?this.asn1DP=new c(a.dpname):void 0!==a.fulluri&&(this.asn1DP=new c({full:[{uri:a.fulluri}]})))},bP(m.asn1.x509.DistributionPoint,m.asn1.ASN1Object),m.asn1.x509.DistributionPointName=function(a){m.asn1.x509.DistributionPointName.superclass.constructor.call(this);var b=m.asn1,c=b.DERTaggedObject;if(this.tohex=function(){if("full"!=this.type)throw Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new c({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a)if(b.x509.GeneralNames.prototype.isPrototypeOf(a))this.type="full",this.tag="a0",this.asn1V=a;else if(void 0!==a.full)this.type="full",this.tag="a0",this.asn1V=new b.x509.GeneralNames(a.full);else throw Error("This class supports GeneralNames only as argument")},bP(m.asn1.x509.DistributionPointName,m.asn1.ASN1Object),m.asn1.x509.CertificatePolicies=function(a){m.asn1.x509.CertificatePolicies.superclass.constructor.call(this,a);var b=m.asn1,c=b.x509,d=b.DERSequence,e=c.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var a=[],b=0;b<this.params.array.length;b++)a.push(new e(this.params.array[b]));var c=new d({array:a});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",void 0!==a&&(this.params=a)},bP(m.asn1.x509.CertificatePolicies,m.asn1.x509.Extension),m.asn1.x509.PolicyInformation=function(a){m.asn1.x509.PolicyInformation.superclass.constructor.call(this,a);var b=m.asn1,c=b.DERSequence,d=b.DERObjectIdentifier,e=b.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw Error("parameter oid and array missing");var a=[new d(this.params.policyoid)];if(void 0!==this.params.array){for(var b=[],f=0;f<this.params.array.length;f++)b.push(new e(this.params.array[f]));b.length>0&&a.push(new c({array:b}))}return new c({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},bP(m.asn1.x509.PolicyInformation,m.asn1.ASN1Object),m.asn1.x509.PolicyQualifierInfo=function(a){m.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,a);var b=m.asn1,c=b.DERSequence,d=b.DERIA5String,e=b.DERObjectIdentifier,f=b.x509.UserNotice;this.params=null,this.tohex=function(){if(void 0!==this.params.cps){var a=new c({array:[new e({oid:"1.3.6.1.5.5.7.2.1"}),new d({str:this.params.cps})]});return a.tohex()}if(void 0!=this.params.unotice){var a=new c({array:[new e({oid:"1.3.6.1.5.5.7.2.2"}),new f(this.params.unotice)]});return a.tohex()}},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},bP(m.asn1.x509.PolicyQualifierInfo,m.asn1.ASN1Object),m.asn1.x509.UserNotice=function(a){m.asn1.x509.UserNotice.superclass.constructor.call(this,a);var b=m.asn1.DERSequence,c=(m.asn1.DERInteger,m.asn1.x509.DisplayText),d=m.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var a=[];return void 0!==this.params.noticeref&&a.push(new d(this.params.noticeref)),void 0!==this.params.exptext&&a.push(new c(this.params.exptext)),new b({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},bP(m.asn1.x509.UserNotice,m.asn1.ASN1Object),m.asn1.x509.NoticeReference=function(a){m.asn1.x509.NoticeReference.superclass.constructor.call(this,a);var b=m.asn1.DERSequence,c=m.asn1.DERInteger,d=m.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var a=[];if(void 0!==this.params.org&&a.push(new d(this.params.org)),void 0!==this.params.noticenum){for(var e=[],f=this.params.noticenum,g=0;g<f.length;g++)e.push(new c(f[g]));a.push(new b({array:e}))}if(0==a.length)throw Error("parameter is empty");return new b({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},bP(m.asn1.x509.NoticeReference,m.asn1.ASN1Object),m.asn1.x509.DisplayText=function(a){m.asn1.x509.DisplayText.superclass.constructor.call(this,a),this.hT="0c",void 0!==a&&("ia5"===a.type?this.hT="16":"vis"===a.type?this.hT="1a":"bmp"===a.type&&(this.hT="1e"))},bP(m.asn1.x509.DisplayText,m.asn1.DERAbstractString),m.asn1.x509.PolicyMappings=function(a){m.asn1.x509.PolicyMappings.superclass.constructor.call(this,a);var b=m.asn1,c=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var a=this.params,b=[],d=0;d<a.array.length;d++){var e=a.array[d];b.push({seq:[{oid:e[0]},{oid:e[1]}]})}return this.asn1ExtnValue=c({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",void 0!==a&&(this.params=a)},bP(m.asn1.x509.PolicyMappings,m.asn1.x509.Extension),m.asn1.x509.PolicyConstraints=function(a){m.asn1.x509.PolicyConstraints.superclass.constructor.call(this,a);var b=m.asn1,c=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[];return void 0!=a.reqexp&&b.push({tag:{tagi:"80",obj:{int:a.reqexp}}}),void 0!=a.inhibit&&b.push({tag:{tagi:"81",obj:{int:a.inhibit}}}),this.asn1ExtnValue=c({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",void 0!==a&&(this.params=a)},bP(m.asn1.x509.PolicyConstraints,m.asn1.x509.Extension),m.asn1.x509.InhibitAnyPolicy=function(a){m.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,a);var b=m.asn1,c=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=c({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",void 0!==a&&(this.params=a)},bP(m.asn1.x509.InhibitAnyPolicy,m.asn1.x509.Extension),m.asn1.x509.NameConstraints=function(a){m.asn1.x509.NameConstraints.superclass.constructor.call(this,a);var b=m.asn1,c=b.x509,d=b.ASN1Util.newObject,e=c.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[];if(void 0!=a.permit&&void 0!=a.permit.length){for(var c=[],f=0;f<a.permit.length;f++)c.push(new e(a.permit[f]));b.push({tag:{tagi:"a0",obj:{seq:c}}})}if(void 0!=a.exclude&&void 0!=a.exclude.length){for(var g=[],f=0;f<a.exclude.length;f++)g.push(new e(a.exclude[f]));b.push({tag:{tagi:"a1",obj:{seq:g}}})}return this.asn1ExtnValue=d({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",void 0!==a&&(this.params=a)},bP(m.asn1.x509.NameConstraints,m.asn1.x509.Extension),m.asn1.x509.GeneralSubtree=function(a){m.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var b=m.asn1,c=b.x509.GeneralName,d=b.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,b=[new c(a)];return void 0!=a.min&&b.push({tag:{tagi:"80",obj:{int:a.min}}}),void 0!=a.max&&b.push({tag:{tagi:"81",obj:{int:a.max}}}),d({seq:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.GeneralSubtree,m.asn1.ASN1Object),m.asn1.x509.ExtKeyUsage=function(a){m.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a);var b=m.asn1;this.setPurposeArray=function(a){this.asn1ExtnValue=new b.DERSequence;for(var c=0;c<a.length;c++){var d=new b.DERObjectIdentifier(a[c]);this.asn1ExtnValue.appendASN1Object(d)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",void 0!==a&&void 0!==a.array&&this.setPurposeArray(a.array)},bP(m.asn1.x509.ExtKeyUsage,m.asn1.x509.Extension),m.asn1.x509.AuthorityKeyIdentifier=function(a){m.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,a);var b=m,c=b.asn1,d=c.DERTaggedObject,e=c.x509.GeneralNames;b.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var a=[];this.asn1KID&&a.push(new d({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&a.push(new d({explicit:!1,tag:"a1",obj:new e([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&a.push(new d({explicit:!1,tag:"82",obj:this.asn1CertSN}));var b=new c.DERSequence({array:a});return this.asn1ExtnValue=b,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(void 0!==a.str||void 0!==a.hex)this.asn1KID=new m.asn1.DEROctetString(a);else if("object"==typeof a&&m.crypto.Util.isKey(a)||"string"==typeof a&&-1!=a.indexOf("BEGIN ")){var b=a;"string"==typeof a&&(b=bQ.getKey(a));var c=bQ.getKeyID(b);this.asn1KID=new m.asn1.DEROctetString({hex:c})}},this.setCertIssuerByParam=function(a){void 0!==a.str||void 0!==a.ldapstr||void 0!==a.hex||void 0!==a.certsubject||void 0!==a.certissuer?this.asn1CertIssuer=new m.asn1.x509.X500Name(a):"string"==typeof a&&-1!=a.indexOf("BEGIN ")&&-1!=a.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new m.asn1.x509.X500Name({certissuer:a}))},this.setCertSNByParam=function(a){if(void 0!==a.str||void 0!==a.bigint||void 0!==a.hex)this.asn1CertSN=new m.asn1.DERInteger(a);else if("string"==typeof a&&-1!=a.indexOf("BEGIN ")&&a.indexOf("CERTIFICATE")){var b=new bU;b.readCertPEM(a);var c=b.getSerialNumberHex();this.asn1CertSN=new m.asn1.DERInteger({hex:c})}},this.oid="2.5.29.35",void 0!==a&&(void 0!==a.kid&&this.setKIDByParam(a.kid),void 0!==a.issuer&&this.setCertIssuerByParam(a.issuer),void 0!==a.sn&&this.setCertSNByParam(a.sn),void 0!==a.issuersn&&"string"==typeof a.issuersn&&-1!=a.issuersn.indexOf("BEGIN ")&&a.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(a.issuersn),this.setCertIssuerByParam(a.issuersn)))},bP(m.asn1.x509.AuthorityKeyIdentifier,m.asn1.x509.Extension),m.asn1.x509.SubjectKeyIdentifier=function(a){m.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,a);var b=m.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(void 0!==a.str||void 0!==a.hex)this.asn1KID=new b(a);else if("object"==typeof a&&m.crypto.Util.isKey(a)||"string"==typeof a&&-1!=a.indexOf("BEGIN")){var c=a;"string"==typeof a&&(c=bQ.getKey(a));var d=bQ.getKeyID(c);this.asn1KID=new m.asn1.DEROctetString({hex:d})}},this.oid="2.5.29.14",void 0!==a&&void 0!==a.kid&&this.setKIDByParam(a.kid)},bP(m.asn1.x509.SubjectKeyIdentifier,m.asn1.x509.Extension),m.asn1.x509.AuthorityInfoAccess=function(a){m.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a),this.setAccessDescriptionArray=function(a){for(var b=[],c=m.asn1,d=c.DERSequence,e=c.DERObjectIdentifier,f=c.x509.GeneralName,g=0;g<a.length;g++){var h,i=a[g];if(void 0!==i.ocsp)h=new d({array:[new e({oid:"1.3.6.1.5.5.7.48.1"}),new f({uri:i.ocsp})]});else if(void 0!==i.caissuer)h=new d({array:[new e({oid:"1.3.6.1.5.5.7.48.2"}),new f({uri:i.caissuer})]});else throw Error("unknown AccessMethod parameter: "+JSON.stringify(i));b.push(h)}this.asn1ExtnValue=new d({array:b})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==a&&void 0!==a.array&&this.setAccessDescriptionArray(a.array)},bP(m.asn1.x509.AuthorityInfoAccess,m.asn1.x509.Extension),m.asn1.x509.SubjectAltName=function(a){m.asn1.x509.SubjectAltName.superclass.constructor.call(this,a),this.setNameArray=function(a){this.asn1ExtnValue=new m.asn1.x509.GeneralNames(a)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",void 0!==a&&void 0!==a.array&&this.setNameArray(a.array)},bP(m.asn1.x509.SubjectAltName,m.asn1.x509.Extension),m.asn1.x509.IssuerAltName=function(a){m.asn1.x509.IssuerAltName.superclass.constructor.call(this,a),this.setNameArray=function(a){this.asn1ExtnValue=new m.asn1.x509.GeneralNames(a)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",void 0!==a&&void 0!==a.array&&this.setNameArray(a.array)},bP(m.asn1.x509.IssuerAltName,m.asn1.x509.Extension),m.asn1.x509.SubjectDirectoryAttributes=function(a){m.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,a);var b=m.asn1,c=b.DERSequence,d=b.ASN1Util.newObject,e=b.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var a=[],b=0;b<this.params.array.length;b++){var f=this.params.array[b];if(void 0!=f.attr&&void 0!=f.array){var g={seq:[{oid:f.attr},{set:f.array}]};a.push(d(g));continue}var h={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==f.attr)h.seq[0].oid=e(f.attr),h.seq[1].set[0]={gentime:f.str};else if("placeOfBirth"==f.attr)h.seq[0].oid=e(f.attr),h.seq[1].set[0]={utf8str:f.str};else if("gender"==f.attr)h.seq[0].oid=e(f.attr),h.seq[1].set[0]={prnstr:f.str};else if("countryOfCitizenship"==f.attr)h.seq[0].oid=e(f.attr),h.seq[1].set[0]={prnstr:f.str};else if("countryOfResidence"==f.attr)h.seq[0].oid=e(f.attr),h.seq[1].set[0]={prnstr:f.str};else throw Error("unsupported attribute: "+f.attr);a.push(new d(h))}var i=new c({array:a});return this.asn1ExtnValue=i,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",void 0!==a&&(this.params=a)},bP(m.asn1.x509.SubjectDirectoryAttributes,m.asn1.x509.Extension),m.asn1.x509.PrivateExtension=function(a){m.asn1.x509.PrivateExtension.superclass.constructor.call(this,a);var b=m,c=b.lang.String.isHex,d=b.asn1,e=d.x509.OID.name2oid,f=d.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.oid=e(a.extname),this.params=a},this.getExtnValueHex=function(){if(void 0==this.params.extname||void 0==this.params.extn)throw Error("extname or extnhex not specified");var a=this.params.extn;if("string"==typeof a&&c(a))return a;if("object"==typeof a)try{return f(a).tohex()}catch(a){}throw Error("unsupported extn value")},void 0!=a&&this.setByParam(a)},bP(m.asn1.x509.PrivateExtension,m.asn1.x509.Extension),m.asn1.x509.CRL=function(a){m.asn1.x509.CRL.superclass.constructor.call(this);var b=m.asn1,c=b.DERSequence,d=b.DERBitString,e=b.x509,f=e.AlgorithmIdentifier,g=e.TBSCertList;this.params=void 0,this.setByParam=function(a){this.params=a},this.sign=function(){var a=new g(this.params).tohex(),b=new m.crypto.Signature({alg:this.params.sigalg});b.init(this.params.cakey),b.updateHex(a);var c=b.sign();this.params.sighex=c},this.getPEM=function(){return bn(this.tohex(),"X509 CRL")},this.tohex=function(){var a=this.params;if(void 0==a.tbsobj&&(a.tbsobj=new g(a)),void 0==a.sighex&&void 0!=a.cakey&&this.sign(),void 0==a.sighex)throw Error("sighex or cakey parameter not defined");var b=[];return b.push(a.tbsobj),b.push(new f({name:a.sigalg})),b.push(new d({hex:"00"+a.sighex})),new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&(this.params=a)},bP(m.asn1.x509.CRL,m.asn1.ASN1Object),m.asn1.x509.TBSCertList=function(a){m.asn1.x509.TBSCertList.superclass.constructor.call(this);var b=m.asn1,c=b.DERInteger,d=b.DERSequence,e=b.DERTaggedObject,f=(b.DERObjectIdentifier,b.x509),g=f.AlgorithmIdentifier,h=f.Time,i=f.Extensions,j=f.X500Name;this.params=null,this.setByParam=function(a){this.params=a},this.getRevCertSequence=function(){for(var a=[],b=this.params.revcert,e=0;e<b.length;e++){var f=[new c(b[e].sn),new h(b[e].date)];void 0!=b[e].ext&&f.push(new i(b[e].ext)),a.push(new d({array:f}))}return new d({array:a})},this.tohex=function(){var a=[],b=this.params;if(void 0!=b.version){var f=new c({int:b.version-1});a.push(f)}if(a.push(new g({name:b.sigalg})),a.push(new j(b.issuer)),a.push(new h(b.thisupdate)),void 0!=b.nextupdate&&a.push(new h(b.nextupdate)),void 0!=b.revcert&&a.push(this.getRevCertSequence()),void 0!=b.ext){var k=new i(b.ext);a.push(new e({tag:"a0",explicit:!0,obj:k}))}return new d({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.TBSCertList,m.asn1.ASN1Object),m.asn1.x509.CRLEntry=function(a){m.asn1.x509.CRLEntry.superclass.constructor.call(this);var b=m.asn1;this.setCertSerial=function(a){this.sn=new b.DERInteger(a)},this.setRevocationDate=function(a){this.time=new b.x509.Time(a)},this.tohex=function(){var a=new b.DERSequence({array:[this.sn,this.time]});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.time&&this.setRevocationDate(a.time),void 0!==a.sn&&this.setCertSerial(a.sn))},bP(m.asn1.x509.CRLEntry,m.asn1.ASN1Object),m.asn1.x509.CRLNumber=function(a){m.asn1.x509.CRLNumber.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new m.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",void 0!=a&&(this.params=a)},bP(m.asn1.x509.CRLNumber,m.asn1.x509.Extension),m.asn1.x509.CRLReason=function(a){m.asn1.x509.CRLReason.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new m.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",void 0!=a&&(this.params=a)},bP(m.asn1.x509.CRLReason,m.asn1.x509.Extension),m.asn1.x509.OCSPNonce=function(a){m.asn1.x509.OCSPNonce.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new m.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",void 0!=a&&(this.params=a)},bP(m.asn1.x509.OCSPNonce,m.asn1.x509.Extension),m.asn1.x509.OCSPNoCheck=function(a){m.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new m.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",void 0!=a&&(this.params=a)},bP(m.asn1.x509.OCSPNoCheck,m.asn1.x509.Extension),m.asn1.x509.AdobeTimeStamp=function(a){m.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,a);var b=m.asn1,c=b.DERInteger,d=b.DERBoolean,e=b.DERSequence,f=b.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[new c(1)];return b.push(new f({uri:a.uri})),void 0!=a.reqauth&&b.push(new d(a.reqauth)),this.asn1ExtnValue=new e({array:b}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.AdobeTimeStamp,m.asn1.x509.Extension),m.asn1.x509.X500Name=function(a){m.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var b=m.asn1,c=b.x509,d=c.RDN;this.setByString=function(a,b){void 0!==b&&(this.sRule=b);var c=a.split("/");c.shift();for(var e=[],f=0;f<c.length;f++)if(c[f].match(/^[^=]+=.+$/))e.push(c[f]);else{var g=e.length-1;e[g]=e[g]+"/"+c[f]}for(var f=0;f<e.length;f++)this.asn1Array.push(new d({str:e[f],rule:this.sRule}))},this.setByLdapString=function(a,b){void 0!==b&&(this.sRule=b);var d=c.X500Name.ldapToCompat(a);this.setByString(d,b)},this.setByObject=function(a,b){for(var c in void 0!==b&&(this.sRule=b),a)if(a.hasOwnProperty(c)){var e=new d({str:c+"="+a[c],rule:this.sRule});this.asn1Array?this.asn1Array.push(e):this.asn1Array=[e]}},this.setByParam=function(a){if(void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.array)this.paramArray=a.array;else if(void 0!==a.str)this.setByString(a.str);else if(void 0!==a.ldapstr)this.setByLdapString(a.ldapstr);else if(void 0!==a.hex)this.hTLV=a.hex;else if(void 0!==a.certissuer){var b=new bU;b.readCertPEM(a.certissuer),this.hTLV=b.getIssuerHex()}else if(void 0!==a.certsubject){var b=new bU;b.readCertPEM(a.certsubject),this.hTLV=b.getSubjectHex()}else"object"==typeof a&&void 0===a.certsubject&&void 0===a.certissuer&&this.setByObject(a)},this.tohex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var c={array:this.paramArray[a]};"utf8"!=this.sRule&&(c.rule=this.sRule);var e=new d(c);this.asn1Array.push(e)}var f=new b.DERSequence({array:this.asn1Array});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.X500Name,m.asn1.ASN1Object),m.asn1.x509.X500Name.compatToLDAP=function(a){if("/"!==a.substr(0,1))throw"malformed input";var b=(a=a.substr(1)).split("/");return b.reverse(),(b=b.map(function(a){return a.replace(/,/,"\\,")})).join(",")},m.asn1.x509.X500Name.onelineToLDAP=function(a){return m.asn1.x509.X500Name.compatToLDAP(a)},m.asn1.x509.X500Name.ldapToCompat=function(a){for(var b=a.split(","),c=!1,d=[],e=0;b.length>0;e++){var f=b.shift();if(!0===c){var g=(d.pop()+","+f).replace(/\\,/g,",");d.push(g),c=!1}else d.push(f);"\\"===f.substr(-1,1)&&(c=!0)}return(d=d.map(function(a){return a.replace("/","\\/")})).reverse(),"/"+d.join("/")},m.asn1.x509.X500Name.ldapToOneline=function(a){return m.asn1.x509.X500Name.ldapToCompat(a)},m.asn1.x509.RDN=function(a){m.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var b=m.asn1.x509.AttributeTypeAndValue;this.setByParam=function(a){void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.str&&this.addByMultiValuedString(a.str),void 0!==a.array&&(this.paramArray=a.array)},this.addByString=function(a){this.asn1Array.push(new m.asn1.x509.AttributeTypeAndValue({str:a,rule:this.sRule}))},this.addByMultiValuedString=function(a){for(var b=m.asn1.x509.RDN.parseString(a),c=0;c<b.length;c++)this.addByString(b[c])},this.tohex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var c=this.paramArray[a];void 0!==c.rule&&"utf8"!=this.sRule&&(c.rule=this.sRule);var d=new b(c);this.asn1Array.push(d)}var e=new m.asn1.DERSet({array:this.asn1Array});return this.TLV=e.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.RDN,m.asn1.ASN1Object),m.asn1.x509.RDN.parseString=function(a){for(var b=a.split(/\+/),c=!1,d=[],e=0;b.length>0;e++){var f=b.shift();if(!0===c){var g=(d.pop()+"+"+f).replace(/\\\+/g,"+");d.push(g),c=!1}else d.push(f);"\\"===f.substr(-1,1)&&(c=!0)}for(var h=!1,i=[],e=0;d.length>0;e++){var f=d.shift();if(!0===h){var j=i.pop();if(f.match(/"$/)){var g=(j+"+"+f).replace(/^([^=]+)="(.*)"$/,"$1=$2");i.push(g),h=!1}else i.push(j+"+"+f)}else i.push(f);f.match(/^[^=]+="/)&&(h=!0)}return i},m.asn1.x509.AttributeTypeAndValue=function(a){m.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var b=m,c=b.asn1,d=c.DERSequence,e=c.DERUTF8String,f=c.DERPrintableString,g=c.DERTeletexString,h=c.DERIA5String,i=c.DERVisibleString,j=c.DERBMPString,k=b.lang.String.isMail,l=b.lang.String.isPrintable;this.setByParam=function(a){if(void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.ds&&(this.dsType=a.ds),void 0===a.value&&void 0!==a.str){var b=a.str.match(/^([^=]+)=(.+)$/);if(b)this.sType=b[1],this.sValue=b[2];else throw Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=a.type,this.sValue=a.value},this.setByString=function(a,b){void 0!==b&&(this.sRule=b);var c=a.match(/^([^=]+)=(.+)$/);if(c)this.setByAttrTypeAndValueStr(c[1],c[2]);else throw Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var a=this.sType,b=this.sValue,c=this.sRule;if("prn"===c){if("CN"==a&&k(b))return"ia5";if(l(b))return"prn"}else if("utf8"===c){if("CN"==a&&k(b))return"ia5";if("C"==a)return"prn"}return"utf8"},this.setByAttrTypeAndValueStr=function(a,b,c){void 0!==c&&(this.sRule=c),this.sType=a,this.sValue=b},this.getValueObj=function(a,b){if("utf8"==a)return new e({str:b});if("prn"==a)return new f({str:b});if("tel"==a)return new g({str:b});if("ia5"==a)return new h({str:b});if("vis"==a)return new i({str:b});if("bmp"==a)return new j({str:b});throw Error("unsupported directory string type: type="+a+" value="+b)},this.tohex=function(){null==this.dsType&&(this.dsType=this._getDsType());var a=new d({array:[m.asn1.x509.OID.atype2obj(this.sType),this.getValueObj(this.dsType,this.sValue)]});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.AttributeTypeAndValue,m.asn1.ASN1Object),m.asn1.x509.SubjectPublicKeyInfo=function(a){m.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var b=m,c=b.asn1,d=c.DERInteger,e=c.DERBitString,f=c.DERObjectIdentifier,g=c.DERSequence,h=c.ASN1Util.newObject,i=c.x509.AlgorithmIdentifier,j=b.crypto;j.ECDSA,j.DSA,this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new g({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var a=this.getASN1Object();return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(a){try{if(a instanceof a3){var b=h({seq:[{int:{bigint:a.n}},{int:{int:a.e}}]}).tohex();this.asn1AlgId=new i({name:"rsaEncryption"}),this.asn1SubjPKey=new e({hex:"00"+b})}}catch(a){}try{if(a instanceof m.crypto.ECDSA){var c=new f({name:a.curveName});this.asn1AlgId=new i({name:"ecPublicKey",asn1params:c}),this.asn1SubjPKey=new e({hex:"00"+a.pubKeyHex})}}catch(a){}try{if(a instanceof m.crypto.DSA){var c=new h({seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]});this.asn1AlgId=new i({name:"dsa",asn1params:c});var g=new d({bigint:a.y});this.asn1SubjPKey=new e({hex:"00"+g.tohex()})}}catch(a){}},void 0!==a&&this.setPubKey(a)},bP(m.asn1.x509.SubjectPublicKeyInfo,m.asn1.ASN1Object),m.asn1.x509.Time=function(a){m.asn1.x509.Time.superclass.constructor.call(this);var b=m.asn1,c=b.DERUTCTime,d=b.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(a){this.timeParams=a},this.setByParam=function(a){this.params=a},this.getType=function(a){return a.match(/^[0-9]{12}Z$/)?"utc":a.match(/^[0-9]{14}Z$/)?"gen":a.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":a.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var a=this.params,b=null;if("string"==typeof a&&(a={str:a}),null!=a&&a.str&&(null==a.type||void 0==a.type)&&(a.type=this.getType(a.str)),null!=a&&a.str?("utc"==a.type&&(b=new c(a.str)),"gen"==a.type&&(b=new d(a.str))):b="gen"==this.type?new d:new c,null==b)throw Error("wrong setting for Time");return this.TLV=b.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},m.asn1.x509.Time_bak=function(a){m.asn1.x509.Time_bak.superclass.constructor.call(this);var b=m.asn1,c=b.DERUTCTime,d=b.DERGeneralizedTime;this.setTimeParams=function(a){this.timeParams=a},this.tohex=function(){var a=null;return a=null!=this.timeParams?"utc"==this.type?new c(this.timeParams):new d(this.timeParams):"utc"==this.type?new c:new d,this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",void 0!==a&&(void 0!==a.type?this.type=a.type:void 0!==a.str&&(a.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),a.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=a)},bP(m.asn1.x509.Time,m.asn1.ASN1Object),m.asn1.x509.AlgorithmIdentifier=function(a){m.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var b=m.asn1,c=b.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw Error("algorithm not specified");if(null!==this.nameAlg){var a=null;for(var d in c)d===this.nameAlg&&(a=c[d]);if(null!==a)return this.hTLV=a,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=b.x509.OID.name2obj(this.nameAlg));var e=[this.asn1Alg];null!==this.asn1Params&&e.push(this.asn1Params);var f=new b.DERSequence({array:e});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.name&&(this.nameAlg=a.name),void 0!==a.asn1params&&(this.asn1Params=a.asn1params),void 0!==a.paramempty&&(this.paramEmpty=a.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var d=this.nameAlg.toLowerCase();"withdsa"!==d.substr(-7,7)&&"withecdsa"!==d.substr(-9,9)&&(this.asn1Params=new b.DERNull)}},bP(m.asn1.x509.AlgorithmIdentifier,m.asn1.ASN1Object),m.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},m.asn1.x509.GeneralName=function(a){m.asn1.x509.GeneralName.superclass.constructor.call(this);var b=m.asn1,c=b.x509,d=c.X500Name,e=c.OtherName,f=b.DERIA5String,g=(b.DERPrintableString,b.DEROctetString),h=b.DERTaggedObject,i=b.ASN1Object,j=Error;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,b=!1;if(void 0!==a.other)o="a0",c=new e(a.other);else if(void 0!==a.rfc822)o="81",c=new f({str:a.rfc822});else if(void 0!==a.dns)o="82",c=new f({str:a.dns});else if(void 0!==a.dn)o="a4",b=!0,c="string"==typeof a.dn?new d({str:a.dn}):a.dn instanceof m.asn1.x509.X500Name?a.dn:new d(a.dn);else if(void 0!==a.ldapdn)o="a4",b=!0,c=new d({ldapstr:a.ldapdn});else if(void 0!==a.certissuer||void 0!==a.certsubj){var c,k,l,n,o="a4",b=!0,p=null;if(void 0!==a.certsubj?(k=!1,l=a.certsubj):(k=!0,l=a.certissuer),l.match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(p=bo(l)),null==p)throw Error("certsubj/certissuer not cert");var q=new bU;q.hex=p,n=k?q.getIssuerHex():q.getSubjectHex(),(c=new i).hTLV=n}else if(void 0!==a.uri)o="86",c=new f({str:a.uri});else if(void 0!==a.ip){o="87";var r,s=a.ip;try{if(s.match(/^[0-9a-f]+$/)){var t=s.length;if(8==t||16==t||32==t||64==t)r=s;else throw"err"}else r=by(s)}catch(b){throw new j("malformed IP address: "+a.ip+":"+b.message)}c=new g({hex:r})}else throw new j("improper params");return new h({tag:o,explicit:b,obj:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.GeneralName,m.asn1.ASN1Object),m.asn1.x509.GeneralNames=function(a){m.asn1.x509.GeneralNames.superclass.constructor.call(this);var b=m.asn1;this.setByParamArray=function(a){for(var c=0;c<a.length;c++){var d=new b.x509.GeneralName(a[c]);this.asn1Array.push(d)}},this.tohex=function(){return new b.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=[],void 0!==a&&this.setByParamArray(a)},bP(m.asn1.x509.GeneralNames,m.asn1.ASN1Object),m.asn1.x509.OtherName=function(a){m.asn1.x509.OtherName.superclass.constructor.call(this);var b=m.asn1,c=b.DERObjectIdentifier,d=b.DERSequence,e=b.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(void 0==a.oid||void 0==a.value)throw Error("oid or value not specified");return new d({array:[new c({oid:a.oid}),e({tag:{tag:"a0",explicit:!0,obj:a.value}})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.x509.OtherName,m.asn1.ASN1Object),m.asn1.x509.OID=new function(){var a=m.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(b){if(void 0!==this.objCache[b])return this.objCache[b];if(void 0===this.name2oidList[b])throw"Name of ObjectIdentifier not defined: "+b;var c=new a({oid:this.name2oidList[b]});return this.objCache[b]=c,c},this.atype2obj=function(b){if(void 0!==this.objCache[b])return this.objCache[b];if(b.match(/^\d+\.\d+\.[0-9.]+$/))c=b;else if(void 0!==this.atype2oidList[b])c=this.atype2oidList[b];else if(void 0!==this.name2oidList[b])c=this.name2oidList[b];else throw Error("AttributeType name undefined: "+b);var c,d=new a({oid:c});return this.objCache[b]=d,d},this.registerOIDs=function(a){if(this.checkOIDs(a))for(var b in a)this.name2oidList[b]=a[b]},this.checkOIDs=function(a){try{var b=Object.keys(a);if(0==b.length)return!1;return b.map(function(a,b,c){if(!this[a].match(/^[0-2]\.[0-9.]+$/))throw Error("value is not OID")},a),!0}catch(a){return!1}}},m.asn1.x509.OID.oid2name=function(a){var b=m.asn1.x509.OID.name2oidList;for(var c in b)if(b[c]==a)return c;return""},m.asn1.x509.OID.oid2atype=function(a){var b=m.asn1.x509.OID.atype2oidList;for(var c in b)if(b[c]==a)return c;return a},m.asn1.x509.OID.name2oid=function(a){if(a.match(/^[0-9.]+$/))return a;var b=m.asn1.x509.OID.name2oidList;return void 0===b[a]?"":b[a]},m.asn1.x509.X509Util={},m.asn1.x509.X509Util.newCertPEM=function(a){var b=m.asn1.x509;return new(b.TBSCertificate,b.Certificate)(a).getPEM()},void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),void 0!==m.asn1.cms&&m.asn1.cms||(m.asn1.cms={}),m.asn1.cms.Attribute=function(a){var b=Error,c=m.asn1,d=c.DERSequence,e=c.DERSet,f=c.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(a){this.params=a},this.getValueArray=function(){throw new b("not yet implemented abstract")},this.tohex=function(){return new d({array:[new f({oid:this.typeOid}),new e({array:this.getValueArray()})]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},bP(m.asn1.cms.Attribute,m.asn1.ASN1Object),m.asn1.cms.ContentType=function(a){var b=m.asn1;b.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new b.DERObjectIdentifier(this.params.type)]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.ContentType,m.asn1.cms.Attribute),m.asn1.cms.MessageDigest=function(a){var b=m.asn1,c=b.DEROctetString;b.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new c(this.params)]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.MessageDigest,m.asn1.cms.Attribute),m.asn1.cms.SigningTime=function(a){var b=m.asn1;b.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new b.x509.Time(this.params)]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SigningTime,m.asn1.cms.Attribute),m.asn1.cms.SigningCertificate=function(a){var b=Error,c=m,d=c.asn1,e=d.DERSequence,f=d.cms,g=f.ESSCertID;c.crypto,f.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new b("parameter 'array' not specified");for(var c=this.params.array,d=[],f=0;f<c.length;f++){var h=c[f];!1==a.hasis&&"string"==typeof h&&(-1!=h.indexOf("-----BEGIN")||a8.isASN1HEX(h))&&(h={cert:h}),!1!=h.hasis&&!1==a.hasis&&(h.hasis=!1),d.push(new g(h))}var i=new e({array:d});return[new e({array:[i]})]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SigningCertificate,m.asn1.cms.Attribute),m.asn1.cms.ESSCertID=function(a){m.asn1.cms.ESSCertID.superclass.constructor.call(this);var b=Error,c=m,d=c.asn1,e=d.DEROctetString,f=d.DERSequence,g=d.cms.IssuerSerial;this.params=null,this.getCertHash=function(a,d){var e,f,g;if(void 0!=a.hash)return a.hash;if("string"==typeof a&&-1==a.indexOf("-----BEGIN")&&!a8.isASN1HEX(a))return a;if("string"==typeof a)e=a;else if(void 0!=a.cert)e=a.cert;else throw new b("hash nor cert unspecified");if(f=-1!=e.indexOf("-----BEGIN")?bo(e):e,"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?f=bo(a):a8.isASN1HEX(a)&&(f=a)),void 0!=a.alg)g=a.alg;else if(void 0!=d)g=d;else throw new b("hash alg unspecified");return c.crypto.Util.hashHex(f,g)},this.tohex=function(){var a=this.params,b=this.getCertHash(a,"sha1"),c=[];return c.push(new e({hex:b})),("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert&&!1!=a.hasis||void 0!=a.issuer&&void 0!=a.serial)&&c.push(new g(a)),new f({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.ESSCertID,m.asn1.ASN1Object),m.asn1.cms.SigningCertificateV2=function(a){var b=Error,c=m,d=c.asn1,e=d.DERSequence,f=(d.x509,d.cms),g=f.ESSCertIDv2;c.crypto,f.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new b("parameter 'array' not specified");for(var c=this.params.array,d=[],f=0;f<c.length;f++){var h=c[f];(void 0!=a.alg||!1==a.hasis)&&"string"==typeof h&&(-1!=h.indexOf("-----BEGIN")||a8.isASN1HEX(h))&&(h={cert:h}),void 0==h.alg&&void 0!=a.alg&&(h.alg=a.alg),!1!=h.hasis&&!1==a.hasis&&(h.hasis=!1),d.push(new g(h))}var i=new e({array:d});return[new e({array:[i]})]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SigningCertificateV2,m.asn1.cms.Attribute),m.asn1.cms.ESSCertIDv2=function(a){m.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var b=m.asn1,c=b.DEROctetString,d=b.DERSequence,e=b.cms.IssuerSerial,f=b.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var a=this.params,b=this.getCertHash(a,"sha256"),g=[];return void 0!=a.alg&&"sha256"!=a.alg&&g.push(new f({name:a.alg})),g.push(new c({hex:b})),("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert&&!1!=a.hasis||void 0!=a.issuer&&void 0!=a.serial)&&g.push(new e(a)),new d({array:g}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.ESSCertIDv2,m.asn1.cms.ESSCertID),m.asn1.cms.IssuerSerial=function(a){var b=Error,c=m.asn1,d=c.DERInteger,e=c.DERSequence,f=c.cms,g=c.x509.GeneralNames;f.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert){var c,f,h=void 0!=a.cert?a.cert:a,i=new bU;i.readCertPEM(h),c=i.getIssuer(),f={hex:i.getSerialNumberHex()}}else if(void 0!=a.issuer&&a.serial)c=a.issuer,f=a.serial;else throw new b("cert or issuer and serial parameter not specified");return new e({array:[new g([{dn:c}]),new d(f)]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.IssuerSerial,m.asn1.ASN1Object),m.asn1.cms.SignerIdentifier=function(a){var b=m.asn1,c=(b.DERInteger,b.DERSequence,b.cms),d=c.IssuerAndSerialNumber,e=c.SubjectKeyIdentifier;b.x509.X500Name,c.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("isssn"==a.type)return new d(a).tohex();if("skid"==a.type)return new e(a).tohex();throw Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SignerIdentifier,m.asn1.ASN1Object),m.asn1.cms.IssuerAndSerialNumber=function(a){var b=m.asn1,c=b.DERInteger,d=b.DERSequence,e=b.cms,f=b.x509.X500Name,g=Error;e.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert){var b,e,h=void 0!=a.cert?a.cert:a,i=new bU;i.readCertPEM(h),b=i.getIssuer(),e={hex:i.getSerialNumberHex()}}else if(void 0!=a.issuer&&a.serial)b=a.issuer,e=a.serial;else throw new g("cert or issuer and serial parameter not specified");return new d({array:[new f(b),new c(e)]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.IssuerAndSerialNumber,m.asn1.ASN1Object),m.asn1.cms.SubjectKeyIdentifier=function(a){var b=m.asn1,c=(b.DERInteger,b.DERSequence,b.ASN1Util.newObject),d=b.cms,e=((d.IssuerAndSerialName,d.SubjectKeyIdentifier,b.x509).X500Name,Error);d.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var a,b=this.params;if(void 0==b.cert&&void 0==b.skid)throw new e("property cert nor skid undefined");return void 0!=b.cert?a=new bU(b.cert).getExtSubjectKeyIdentifier().kid.hex:void 0!=b.skid&&(a=b.skid),c({tag:{tage:"a0",obj:{octstr:{hex:a}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SubjectKeyIdentifier,m.asn1.ASN1Object),m.asn1.cms.AttributeList=function(a){var b=Error,c=m.asn1,d=c.DERSet,e=c.cms;e.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(null!=this.hTLV)return this.hTLV;var c=!0;void 0!=a.sortflag&&(c=a.sortflag);for(var f=a.array,g=[],h=0;h<f.length;h++){var i=f[h],j=i.attr;if("contentType"==j)g.push(new e.ContentType(i));else if("messageDigest"==j)g.push(new e.MessageDigest(i));else if("signingTime"==j)g.push(new e.SigningTime(i));else if("signingCertificate"==j)g.push(new e.SigningCertificate(i));else if("signingCertificateV2"==j)g.push(new e.SigningCertificateV2(i));else if("signaturePolicyIdentifier"==j)g.push(new m.asn1.cades.SignaturePolicyIdentifier(i));else if("signatureTimeStamp"==j||"timeStampToken"==j)g.push(new m.asn1.cades.SignatureTimeStamp(i));else throw new b("unknown attr: "+j)}var k=new d({array:g,sortflag:c});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.AttributeList,m.asn1.ASN1Object),m.asn1.cms.SignerInfo=function(a){var b=Error,c=m,d=c.asn1,e=d.DERInteger,f=d.DEROctetString,g=d.DERSequence,h=d.DERTaggedObject,i=d.cms,j=i.SignerIdentifier,k=i.AttributeList,l=(i.ContentType,i.EncapsulatedContentInfo,i.MessageDigest,i.SignedData,d.x509).AlgorithmIdentifier,n=c.crypto;i.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var a=this.params,b=a.sigalg,c=new k(a.sattrs).tohex(),d=bQ.getKey(a.signkey),e=new n.Signature({alg:b});e.init(d),e.updateHex(c),a.sighex=e.sign()},this.tohex=function(){var a=this.params,c=[];if(c.push(new e({int:a.version})),c.push(new j(a.id)),c.push(new l({name:a.hashalg})),void 0!=a.sattrs){var d=new k(a.sattrs);try{c.push(new h({tag:"a0",explicit:!1,obj:d}))}catch(a){throw new b("si sattr error: "+a)}}if(void 0!=a.sigalgfield?c.push(new l({name:a.sigalgfield})):c.push(new l({name:a.sigalg})),void 0==a.sighex&&void 0!=a.signkey&&this.sign(),c.push(new f({hex:a.sighex})),void 0!=a.uattrs){var d=new k(a.uattrs);try{c.push(new h({tag:"a1",explicit:!1,obj:d}))}catch(a){throw new b("si uattr error: "+a)}}return new g({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SignerInfo,m.asn1.ASN1Object),m.asn1.cms.EncapsulatedContentInfo=function(a){var b=m.asn1,c=b.DERTaggedObject,d=b.DERSequence,e=b.DERObjectIdentifier,f=b.DEROctetString;b.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];if(b.push(new e(a.type)),void 0!=a.content&&(void 0!=a.content.hex||void 0!=a.content.str)&&!0!=a.isDetached){var g=new c({tag:"a0",explicit:!0,obj:new f(a.content)});b.push(g)}return new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.EncapsulatedContentInfo,m.asn1.ASN1Object),m.asn1.cms.ContentInfo=function(a){var b=m.asn1,c=b.DERTaggedObject,d=b.DERSequence,e=b.DERObjectIdentifier;b.x509.OID.name2obj,m.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];b.push(new e(a.type));var f=new c({tag:"a0",explicit:!0,obj:a.obj});return b.push(f),new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.ContentInfo,m.asn1.ASN1Object),m.asn1.cms.SignedData=function(a){var b=m.asn1,c=(b.ASN1Object,b.DERInteger),d=b.DERSet,e=b.DERSequence,f=(b.DERTaggedObject,b.cms),g=f.EncapsulatedContentInfo,h=f.SignerInfo,i=f.ContentInfo,j=f.CertificateSet,k=f.RevocationInfoChoices,l=b.x509.AlgorithmIdentifier;m.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var a=this.params;this._setDigestAlgs(a),this._setContentTypeByEContent(a),this._setMessageDigestByEContent(a),this._setSignerInfoVersion(a),this._setSignedDataVersion(a)},this._setDigestAlgs=function(a){for(var b={},c=a.sinfos,d=0;d<c.length;d++)b[c[d].hashalg]=1;a.hashalgs=Object.keys(b).sort()},this._setContentTypeByEContent=function(a){for(var b=a.econtent.type,c=a.sinfos,d=0;d<c.length;d++){var e=c[d];this._getAttrParamByName(e,"contentType").type=b}},this._setMessageDigestByEContent=function(a){var b=a.econtent;a.econtent.type;var c=b.content.hex;void 0==c&&"data"==b.type&&void 0!=b.content.str&&(c=bk(b.content.str));for(var d=a.sinfos,e=0;e<d.length;e++){var f=d[e],g=f.hashalg;this._getAttrParamByName(f,"messageDigest").hex=m.crypto.Util.hashHex(c,g)}},this._getAttrParamByName=function(a,b){for(var c=a.sattrs.array,d=0;d<c.length;d++)if(c[d].attr==b)return c[d]},this._setSignerInfoVersion=function(a){for(var b=a.sinfos,c=0;c<b.length;c++){var d=b[c],e=1;"skid"==d.id.type&&(e=3),d.version=e}},this._setSignedDataVersion=function(a){var b=this._getSignedDataVersion(a);a.version=b},this._getSignedDataVersion=function(a){if(void 0!=a.revinfos){for(var b=a.revinfos,c=0;c<b.length;c++)if(void 0!=b[c].ocsp)return 5}for(var d=a.sinfos,c=0;c<d.length;c++)if(3==a.sinfos[c].version)return 3;return"data"!=a.econtent.type?3:1},this.tohex=function(){var a=this.params;void 0!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),!0!=a.fixed&&this.checkAndFixParam();var b=[];b.push(new c({int:a.version}));for(var f=[],i=0;i<a.hashalgs.length;i++){var m=a.hashalgs[i];f.push(new l({name:m}))}b.push(new d({array:f})),b.push(new g(a.econtent)),void 0!=a.certs&&b.push(new j(a.certs)),void 0!=a.revinfos&&b.push(new k(a.revinfos));for(var n=[],i=0;i<a.sinfos.length;i++){var o=a.sinfos[i];n.push(new h(o))}return b.push(new d({array:n})),new e({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new i({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.SignedData,m.asn1.ASN1Object),m.asn1.cms.CertificateSet=function(a){m.asn1.cms.CertificateSet.superclass.constructor.call(this);var b=Error,c=m.asn1,d=c.DERTaggedObject,e=c.DERSet,f=c.ASN1Object;this.params=null,this.tohex=function(){var a,c=this.params,g=[];if(c instanceof Array)a=c;else if(void 0!=c.array)a=c.array;else throw new b("cert array not specified");for(var h=0;h<a.length;h++){var i=bo(a[h]),j=new f;j.hTLV=i,g.push(j)}var k={array:g};return!1==c.sortflag&&(k.sortflag=!1),new d({tag:"a0",explicit:!1,obj:new e(k)}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.CertificateSet,m.asn1.ASN1Object),m.asn1.cms.RevocationInfoChoices=function(a){m.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw Error("params is not array");for(var b=[],c=0;c<a.length;c++)b.push(new m.asn1.cms.RevocationInfoChoice(a[c]));return m.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:b}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.RevocationInfoChoices,m.asn1.ASN1Object),m.asn1.cms.RevocationInfoChoice=function(a){m.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(void 0!=a.crl&&"string"==typeof a.crl){var b=a.crl;return -1!=a.crl.indexOf("-----BEGIN")&&(b=bo(a.crl)),b}if(void 0!=a.ocsp)return m.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new m.asn1.cms.OtherRevocationFormat(a)}}).tohex();throw Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.RevocationInfoChoice,m.asn1.ASN1Object),m.asn1.cms.OtherRevocationFormat=function(a){m.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var b=Error,c=m,d=c.asn1.ASN1Util.newObject,e=c.lang.String.isHex;this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.ocsp)throw new b("property ocsp not specified");if(!e(a.ocsp)||!a8.isASN1HEX(a.ocsp))throw new b("ocsp value not ASN.1 hex string");return d({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:a.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cms.OtherRevocationFormat,m.asn1.ASN1Object),m.asn1.cms.CMSUtil=new function(){},m.asn1.cms.CMSUtil.newSignedData=function(a){return new m.asn1.cms.SignedData(a)},m.asn1.cms.CMSUtil.verifySignedData=function(a){var b,c,d=m,e=d.asn1,f=e.cms,g=((f.SignerInfo,f.SignedData,f.SigningTime,f.SigningCertificate,f.SigningCertificateV2,e.cades).SignaturePolicyIdentifier,d.lang.String.isHex),h=a8.getVbyList,i=a8.getTLVbyList,j=a8.getIdxbyList,k=a8.getChildIdx,l=a8.getTLV,n=a8.oidname,o=d.crypto.Util.hashHex;void 0===a.cms&&g(a.cms);var p=a.cms,q=function(a,b){for(var c,d=3;d<6;d++)if(void 0!==(c=j(a,0,[1,0,d]))){var e=a.substr(c,2);"a0"===e&&(b.certsIdx=c),"a1"===e&&(b.revinfosIdx=c),"31"===e&&(b.signerinfosIdx=c)}},r=function(a,b){var c=b.signerinfosIdx;if(void 0!==c){var d=k(a,c);b.signerInfoIdxList=d;for(var e=0;e<d.length;e++){var f={idx:d[e]};s(a,f),b.signerInfos.push(f)}}},s=function(a,b){var c=b.idx;b.signerid_issuer1=i(a,c,[1,0],"30"),b.signerid_serial1=h(a,c,[1,1],"02"),b.hashalg=n(h(a,c,[2,0],"06"));var d=j(a,c,[3],"a0");b.idxSignedAttrs=d,t(a,b,d);var e=k(a,c).length;if(e<6)throw"malformed SignerInfo";b.sigalg=n(h(a,c,[e-2,0],"06")),b.sigval=h(a,c,[e-1],"04")},t=function(a,b,c){var d=k(a,c);b.signedAttrIdxList=d;for(var e=0;e<d.length;e++){var f=d[e],g=h(a,f,[0],"06");"2a864886f70d010905"===g?b.saSigningTime=bi(h(a,f,[1,0])):"2a864886f70d010904"===g&&(b.saMessageDigest=h(a,f,[1,0],"04"))}},u=function(a,b,c,d){var e,f=b.parse.certsIdx;if(void 0===b.certs){e=[],b.certkeys=[];for(var g=k(a,f),h=0;h<g.length;h++){var i=l(a,g[h]),j=new bU;j.readCertHex(i),e[h]=j,b.certkeys[h]=j.getPublicKey()}b.certs=e}else e=b.certs;b.cccc=e.length,b.cccci=g.length;for(var h=0;h<e.length;h++){var m=j.getIssuerHex(),n=j.getSerialNumberHex();c.signerid_issuer1===m&&c.signerid_serial1===n&&(c.certkey_idx=h)}},v=function(a,b,c,d){c.verifyDetail={};var e=c.verifyDetail,f=b.parse.econtent,g=c.hashalg,h=c.saMessageDigest;e.validMessageDigest=!1,o(f,g)===h&&(e.validMessageDigest=!0),u(a,b,c,d),e.validSignatureValue=!1;var i=c.sigalg,j="31"+l(a,c.idxSignedAttrs).substr(2);c.signedattrshex=j;var k=b.certs[c.certkey_idx].getPublicKey(),n=new m.crypto.Signature({alg:i});n.init(k),n.updateHex(j);var p=n.verify(c.sigval);e.validSignatureValue_isValid=p,!0===p&&(e.validSignatureValue=!0),c.isValid=!1,e.validMessageDigest&&e.validSignatureValue&&(c.isValid=!0)},w={isValid:!1,parse:{}};return b=p,c=w.parse,"2a864886f70d010702"!==h(b,0,[0],"06")||(c.cmsType="signedData",c.econtent=h(b,0,[1,0,2,1,0]),q(b,c),c.signerInfos=[],r(b,c)),!function(a,b){for(var c=b.parse.signerInfos,d=c.length,e=!0,f=0;f<d;f++){var g=c[f];v(a,b,g,f),g.isValid||(e=!1)}b.isValid=e}(p,w),w},m.asn1.cms.CMSParser=function(){var a=Error,b=new bU,c=a8.getV,d=a8.getTLV,e=(a8.getIdxbyList,a8.getTLVbyList),f=a8.getTLVbyListEx,g=a8.getVbyList,h=a8.getVbyListEx,i=a8.getChildIdx;this.getCMSSignedData=function(a){var b=e(a,0,[1,0]);return this.getSignedData(b)},this.getSignedData=function(a){var b=i(a,0),e={};e.version=parseInt(c(a,b[0]),16);var g=d(a,b[1]);e.hashalgs=this.getHashAlgArray(g);var h=d(a,b[2]);e.econtent=this.getEContent(h);var j=f(a,0,["[0]"]);null!=j&&(e.certs=this.getCertificateSet(j)),f(a,0,["[1]"]);var k=f(a,0,[3]);return e.sinfos=this.getSignerInfos(k),e},this.getHashAlgArray=function(a){for(var b=i(a,0),c=new bU,e=[],f=0;f<b.length;f++){var g=d(a,b[f]),h=c.getAlgorithmIdentifierName(g);e.push(h)}return e},this.getEContent=function(a){var b={},c=g(a,0,[0]),d=g(a,0,[1,0]);return b.type=m.asn1.x509.OID.oid2name(a8.hextooidstr(c)),b.content={hex:d},b},this.getSignerInfos=function(a){for(var b=[],c=i(a,0),e=0;e<c.length;e++){var f=d(a,c[e]),g=this.getSignerInfo(f);b.push(g)}return b},this.getSignerInfo=function(a){var c={},e=i(a,0),g=a8.getInt(a,e[0],-1);-1!=g&&(c.version=g);var j=d(a,e[1]);c.id=this.getIssuerAndSerialNumber(j);var k=d(a,e[2]);c.hashalg=b.getAlgorithmIdentifierName(k);var l=f(a,0,["[0]"]);null!=l&&(c.sattrs=this.getAttributeList(l));var m=f(a,0,[3]);c.sigalg=b.getAlgorithmIdentifierName(m),c.sighex=h(a,0,[4]);var n=f(a,0,["[1]"]);return null!=n&&(c.uattrs=this.getAttributeList(n)),c},this.getSignerIdentifier=function(a){if("30"==a.substr(0,2))return this.getIssuerAndSerialNumber(a);throw Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(a){var e={type:"isssn"},f=i(a,0),g=d(a,f[0]);return e.issuer=b.getX500Name(g),e.serial={hex:c(a,f[1])},e},this.getAttributeList=function(a){for(var b=[],c=i(a,0),e=0;e<c.length;e++){var f=d(a,c[e]),g=this.getAttribute(f);b.push(g)}return{array:b}},this.getAttribute=function(a){var b={},c=i(a,0),e=a8.getOID(a,c[0]),f=m.asn1.x509.OID.oid2name(e);b.attr=f;var g=d(a,c[1]),h=i(g,0);if(1==h.length)b.valhex=d(g,h[0]);else{for(var j=[],k=0;k<h.length;k++)j.push(d(g,h[k]));b.valhex=j}return"contentType"==f?this.setContentType(b):"messageDigest"==f?this.setMessageDigest(b):"signingTime"==f?this.setSigningTime(b):"signingCertificate"==f?this.setSigningCertificate(b):"signingCertificateV2"==f?this.setSigningCertificateV2(b):"signaturePolicyIdentifier"==f&&this.setSignaturePolicyIdentifier(b),b},this.setContentType=function(a){var b=a8.getOIDName(a.valhex,0,null);null!=b&&(a.type=b,delete a.valhex)},this.setSigningTime=function(a){var b=bi(c(a.valhex,0));a.str=b,delete a.valhex},this.setMessageDigest=function(a){var b=c(a.valhex,0);a.hex=b,delete a.valhex},this.setSigningCertificate=function(a){var b=i(a.valhex,0);if(b.length>0){for(var c=d(a.valhex,b[0]),e=i(c,0),f=[],g=0;g<e.length;g++){var h=d(c,e[g]),j=this.getESSCertID(h);f.push(j)}a.array=f}if(b.length>1){var k=d(a.valhex,b[1]);a.polhex=k}delete a.valhex},this.setSignaturePolicyIdentifier=function(a){var b=i(a.valhex,0);if(b.length>0){var e=a8.getOID(a.valhex,b[0]);a.oid=e}if(b.length>1){var f=new bU,g=i(a.valhex,b[1]),h=d(a.valhex,g[0]);a.alg=f.getAlgorithmIdentifierName(h);var j=c(a.valhex,g[1]);a.hash=j}delete a.valhex},this.setSigningCertificateV2=function(a){var b=i(a.valhex,0);if(b.length>0){for(var c=d(a.valhex,b[0]),e=i(c,0),f=[],g=0;g<e.length;g++){var h=d(c,e[g]),j=this.getESSCertIDv2(h);f.push(j)}a.array=f}if(b.length>1){var k=d(a.valhex,b[1]);a.polhex=k}delete a.valhex},this.getESSCertID=function(a){var b={},e=i(a,0);if(e.length>0&&(b.hash=c(a,e[0])),e.length>1){var f=d(a,e[1]),g=this.getIssuerSerial(f);void 0!=g.serial&&(b.serial=g.serial),void 0!=g.issuer&&(b.issuer=g.issuer)}return b},this.getESSCertIDv2=function(e){var f={},g=i(e,0);if(g.length<1||3<g.length)throw new a("wrong number of elements");var h=0;if("30"==e.substr(g[0],2)){var j=d(e,g[0]);f.alg=b.getAlgorithmIdentifierName(j),h++}else f.alg="sha256";if(f.hash=c(e,g[h]),g.length>h+1){var k=d(e,g[h+1]),l=this.getIssuerSerial(k);f.issuer=l.issuer,f.serial=l.serial}return f},this.getIssuerSerial=function(a){var e={},f=i(a,0),g=d(a,f[0]);return e.issuer=b.getGeneralNames(g)[0].dn,e.serial={hex:c(a,f[1])},e},this.getCertificateSet=function(a){for(var b=i(a,0),c=[],e=0;e<b.length;e++){var f=d(a,b[e]);if("30"==f.substr(0,2)){var g=bn(f,"CERTIFICATE");c.push(g)}}return{array:c,sortflag:!1}}},void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),void 0!==m.asn1.tsp&&m.asn1.tsp||(m.asn1.tsp={}),m.asn1.tsp.TimeStampToken=function(a){var b=m.asn1.tsp;b.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var a=new b.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=a.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.TimeStampToken,m.asn1.cms.SignedData),m.asn1.tsp.TSTInfo=function(a){var b=m.asn1,c=b.DERSequence,d=b.DERInteger,e=b.DERBoolean,f=b.DERGeneralizedTime,g=b.DERObjectIdentifier,h=b.DERTaggedObject,i=b.tsp,j=i.MessageImprint,k=i.Accuracy,l=(b.x509.X500Name,b.x509.GeneralName);if(i.TSTInfo.superclass.constructor.call(this),this.dVersion=new d({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var a=[this.dVersion];if(null==this.dPolicy)throw Error("policy shall be specified.");if(a.push(this.dPolicy),null==this.dMessageImprint)throw Error("messageImprint shall be specified.");if(a.push(this.dMessageImprint),null==this.dSerial)throw Error("serialNumber shall be specified.");if(a.push(this.dSerial),null==this.dGenTime)throw Error("genTime shall be specified.");a.push(this.dGenTime),null!=this.dAccuracy&&a.push(this.dAccuracy),null!=this.dOrdering&&a.push(this.dOrdering),null!=this.dNonce&&a.push(this.dNonce),null!=this.dTsa&&a.push(this.dTsa);var b=new c({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a){if("string"==typeof a.policy){if(!a.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new g({oid:a.policy})}void 0!==a.messageImprint&&(this.dMessageImprint=new j(a.messageImprint)),void 0!==a.serial&&(this.dSerial=new d(a.serial)),void 0!==a.genTime&&(this.dGenTime=new f(a.genTime)),void 0!==a.accuracy&&(this.dAccuracy=new k(a.accuracy)),void 0!==a.ordering&&!0==a.ordering&&(this.dOrdering=new e),void 0!==a.nonce&&(this.dNonce=new d(a.nonce)),void 0!==a.tsa&&(this.dTsa=new h({tag:"a0",explicit:!0,obj:new l({dn:a.tsa})}))}},bP(m.asn1.tsp.TSTInfo,m.asn1.ASN1Object),m.asn1.tsp.Accuracy=function(a){var b=m.asn1,c=b.ASN1Util.newObject;b.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return void 0!=a.seconds&&"number"==typeof a.seconds&&b.push({int:a.seconds}),void 0!=a.millis&&"number"==typeof a.millis&&b.push({tag:{tagi:"80",obj:{int:a.millis}}}),void 0!=a.micros&&"number"==typeof a.micros&&b.push({tag:{tagi:"81",obj:{int:a.micros}}}),c({seq:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.Accuracy,m.asn1.ASN1Object),m.asn1.tsp.MessageImprint=function(a){var b=m.asn1,c=b.DERSequence,d=b.DEROctetString,e=b.x509.AlgorithmIdentifier;b.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;return new c({array:[new e({name:a.alg}),new d({hex:a.hash})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.tsp.MessageImprint,m.asn1.ASN1Object),m.asn1.tsp.TimeStampReq=function(a){var b=m.asn1,c=b.DERSequence,d=b.DERInteger,e=b.DERBoolean,f=(b.ASN1Object,b.DERObjectIdentifier),g=b.tsp,h=g.MessageImprint;g.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return b.push(new d({int:1})),a.messageImprint instanceof m.asn1.ASN1Object?b.push(a.messageImprint):b.push(new h(a.messageImprint)),void 0!=a.policy&&b.push(new f(a.policy)),void 0!=a.nonce&&b.push(new d(a.nonce)),!0==a.certreq&&b.push(new e),new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.TimeStampReq,m.asn1.ASN1Object),m.asn1.tsp.TimeStampResp=function(a){var b=m.asn1,c=b.DERSequence,d=(b.ASN1Object,b.tsp),e=d.PKIStatusInfo;d.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,f=[];if(void 0!=a.econtent||void 0!=a.tst)if(void 0!=a.statusinfo?f.push(new e(a.statusinfo)):f.push(new e("granted")),void 0!=a.econtent)f.push(new d.TimeStampToken(a).getContentInfo());else if(a.tst instanceof b.ASN1Object)f.push(a.tst);else throw Error("improper member tst value");else if(void 0!=a.statusinfo)f.push(new e(a.statusinfo));else throw Error("parameter for token nor statusinfo not specified");return new c({array:f}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.TimeStampResp,m.asn1.ASN1Object),m.asn1.tsp.PKIStatusInfo=function(a){var b=Error,c=m.asn1,d=c.DERSequence,e=c.tsp,f=e.PKIStatus,g=e.PKIFreeText,h=e.PKIFailureInfo;e.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if("string"==typeof a)c.push(new f(a));else{if(void 0==a.status)throw new b("property 'status' unspecified");c.push(new f(a.status)),void 0!=a.statusstr&&c.push(new g(a.statusstr)),void 0!=a.failinfo&&c.push(new h(a.failinfo))}return new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.PKIStatusInfo,m.asn1.ASN1Object),m.asn1.tsp.PKIStatus=function(a){var b=Error,c=m.asn1,d=c.DERInteger;c.tsp.PKIStatus.superclass.constructor.call(this);var e={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var a,c=this.params;if("string"==typeof c)try{a=e[c]}catch(a){throw new b("undefined name: "+c)}else if("number"==typeof c)a=c;else throw new b("unsupported params");return new d({int:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.PKIStatus,m.asn1.ASN1Object),m.asn1.tsp.PKIFreeText=function(a){var b=Error,c=m.asn1,d=c.DERSequence,e=c.DERUTF8String;c.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw new b("wrong params: not array");for(var c=[],f=0;f<a.length;f++)c.push(new e({str:a[f]}));return new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.PKIFreeText,m.asn1.ASN1Object),m.asn1.tsp.PKIFailureInfo=function(a){var b=Error,c=m.asn1,d=c.DERBitString,e=c.tsp.PKIFailureInfo,f={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};e.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var a=this.params,c=0;if("number"==typeof a&&0<=a&&a<=25){for(var d=(c|=1<<a).toString(2),e="",g=d.length-1;g>=0;g--)e+=d[g];return e}if("string"==typeof a&&void 0!=f[a])return bN([a],f);if("object"==typeof a&&void 0!=a.length)return bN(a,f);throw new b("wrong params")},this.tohex=function(){return this.params,new d({bin:this.getBinValue()}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.tsp.PKIFailureInfo,m.asn1.ASN1Object),m.asn1.tsp.AbstractTSAAdapter=function(a){this.getTSTHex=function(a,b){throw"not implemented yet"}},m.asn1.tsp.SimpleTSAAdapter=function(a){var b=m,c=b.asn1.tsp,d=b.crypto.Util.hashHex;c.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(a,b){var e=d(a,b);this.params.econtent.content.messageImprint={alg:b,hash:e},this.params.econtent.content.serial={int:this.serial++};var f=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:f},new c.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==a&&(this.params=a)},bP(m.asn1.tsp.SimpleTSAAdapter,m.asn1.tsp.AbstractTSAAdapter),m.asn1.tsp.FixedTSAAdapter=function(a){var b=m,c=b.asn1.tsp,d=b.crypto.Util.hashHex;c.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(a,b){var e=d(a,b);return this.params.econtent.content.messageImprint={alg:b,hash:e},new c.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==a&&(this.params=a)},bP(m.asn1.tsp.FixedTSAAdapter,m.asn1.tsp.AbstractTSAAdapter),m.asn1.tsp.TSPUtil=new function(){},m.asn1.tsp.TSPUtil.newTimeStampToken=function(a){return new m.asn1.tsp.TimeStampToken(a)},m.asn1.tsp.TSPUtil.parseTimeStampReq=function(a){return new m.asn1.tsp.TSPParser().getTimeStampReq(a)},m.asn1.tsp.TSPUtil.parseMessageImprint=function(a){return new m.asn1.tsp.TSPParser().getMessageImprint(a)},m.asn1.tsp.TSPParser=function(){var a=new bU,b=a8.getV,c=a8.getTLV,d=a8.getIdxbyList,e=(a8.getTLVbyListEx,a8.getChildIdx),f=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],g={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(a){var b=e(a,0);if(1==b.length)return this.getPKIStatusInfo(c(a,b[0]));if(b.length>1){var d=this.getPKIStatusInfo(c(a,b[0])),f=c(a,b[1]),g=this.getToken(f);return g.statusinfo=d,g}},this.getToken=function(a){var b=(new m.asn1.cms.CMSParser).getCMSSignedData(a);return this.setTSTInfo(b),b},this.setTSTInfo=function(a){var b=a.econtent;if("tstinfo"==b.type){var c=b.content.hex;b.content=this.getTSTInfo(c)}},this.getTSTInfo=function(d){var f={},g=e(d,0);f.policy=bG(b(d,g[1]));var h=c(d,g[2]);f.messageImprint=this.getMessageImprint(h),f.serial={hex:b(d,g[3])},f.genTime={str:bi(b(d,g[4]))};var i=0;if(g.length>5&&"30"==d.substr(g[5],2)){var j=c(d,g[5]);f.accuracy=this.getAccuracy(j),i++}if(g.length>5+i&&"01"==d.substr(g[5+i],2)&&("ff"==b(d,g[5+i])&&(f.ordering=!0),i++),g.length>5+i&&"02"==d.substr(g[5+i],2)&&(f.nonce={hex:b(d,g[5+i])},i++),g.length>5+i&&"a0"==d.substr(g[5+i],2)){var k=c(d,g[5+i]);k="30"+k.substr(2),f.tsa=(pGeneralNames=a.getGeneralNames(k))[0].dn,i++}if(g.length>5+i&&"a1"==d.substr(g[5+i],2)){var l=c(d,g[5+i]);l="30"+l.substr(2),f.ext=a.getExtParamArray(l),i++}return f},this.getAccuracy=function(a){for(var c={},d=e(a,0),f=0;f<d.length;f++){var g=a.substr(d[f],2),h=parseInt(b(a,d[f]),16);"02"==g?c.seconds=h:"80"==g?c.millis=h:"81"==g&&(c.micros=h)}return c},this.getMessageImprint=function(a){if("30"!=a.substr(0,2))throw Error("head of messageImprint hex shall be x30");var c={};e(a,0);var f=d(a,0,[0,0]),g=b(a,f),h=a8.hextooidstr(g),i=m.asn1.x509.OID.oid2name(h);if(""==i)throw Error("hashAlg name undefined: "+h);var j=d(a,0,[1]);return c.alg=i,c.hash=b(a,j),c},this.getPKIStatusInfo=function(a){var d={},g=e(a,0),h=0;try{var i=b(a,g[0]);d.status=f[parseInt(i,16)]}catch(a){}if(g.length>1&&"30"==a.substr(g[1],2)){var j=c(a,g[1]);d.statusstr=this.getPKIFreeText(j),h++}if(g.length>h&&"03"==a.substr(g[1+h],2)){var k=c(a,g[1+h]);d.failinfo=this.getPKIFailureInfo(k)}return d},this.getPKIFreeText=function(a){for(var b=[],c=e(a,0),d=0;d<c.length;d++)b.push(a8.getString(a,c[d]));return b},this.getPKIFailureInfo=function(a){var b=a8.getInt(a,0);return void 0!=g[b]?g[b]:b},this.getTimeStampReq=function(a){var d={};d.certreq=!1;var f=e(a,0);if(f.length<2)throw Error("TimeStampReq must have at least 2 items");var g=c(a,f[1]);d.messageImprint=m.asn1.tsp.TSPUtil.parseMessageImprint(g);for(var h=2;h<f.length;h++){var i=f[h],j=a.substr(i,2);if("06"==j){var k=b(a,i);d.policy=a8.hextooidstr(k)}"02"==j&&(d.nonce=b(a,i)),"01"==j&&(d.certreq=!0)}return d}},void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),void 0!==m.asn1.cades&&m.asn1.cades||(m.asn1.cades={}),m.asn1.cades.SignaturePolicyIdentifier=function(a){var b=m.asn1.cades,c=b.SignaturePolicyId;b.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new c(this.params)]},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.SignaturePolicyIdentifier,m.asn1.cms.Attribute),m.asn1.cades.SignaturePolicyId=function(a){var b=m.asn1,c=b.DERSequence,d=b.DERObjectIdentifier,e=(b.x509.AlgorithmIdentifier,b.cades),f=e.SignaturePolicyId,g=e.OtherHashAlgAndValue;f.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return b.push(new d(a.oid)),b.push(new g(a)),new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.SignaturePolicyId,m.asn1.ASN1Object),m.asn1.cades.OtherHashAlgAndValue=function(a){var b=Error,c=m.asn1,d=c.DERSequence,e=c.DEROctetString,f=c.x509.AlgorithmIdentifier;c.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.alg)throw new b("property 'alg' not specified");if(void 0==a.hash&&void 0==a.cert)throw new b("property 'hash' nor 'cert' not specified");var c=null;if(void 0!=a.hash)c=a.hash;else if(void 0!=a.cert){if("string"!=typeof a.cert)throw new b("cert not string");var g=a.cert;-1!=a.cert.indexOf("-----BEGIN")&&(g=bo(a.cert)),c=m.crypto.Util.hashHex(g,a.alg)}var h=[];return h.push(new f({name:a.alg})),h.push(new e({hex:c})),new d({array:h}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.OtherHashAlgAndValue,m.asn1.ASN1Object),m.asn1.cades.OtherHashValue=function(a){m.asn1.cades.OtherHashValue.superclass.constructor.call(this);var b=Error,c=m,d=(c.lang.String.isHex,c.asn1).DEROctetString;c.crypto.Util.hashHex,this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.hash&&void 0==a.cert)throw new b("hash or cert not specified");var c=null;if(void 0!=a.hash)c=a.hash;else if(void 0!=a.cert){if("string"!=typeof a.cert)throw new b("cert not string");var e=a.cert;-1!=a.cert.indexOf("-----BEGIN")&&(e=bo(a.cert)),c=m.crypto.Util.hashHex(e,"sha1")}return new d({hex:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.OtherHashValue,m.asn1.ASN1Object),m.asn1.cades.SignatureTimeStamp=function(a){var b=Error,c=m,d=c.lang.String.isHex,e=c.asn1,f=e.ASN1Object;(e.x509,e.cades).SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var a=this.params;if(void 0!=a.tst)if(d(a.tst)){var c=new f;return c.hTLV=a.tst,[c]}else if(a.tst instanceof f)return[a.tst];else throw new b("params.tst has wrong value");if(void 0!=a.res){var e=a.res;if(e instanceof f&&(e=e.tohex()),"string"!=typeof e||!d(e))throw new b("params.res has wrong value");a8.getTLVbyList(e,0,[1]);var c=new f;return c.hTLV=a.tst,[c]}},null!=a&&this.setByParam(a)},bP(m.asn1.cades.SignatureTimeStamp,m.asn1.cms.Attribute),m.asn1.cades.CompleteCertificateRefs=function(a){var b=Error,c=m,d=c.asn1,e=d.DERSequence,f=d.cades,g=f.OtherCertID,h=c.lang.String.isHex;f.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var a=this.params,c=[],d=0;d<a.array.length;d++){var f=a.array[d];if("string"==typeof f)if(-1!=f.indexOf("-----BEGIN"))f={cert:f};else if(h(f))f={hash:f};else throw new b("unsupported value: "+f);void 0!=a.alg&&void 0==f.alg&&(f.alg=a.alg),void 0!=a.hasis&&void 0==f.hasis&&(f.hasis=a.hasis);var i=new g(f);c.push(i)}return[new e({array:c})]},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.CompleteCertificateRefs,m.asn1.cms.Attribute),m.asn1.cades.OtherCertID=function(a){var b=m.asn1,c=b.DERSequence,d=b.cms.IssuerSerial,e=b.cades,f=e.OtherHashValue,g=e.OtherHashAlgAndValue;e.OtherCertID.superclass.constructor.call(this),this.params=a,this.tohex=function(){var a=this.params;"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?a={cert:a}:_isHex(a)&&(a={hash:a}));var b=[],e=null;if(e=void 0!=a.alg?new g(a):new f(a),b.push(e),void 0!=a.cert&&!0==a.hasis||void 0!=a.issuer&&void 0!=a.serial){var h=new d(a);b.push(h)}return new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.OtherCertID,m.asn1.ASN1Object),m.asn1.cades.OtherHash=function(a){var b=m,c=b.asn1,d=(c.cms,c.cades),e=d.OtherHashAlgAndValue,f=d.OtherHashValue,g=(b.crypto.Util.hashHex,b.lang.String.isHex);d.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?a={cert:a}:g(a)&&(a={hash:a}));return(void 0!=a.alg?new e(a):new f(a)).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.cades.OtherHash,m.asn1.ASN1Object),m.asn1.cades.CAdESUtil=new function(){},m.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(a){return new m.asn1.cms.CMSParser().getCMSSignedData(a)},m.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(a,b,c){var d=a8.getChildIdx,e=a8.getTLV,f=a8.getV,g=m.asn1,h=g.ASN1Object,i=g.cms,j=i.AttributeList,k=i.SignerInfo,l={},n=d(a,b);if(6!=n.length)throw"not supported items for SignerInfo (!=6)";l.version=e(a,n.shift()),l.si=e(a,n.shift()),l.digalg=e(a,n.shift()),l.sattrs=e(a,n.shift()),l.sigalg=e(a,n.shift());var o=n.shift();l.sig=e(a,o),l.sigval=f(a,o);var p=null;return l.obj=new k,(p=new h).hTLV=l.version,l.obj.dCMSVersion=p,(p=new h).hTLV=l.si,l.obj.dSignerIdentifier=p,(p=new h).hTLV=l.digalg,l.obj.dDigestAlgorithm=p,(p=new h).hTLV=l.sattrs,l.obj.dSignedAttrs=p,(p=new h).hTLV=l.sigalg,l.obj.dSigAlg=p,(p=new h).hTLV=l.sig,l.obj.dSig=p,l.obj.dUnsignedAttrs=new j,l},void 0!==m.asn1.csr&&m.asn1.csr||(m.asn1.csr={}),m.asn1.csr.CertificationRequest=function(a){var b=m.asn1,c=b.DERBitString,d=b.DERSequence,e=b.csr,f=(b.x509,e.CertificationRequestInfo);e.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(a){this.params=a},this.sign=function(){var a=new f(this.params).tohex(),b=new m.crypto.Signature({alg:this.params.sigalg});b.init(this.params.sbjprvkey),b.updateHex(a);var c=b.sign();this.params.sighex=c},this.getPEM=function(){return bn(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var a=this.params,b=new m.asn1.csr.CertificationRequestInfo(this.params),e=new m.asn1.x509.AlgorithmIdentifier({name:a.sigalg});if(void 0==a.sighex&&void 0!=a.sbjprvkey&&this.sign(),void 0==a.sighex)throw Error("sighex or sbjprvkey parameter not defined");return new d({array:[b,e,new c({hex:"00"+a.sighex})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.csr.CertificationRequest,m.asn1.ASN1Object),m.asn1.csr.CertificationRequestInfo=function(a){var b=m.asn1,c=(b.DERBitString,b.DERSequence),d=b.DERInteger,e=b.DERUTF8String,f=b.DERTaggedObject,g=b.ASN1Util.newObject,h=b.csr,i=b.x509,j=i.X500Name,k=i.Extensions,l=i.SubjectPublicKeyInfo;h.AttributeList,h.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(a){void 0!=a&&(this.params=a)},this.tohex=function(){var a=this.params,b=[];if(b.push(new d({int:0})),b.push(new j(a.subject)),b.push(new l(bQ.getKey(a.sbjpubkey))),void 0!=a.attrs){var h=g({tag:{tage:"a0",obj:function(a){for(var b=Error,c=m.asn1.x509.Extensions,d=[],e=0;e<a.length;e++){var f=a[e],g=f.attr;if("extensionRequest"==g){var h={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new c(f.ext)]}]};d.push(h)}else if("unstructuredName"==g){var h={seq:[{oid:"1.2.840.113549.1.9.2"},{set:f.names}]};d.push(h)}else if("challengePassword"==g){var h={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:f.password}]}]};d.push(h)}else throw new b("unknown CSR attribute")}return{set:d}}(a.attrs)}});b.push(h)}else if(void 0!=a.extreq){var h=g({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new k(a.extreq)]}]}}});b.push(h)}else b.push(new f({tag:"a0",explicit:!1,obj:new e({str:""})}));return new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},bP(m.asn1.csr.CertificationRequestInfo,m.asn1.ASN1Object),m.asn1.csr.AttributeList=function(a){},bP(m.asn1.csr.AttributeList,m.asn1.ASN1Object),m.asn1.csr.CSRUtil=new function(){},m.asn1.csr.CSRUtil.newCSRPEM=function(a){return new m.asn1.csr.CertificationRequest(a).getPEM()},m.asn1.csr.CSRUtil.getParam=function(a,b){var c,d=a8.getV,e=a8.getIdxbyList,f=a8.getTLVbyList,g=a8.getTLVbyListEx,h=a8.getVbyListEx,i={};if(-1==a.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw Error("argument is not PEM file");var j=bo(a,"CERTIFICATE REQUEST");b&&(i.tbs=f(j,0,[0]));try{var k=g(j,0,[0,1]);if("3000"==k)i.subject={};else{var l=new bU;i.subject=l.getX500Name(k)}}catch(a){}var m=g(j,0,[0,2]),n=bQ.getKey(m,null,"pkcs8pub");i.sbjpubkey=bQ.getPEM(n,"PKCS8PUB");var o=(c=e(j,0,[0,3,0,0],"06"),"2a864886f70d01090e"!=d(j,c)?null:f(j,0,[0,3,0,1,0],"30")),l=new bU;null!=o&&(i.extreq=l.getExtParamArray(o));try{var p=g(j,0,[1],"30"),l=new bU;i.sigalg=l.getAlgorithmIdentifierName(p)}catch(a){}try{i.sighex=h(j,0,[2])}catch(a){}return i},m.asn1.csr.CSRUtil.verifySignature=function(a){try{var b=null;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN CERTIFICATE REQUEST")?b=m.asn1.csr.CSRUtil.getParam(a,!0):"object"==typeof a&&void 0!=a.sbjpubkey&&void 0!=a.sigalg&&void 0!=a.sighex&&void 0!=a.tbs&&(b=a),null==b)return!1;var c=new m.crypto.Signature({alg:b.sigalg});return c.init(b.sbjpubkey),c.updateHex(b.tbs),c.verify(b.sighex)}catch(a){return alert(a),!1}},void 0!==m&&m||(m={}),void 0!==m.asn1&&m.asn1||(m.asn1={}),void 0!==m.asn1.ocsp&&m.asn1.ocsp||(m.asn1.ocsp={}),m.asn1.ocsp.DEFAULT_HASH="sha1",m.asn1.ocsp.OCSPResponse=function(a){m.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),m.asn1.DEREnumerated;var b=m.asn1.ASN1Util.newObject,c=m.asn1.ocsp.ResponseBytes,d=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var a=this.params.resstatus;return"number"==typeof a?a:"string"!=typeof a?-1:d.indexOf(a)},this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,d=this._getStatusCode();if(-1==d)throw Error("responseStatus not supported: "+a.resstatus);return 0!=d?b({seq:[{enum:{int:d}}]}).tohex():b({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:new c(a)}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.OCSPResponse,m.asn1.ASN1Object),m.asn1.ocsp.ResponseBytes=function(a){m.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var b=m.asn1,c=b.DERSequence,d=b.DERObjectIdentifier,e=b.DEROctetString,f=b.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if("ocspBasic"!=a.restype)throw Error("not supported responseType: "+a.restype);var b=new f(a),g=[];return g.push(new d({name:"ocspBasic"})),g.push(new e({hex:b.tohex()})),new c({array:g}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.ResponseBytes,m.asn1.ASN1Object),m.asn1.ocsp.BasicOCSPResponse=function(a){m.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var b=Error,c=m.asn1,d=c.ASN1Object,e=c.DERSequence,f=(c.DERGeneralizedTime,c.DERTaggedObject),g=c.DERBitString,h=(c.x509.Extensions,c.x509.AlgorithmIdentifier),i=c.ocsp;i.ResponderID,_SingleResponseList=i.SingleResponseList,_ResponseData=i.ResponseData,this.params=null,this.setByParam=function(a){this.params=a},this.sign=function(){var a=this.params,b=a.tbsresp.tohex(),c=new m.crypto.Signature({alg:a.sigalg});c.init(a.reskey),c.updateHex(b),a.sighex=c.sign()},this.tohex=function(){var a=this.params;void 0==a.tbsresp&&(a.tbsresp=new _ResponseData(a)),void 0==a.sighex&&void 0!=a.reskey&&this.sign();var c=[];if(c.push(a.tbsresp),c.push(new h({name:a.sigalg})),c.push(new g({hex:"00"+a.sighex})),void 0!=a.certs&&void 0!=a.certs.length){for(var i=[],j=0;j<a.certs.length;j++){var k=a.certs[j],l=null;if(a8.isASN1HEX(k))l=k;else if(k.match(/-----BEGIN/))l=bo(k);else throw new b("certs["+j+"] not hex or PEM");i.push(new d({tlv:l}))}var m=new e({array:i});c.push(new f({tag:"a0",explicit:!0,obj:m}))}return new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.BasicOCSPResponse,m.asn1.ASN1Object),m.asn1.ocsp.ResponseData=function(a){m.asn1.ocsp.ResponseData.superclass.constructor.call(this);var b=Error,c=m.asn1,d=c.DERSequence,e=c.DERGeneralizedTime,f=c.DERTaggedObject,g=c.x509.Extensions,h=c.ocsp,i=h.ResponderID;_SingleResponseList=h.SingleResponseList,this.params=null,this.tohex=function(){var a=this.params;void 0!=a.respid&&new b("respid not specified"),void 0!=a.prodat&&new b("prodat not specified"),void 0!=a.array&&new b("array not specified");var c=[];if(c.push(new i(a.respid)),c.push(new e(a.prodat)),c.push(new _SingleResponseList(a.array)),void 0!=a.ext){var h=new g(a.ext);c.push(new f({tag:"a1",explicit:!0,obj:h}))}return new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.ResponseData,m.asn1.ASN1Object),m.asn1.ocsp.ResponderID=function(a){m.asn1.ocsp.ResponderID.superclass.constructor.call(this);var b=m,c=b.asn1,d=c.ASN1Util.newObject,e=c.x509.X500Name,f=b.lang.String.isHex,g=Error;this.params=null,this.tohex=function(){var a=this.params;if(void 0!=a.key){var b=null;if("string"==typeof a.key){if(f(a.key)&&(b=a.key),a.key.match(/-----BEGIN CERTIFICATE/)){var c=new bU(a.key),h=c.getExtSubjectKeyIdentifier();null!=h&&(b=h.kid.hex)}}else if(a.key instanceof bU){var h=a.key.getExtSubjectKeyIdentifier();null!=h&&(b=h.kid.hex)}if(null==b)throw new g("wrong key member value");var i=d({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:b}}}});return i.tohex()}if(void 0!=a.name){var j=null;if("string"==typeof a.name&&a.name.match(/-----BEGIN CERTIFICATE/)){var c=new bU(a.name);j=c.getSubject()}else a.name instanceof bU?j=a.name.getSubject():"object"==typeof a.name&&(void 0!=a.name.array||void 0!=a.name.str)&&(j=a.name);if(null==j)throw new g("wrong name member value");var i=d({tag:{tag:"a1",explicit:!0,obj:new e(j)}});return i.tohex()}throw new g("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.ResponderID,m.asn1.ASN1Object),m.asn1.ocsp.SingleResponseList=function(a){m.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var b=m.asn1,c=b.DERSequence,d=b.ocsp.SingleResponse;this.params=null,this.tohex=function(){var a=this.params;if("object"!=typeof a||void 0==a.length)throw Error("params not specified properly");for(var b=[],e=0;e<a.length;e++)b.push(new d(a[e]));return new c({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.SingleResponseList,m.asn1.ASN1Object),m.asn1.ocsp.SingleResponse=function(a){var b=Error,c=m.asn1,d=c.DERSequence,e=c.DERGeneralizedTime,f=c.DERTaggedObject,g=c.ocsp,h=g.CertID,i=g.CertStatus,j=c.x509.Extensions;g.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if(void 0==a.certid)throw new b("certid unspecified");if(void 0==a.status)throw new b("status unspecified");if(void 0==a.thisupdate)throw new b("thisupdate unspecified");if(c.push(new h(a.certid)),c.push(new i(a.status)),c.push(new e(a.thisupdate)),void 0!=a.nextupdate){var g=new e(a.nextupdate);c.push(new f({tag:"a0",explicit:!0,obj:g}))}if(void 0!=a.ext){var k=new j(a.ext);c.push(new f({tag:"a1",explicit:!0,obj:k}))}return new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.SingleResponse,m.asn1.ASN1Object),m.asn1.ocsp.CertID=function(a){var b=m,c=b.asn1,d=c.DEROctetString,e=c.DERInteger,f=c.DERSequence,g=c.x509.AlgorithmIdentifier,h=c.ocsp,i=(h.DEFAULT_HASH,b.crypto).Util.hashHex,j=a8.getVbyList;h.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(a,b,c,d){void 0==d&&(d=this.DEFAULT_HASH),this.params={alg:d,issname:a,isskey:b,sbjsn:c}},this.setByCert=function(a,b,c){void 0==c&&(c=this.DEFAULT_HASH),this.params={alg:c,issuerCert:a,subjectCert:b}},this.getParamByCerts=function(a,b,c){void 0==c&&(c=this.DEFAULT_HASH);var d=new bU(a),e=new bU(b),f=i(d.getSubjectHex(),c),g=i(j(d.getPublicKeyHex(),0,[1],"03",!0),c);return{alg:c,issname:f,isskey:g,sbjsn:e.getSerialNumberHex()}},this.tohex=function(){if("object"!=typeof this.params)throw Error("params not set");var a,b,c,h,i=this.params;if(h=void 0==i.alg?this.DEFAULT_HASH:i.alg,void 0!=i.issuerCert&&void 0!=i.subjectCert){var j=this.getParamByCerts(i.issuerCert,i.subjectCert,h);a=j.issname,b=j.isskey,c=j.sbjsn}else if(void 0!=i.issname&&void 0!=i.isskey&&void 0!=i.sbjsn)a=i.issname,b=i.isskey,c=i.sbjsn;else throw Error("required param members not defined");var k=new f({array:[new g({name:h}),new d({hex:a}),new d({hex:b}),new e({hex:c})]});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.CertID,m.asn1.ASN1Object),m.asn1.ocsp.CertStatus=function(a){m.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("good"==a.status)return"8000";if("unknown"==a.status)return"8200";if("revoked"==a.status){var b=[{gentime:{str:a.time}}];return void 0!=a.reason&&b.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:a.reason}}}}),m.asn1.ASN1Util.newObject({tag:{tag:"a1",explicit:!1,obj:{seq:b}}}).tohex()}throw Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},bP(m.asn1.ocsp.CertStatus,m.asn1.ASN1Object),m.asn1.ocsp.Request=function(a){var b=m.asn1,c=b.DERSequence,d=b.ocsp;if(d.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var a=[];if(null===this.dReqCert)throw"reqCert not set";a.push(this.dReqCert);var b=new c({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a){var e=new d.CertID(a);this.dReqCert=e}},bP(m.asn1.ocsp.Request,m.asn1.ASN1Object),m.asn1.ocsp.TBSRequest=function(a){var b=m.asn1,c=b.DERSequence,d=b.ocsp;d.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(a){for(var b=[],c=0;c<a.length;c++){var e=new d.Request(a[0]);b.push(e)}this.dRequestList=b},this.tohex=function(){var a=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var b=new c({array:this.dRequestList});if(a.push(b),null!==this.dRequestExt)throw"requestExtensions not supported";var d=new c({array:a});return this.hTLV=d.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&void 0!==a.reqList&&this.setRequestListByParam(a.reqList)},bP(m.asn1.ocsp.TBSRequest,m.asn1.ASN1Object),m.asn1.ocsp.OCSPRequest=function(a){var b=m.asn1,c=b.DERSequence,d=b.ocsp;if(d.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var a=[];if(null!==this.dTbsRequest)a.push(this.dTbsRequest);else throw"tbsRequest not set";if(null!==this.dOptionalSignature)throw"optionalSignature not supported";var b=new c({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&void 0!==a.reqList){var e=new d.TBSRequest(a);this.dTbsRequest=e}},bP(m.asn1.ocsp.OCSPRequest,m.asn1.ASN1Object),m.asn1.ocsp.OCSPUtil={},m.asn1.ocsp.OCSPUtil.getRequestHex=function(a,b,c){var d=m.asn1.ocsp;void 0===c&&(c=d.DEFAULT_HASH);var e={alg:c,issuerCert:a,subjectCert:b};return new d.OCSPRequest({reqList:[e]}).tohex()},m.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(a){var b=a8.getVbyList,c=a8.getVbyListEx,d=a8.getIdxbyList,e=(a8.getIdxbyListEx,a8.getV),f={};try{var g=c(a,0,[0],"0a");f.responseStatus=parseInt(g,16)}catch(a){}if(0!==f.responseStatus)return f;try{var h=d(a,0,[1,0,1,0,0,2,0,1]);"80"===a.substr(h,2)?f.certStatus="good":"a1"===a.substr(h,2)?(f.certStatus="revoked",f.revocationTime=bi(b(a,h,[0]))):"82"===a.substr(h,2)&&(f.certStatus="unknown")}catch(a){}try{var i=d(a,0,[1,0,1,0,0,2,0,2]);f.thisUpdate=bi(e(a,i))}catch(a){}try{var j=d(a,0,[1,0,1,0,0,2,0,3]);"a0"===a.substr(j,2)&&(f.nextUpdate=bi(b(a,j,[0])))}catch(a){}return f},m.asn1.ocsp.OCSPParser=function(){var a=Error,b=new bU,c=a8.getV,d=a8.getTLV,e=a8.getIdxbyList,f=a8.getVbyList,g=a8.getTLVbyList,h=a8.getVbyListEx,i=a8.getTLVbyListEx,j=a8.getChildIdx;this.getOCSPRequest=function(b){var c=j(b,0);if(1!=c.length&&2!=c.length)throw new a("wrong number elements: "+c.length);return this.getTBSRequest(d(b,c[0]))},this.getTBSRequest=function(a){var c={},d=i(a,0,[0],"30");c.array=this.getRequestList(d);var e=i(a,0,["[2]",0],"30");return null!=e&&(c.ext=b.getExtParamArray(e)),c},this.getRequestList=function(a){for(var b=[],c=j(a,0),e=0;e<c.length;e++){var a=d(a,c[e]);b.push(this.getRequest(a))}return b},this.getRequest=function(c){var f=j(c,0);if(1!=f.length&&2!=f.length)throw new a("wrong number elements: "+f.length);var g=this.getCertID(d(c,f[0]));if(2==f.length){var h=e(c,0,[1,0]);g.ext=b.getExtParamArray(d(c,h))}return g},this.getCertID=function(b){var e=j(b,0);if(4!=e.length)throw new a("wrong number elements: "+e.length);var f=new bU,g={};return g.alg=f.getAlgorithmIdentifierName(d(b,e[0])),g.issname=c(b,e[1]),g.isskey=c(b,e[2]),g.sbjsn=c(b,e[3]),g},this.getOCSPResponse=function(a){var b,d=j(a,0),e=parseInt(c(a,d[0]));if(1==d.length)return{resstatus:e};var f=g(a,0,[1,0]);return(b=this.getResponseBytes(f)).resstatus=e,b},this.getResponseBytes=function(a){var b,d=j(a,0),e=g(a,0,[1,0]);b=this.getBasicOCSPResponse(e);var f=c(a,d[0]);return b.restype=m.asn1.x509.OID.oid2name(bG(f)),b},this.getBasicOCSPResponse=function(a){var b,e=j(a,0);(b=this.getResponseData(d(a,e[0]))).alg=new bU().getAlgorithmIdentifierName(d(a,e[1])),b.sighex=c(a,e[2]).substr(2);var f=h(a,0,["[0]"]);if(null!=f){for(var g=j(f,0),i=[],k=0;k<g.length;k++){var l=d(f,g[k]);i.push(l)}b.certs=i}return b},this.getResponseData=function(a){var b=j(a,0),e=b.length,f={},h=0;if("a0"==a.substr(b[0],2)&&h++,f.respid=this.getResponderID(d(a,b[h++])),f.prodat=bi(c(a,b[h++])),f.array=this.getSingleResponseList(d(a,b[h++])),"a1"==a.substr(b[e-1],2)){var i=g(a,b[e-1],[0]);f.ext=new bU().getExtParamArray(i)}return f},this.getResponderID=function(a){var b={};if("a2"==a.substr(0,2)&&(b.key=f(a,0,[0])),"a1"==a.substr(0,2)){var c=g(a,0,[0]);b.name=new bU().getX500Name(c)}return b},this.getSingleResponseList=function(a){for(var b=j(a,0),c=[],e=0;e<b.length;e++){var f=this.getSingleResponse(d(a,b[e]));c.push(f)}return c},this.getSingleResponse=function(a){var b=j(a,0),e={};e.certid=this.getCertID(d(a,b[0])),e.status=this.getCertStatus(d(a,b[1])),"18"==a.substr(b[2],2)&&(e.thisupdate=bi(c(a,b[2])));for(var h=3;h<b.length;h++)if("a0"==a.substr(b[h],2)&&(e.nextupdate=bi(f(a,b[h],[0],"18"))),"a1"==a.substr(b[h],2)){var i=new bU,k=g(a,0,[h,0]);e.ext=i.getExtParamArray(k)}return e},this.getCertStatus=function(a){var b={};return"8000"==a?{status:"good"}:"8200"==a?{status:"unknown"}:("a1"==a.substr(0,2)&&(b.status="revoked",b.time=bi(f(a,0,[0]))),b)}},void 0!==m&&m||(m={}),void 0!==m.lang&&m.lang||(m.lang={}),m.lang.String=function(){},"function"==typeof Buffer?(n=function(a){return bd(Buffer.from(a,"utf8").toString("base64"))},o=function(a){return Buffer.from(be(a),"base64").toString("utf8")}):(n=function(a){return bf(bs(bB(a)))},o=function(a){return decodeURIComponent(bt(bg(a)))});function bj(a){for(var b="",c=0;c<a.length-1;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b}function bk(a){for(var b="",c=0;c<a.length;c++)b+=("0"+a.charCodeAt(c).toString(16)).slice(-2);return b}function bl(a,b){return(a=a.replace(RegExp("(.{"+b+"})","g"),"$1\r\n")).replace(/\s+$/,"")}function bm(a){return u(a.replace(/[^0-9A-Za-z\/+=]*/g,""))}function bn(a,b){return"-----BEGIN "+b+"-----\r\n"+bl(t(a),64)+"\r\n-----END "+b+"-----\r\n"}function bo(a,b){if(-1==a.indexOf("-----BEGIN "))throw Error("can't find PEM header");return bm(a=void 0!==b?(a=a.replace(RegExp("^[^]*-----BEGIN "+b+"-----"),"")).replace(RegExp("-----END "+b+"-----[^]*$"),""):(a=a.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function bp(a){var b,c,d,e,f,g,h,i,j;if(j=(a=br(a)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return b=parseInt(j[1]),c=parseInt(j[2])-1,d=parseInt(j[3]),e=parseInt(j[4]),f=parseInt(j[5]),g=parseInt(j[6]),h=0,""!==(i=j[7])&&(h=parseInt((i.substr(1)+"00").substr(0,3))),Date.UTC(b,c,d,e,f,g,h);throw Error("unsupported zulu format: "+a)}function bq(a){return Math.round(bp(a)/1e3)}function br(a){return a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}[.][0-9]*Z$/)?a.match(/^[0-4]/)?"20"+a:"19"+a:a}function bs(a){return a.replace(/%/g,"")}function bt(a){return a.replace(/(..)/g,"%$1")}function bu(a){var b="malformed IPv6 address";if(!a.match(/^[0-9A-Fa-f:]+$/))throw b;var c=(a=a.toLowerCase()).split(":").length-1;if(c<2)throw b;var d=":".repeat(7-c+2),e=(a=a.replace("::",d)).split(":");if(8!=e.length)throw b;for(var f=0;f<8;f++)e[f]=("0000"+e[f]).slice(-4);return e.join("")}function bv(a){if(!a.match(/^[0-9A-Fa-f]{32}$/))throw Error("malformed IPv6 address: "+a);var b=(a=a.toLowerCase()).match(/.{1,4}/g),c=(a=":"+(b=(b=b.map(function(a){return a.replace(/^0+/,"")})).map(function(a){return""==a?"0":a})).join(":")+":").match(/:(0:){2,}/g);if(null==c)return a.slice(1,-1);var d=c.sort().slice(-1)[0];return"::"!=(a=a.replace(d.substr(0,d.length-1),":")).substr(0,2)&&(a=a.substr(1)),"::"!=a.substr(-2,2)&&(a=a.substr(0,a.length-1)),a}function bw(a){var b=Error("malformed hex value");if(!a.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw b;if(8==a.length)try{return parseInt(a.substr(0,2),16)+"."+parseInt(a.substr(2,2),16)+"."+parseInt(a.substr(4,2),16)+"."+parseInt(a.substr(6,2),16)}catch(a){throw b}if(16==a.length)try{return bw(a.substr(0,8))+"/"+bx(a.substr(8))}catch(a){throw b}if(32==a.length)return bv(a);if(64!=a.length)return a;try{return bv(a.substr(0,32))+"/"+bx(a.substr(32))}catch(a){throw b}}function bx(a){var b,c=Error("malformed mask");try{b=new w(a,16).toString(2)}catch(a){throw c}if(!b.match(/^1*0*$/))throw c;return b.replace(/0+$/,"").length}function by(a){var b=Error("malformed IP address");if(!(a=a.toLowerCase(a)).match(/^[0-9a-f.:/]+$/))throw b;if(a.match(/^[0-9.]+$/)){var c=a.split(".");if(4!==c.length)throw b;var d="";try{for(var e=0;e<4;e++){var f=parseInt(c[e]);d+=("0"+f.toString(16)).slice(-2)}return d}catch(a){throw b}}if(a.match(/^[0-9.]+\/[0-9]+$/)){var g=a.split("/");return by(g[0])+bz(parseInt(g[1]),32)}if(a.match(/^[0-9a-f:]+$/)&&-1!==a.indexOf(":"))return bu(a);if(a.match(/^[0-9a-f:]+\/[0-9]+$/)&&-1!==a.indexOf(":")){var g=a.split("/");return bu(g[0])+bz(parseInt(g[1]),128)}throw b}function bz(a,b){return 32==b&&0==a?"00000000":128==b&&0==a?"00000000000000000000000000000000":new w(Array(a+1).join("1")+Array(b-a+1).join("0"),2).toString(16)}function bA(a){return a.match(/.{4}/g).map(function(a){var b=parseInt(a.substr(0,2),16),c=parseInt(a.substr(2),16);if(0==b&c<128)return String.fromCharCode(c);if(b<8){var d=192|(7&b)<<3|(192&c)>>6,e=128|63&c;return bi(d.toString(16)+e.toString(16))}var d=224|(240&b)>>4,e=128|(15&b)<<2|(192&c)>>6;return bi(d.toString(16)+e.toString(16)+(128|63&c).toString(16))}).join("")}function bB(a){for(var b=encodeURIComponent(a),c="",d=0;d<b.length;d++)"%"==b[d]?(c+=b.substr(d,3),d+=2):c=c+"%"+bc(b[d]);return c}function bC(a){return!!(a.length%2==0&&(a.match(/^[0-9a-f]+$/)||a.match(/^[0-9A-F]+$/)))}function bD(a){return!!a.match(/^[0-9A-Za-z-_.]+$/)}function bE(a){return a.length%2==1?"0"+a:a.substr(0,1)>"7"?"00"+a:a}function bF(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b};try{if(!a.match(/^[0-9.]+$/))return null;var c="",d=a.split("."),e=40*parseInt(d[0],10)+parseInt(d[1],10);c+=b(e),d.splice(0,2);for(var f=0;f<d.length;f++)c+=function(a){var c="",d=parseInt(a,10).toString(2),e=7-d.length%7;7==e&&(e=0);for(var f="",g=0;g<e;g++)f+="0";d=f+d;for(var g=0;g<d.length-1;g+=7){var h=d.substr(g,7);g!=d.length-7&&(h="1"+h),c+=b(parseInt(h,2))}return c}(d[f]);return c}catch(a){return null}}function bG(a){if(!bC(a))return null;try{var b=[],c=a.substr(0,2),d=parseInt(c,16);b[0]=new String(Math.floor(d/40)),b[1]=new String(d%40);for(var e=a.substr(2),f=[],g=0;g<e.length/2;g++)f.push(parseInt(e.substr(2*g,2),16));for(var h=[],i="",g=0;g<f.length;g++)128&f[g]?i+=bJ((127&f[g]).toString(2),7):(i+=bJ((127&f[g]).toString(2),7),h.push(new String(parseInt(i,2))),i="");var j=b.join(".");return h.length>0&&(j=j+"."+h.join(".")),j}catch(a){return null}}function bH(a){return bI(new w(String(a),10))}function bI(a){var b=a.toString(16);if("-"!=b.substr(0,1))return b.length%2==1?b="0"+b:b.match(/^[0-7]/)||(b="00"+b),b;var c=b.substr(1).length;c%2==1?c+=1:b.match(/^[0-7]/)||(c+=2);for(var d="",e=0;e<c;e++)d+="f";return new w(d,16).xor(a).add(w.ONE).toString(16).replace(/^-/,"")}m.lang.String.isInteger=function(a){return!!a.match(/^[0-9]+$/)||!!a.match(/^-[0-9]+$/)},m.lang.String.isHex=function(a){return bC(a)},m.lang.String.isBase64=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)&&a.length%4==0},m.lang.String.isBase64URL=function(a){return!a.match(/[+/=]/)&&(a=be(a),m.lang.String.isBase64(a))},m.lang.String.isIntegerArray=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},m.lang.String.isPrintable=function(a){return null!==a.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},m.lang.String.isIA5=function(a){return null!==a.match(/^[\x20-\x21\x23-\x7f]*$/)},m.lang.String.isMail=function(a){return null!==a.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var bJ=function(a,b,c){return(void 0==c&&(c="0"),a.length>=b)?a:Array(b-a.length+1).join(c)+a};function bK(a){if(a.length%2!=0||null==(a=a.toLowerCase()).match(/^[0-9a-f]+$/))return -1;try{var b=a.substr(0,2);if("00"==b)return parseInt(a.substr(2),16);var c=parseInt(b,16);if(c>7)return -1;var d=a.substr(2),e=parseInt(d,16).toString(2);"0"==e&&(e="00000000"),e=e.slice(0,0-c);var f=parseInt(e,2);if(f==NaN)return -1;return f}catch(a){return -1}}function bL(a){if("number"!=typeof a||a<0)return null;var b=Number(a).toString(2),c=8-b.length%8;8==c&&(c=0);var d=parseInt(b+=bJ("",c,"0"),2).toString(16);return d.length%2==1&&(d="0"+d),"0"+c+d}function bM(a){if("string"!=typeof a||a.length%2!=0||!a.match(/^[0-9a-f]+$/))return null;try{var b=parseInt(a.substr(0,2),16);if(b<0||7<b)return null;for(var c=a.substr(2),d="",e=0;e<c.length;e+=2){var f=c.substr(e,2),g=parseInt(f,16).toString(2);g=("0000000"+g).slice(-8),d+=g}return d.substr(0,d.length-b)}catch(a){return null}}function bN(a,b){for(var c=0,d=0;d<a.length;d++)c|=1<<b[a[d]];for(var e=c.toString(2),f="",d=e.length-1;d>=0;d--)f+=e[d];return f}function bO(a,b,c){if("object"==typeof a){for(var b=String(b).split("."),d=0;d<b.length&&a;d++){var e=b[d];e.match(/^[0-9]+$/)&&(e=parseInt(e)),a=a[e]}return a||!1===a?a:c}}function bP(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)}void 0!==m&&m||(m={}),void 0!==m.crypto&&m.crypto||(m.crypto={}),m.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:r.algo.MD5,sha1:r.algo.SHA1,sha224:r.algo.SHA224,sha256:r.algo.SHA256,sha384:r.algo.SHA384,sha512:r.algo.SHA512,ripemd160:r.algo.RIPEMD160},this.getDigestInfoHex=function(a,b){if(void 0===this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a},this.getPaddedDigestInfoHex=function(a,b,c){var d=this.getDigestInfoHex(a,b),e=c/4;if(d.length+22>e)throw"key is too short for SigAlg: keylen="+c+","+b;for(var f="0001",g="00"+d,h="",i=e-f.length-g.length,j=0;j<i;j+=2)h+="ff";return f+h+g},this.hashString=function(a,b){return new m.crypto.MessageDigest({alg:b}).digestString(a)},this.hashHex=function(a,b){return new m.crypto.MessageDigest({alg:b}).digestHex(a)},this.sha1=function(a){return this.hashString(a,"sha1")},this.sha256=function(a){return this.hashString(a,"sha256")},this.sha256Hex=function(a){return this.hashHex(a,"sha256")},this.sha512=function(a){return this.hashString(a,"sha512")},this.sha512Hex=function(a){return this.hashHex(a,"sha512")},this.isKey=function(a){return a instanceof a3||a instanceof m.crypto.DSA||a instanceof m.crypto.ECDSA}},m.crypto.Util.md5=function(a){return new m.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(a)},m.crypto.Util.ripemd160=function(a){return new m.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(a)},m.crypto.Util.SECURERANDOMGEN=new a1,m.crypto.Util.getRandomHexOfNbytes=function(a){var b=Array(a);return m.crypto.Util.SECURERANDOMGEN.nextBytes(b),bb(b)},m.crypto.Util.getRandomBigIntegerOfNbytes=function(a){return new w(m.crypto.Util.getRandomHexOfNbytes(a),16)},m.crypto.Util.getRandomHexOfNbits=function(a){var b=a%8,c=Array((a-b)/8+1);return m.crypto.Util.SECURERANDOMGEN.nextBytes(c),c[0]=(255<<b&255^255)&c[0],bb(c)},m.crypto.Util.getRandomBigIntegerOfNbits=function(a){return new w(m.crypto.Util.getRandomHexOfNbits(a),16)},m.crypto.Util.getRandomBigIntegerZeroToMax=function(a){for(var b=a.bitLength();;){var c=m.crypto.Util.getRandomBigIntegerOfNbits(b);if(-1!=a.compareTo(c))return c}},m.crypto.Util.getRandomBigIntegerMinToMax=function(a,b){var c=a.compareTo(b);if(1==c)throw"biMin is greater than biMax";if(0==c)return a;var d=b.subtract(a);return m.crypto.Util.getRandomBigIntegerZeroToMax(d).add(a)},m.crypto.MessageDigest=function(a){this.setAlgAndProvider=function(a,b){if(null!==(a=m.crypto.MessageDigest.getCanonicalAlgName(a))&&void 0===b&&(b=m.crypto.Util.DEFAULTPROVIDER[a]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(a)&&"cryptojs"==b){try{this.md=m.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[a].create()}catch(b){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+b}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=r.enc.Hex.parse(a);this.md.update(b)},this.digest=function(){return this.md.finalize().toString(r.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(-1!=":sha256:".indexOf(a)&&"sjcl"==b){try{this.md=new sjcl.hash.sha256}catch(b){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+b}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=sjcl.codec.hex.toBits(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==a&&void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=m.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},m.crypto.MessageDigest.getCanonicalAlgName=function(a){return"string"==typeof a&&(a=(a=a.toLowerCase()).replace(/-/,"")),a},m.crypto.MessageDigest.getHashLength=function(a){var b=m.crypto.MessageDigest,c=b.getCanonicalAlgName(a);if(void 0===b.HASHLENGTH[c])throw"not supported algorithm: "+a;return b.HASHLENGTH[c]},m.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},m.crypto.Mac=function(a){this.setAlgAndProvider=function(a,b){if(null==(a=a.toLowerCase())&&(a="hmacsha1"),"hmac"!=(a=a.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+a;void 0===b&&(b=m.crypto.Util.DEFAULTPROVIDER[a]),this.algProv=a+"/"+b;var c=a.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)&&"cryptojs"==b){try{var d=m.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c];this.mac=r.algo.HMAC.create(d,this.pass)}catch(a){throw"setAlgAndProvider hash alg set fail hashAlg="+c+"/"+a}this.updateString=function(a){this.mac.update(a)},this.updateHex=function(a){var b=r.enc.Hex.parse(a);this.mac.update(b)},this.doFinal=function(){return this.mac.finalize().toString(r.enc.Hex)},this.doFinalString=function(a){return this.updateString(a),this.doFinal()},this.doFinalHex=function(a){return this.updateHex(a),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(a){if("string"==typeof a){var b=a;a.length%2!=1&&a.match(/^[0-9A-Fa-f]+$/)||(b=bk(a)),this.pass=r.enc.Hex.parse(b);return}if("object"!=typeof a)throw"KJUR.crypto.Mac unsupported password type: "+a;var b=null;if(void 0!==a.hex){if(a.hex.length%2!=0||!a.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+a.hex;b=a.hex}if(void 0!==a.utf8&&(b=bh(a.utf8)),void 0!==a.rstr&&(b=bk(a.rstr)),void 0!==a.b64&&(b=u(a.b64)),void 0!==a.b64u&&(b=bg(a.b64u)),null==b)throw"KJUR.crypto.Mac unsupported password type: "+a;this.pass=r.enc.Hex.parse(b)},void 0!==a&&(void 0!==a.pass&&this.setPassword(a.pass),void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=m.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},m.crypto.Signature=function(a){var b=null;if(this._setAlgNames=function(){var a=this.algName.match(/^(.+)with(.+)$/);a&&(this.mdAlgName=a[1].toLowerCase(),this.pubkeyAlgName=a[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a},this.setAlgAndProvider=function(a,b){if(this._setAlgNames(),"cryptojs/jsrsa"!=b)throw Error("provider not supported: "+b);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new m.crypto.MessageDigest({alg:this.mdAlgName})}catch(a){throw Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+a)}this.init=function(a,b){var c=null;try{c=void 0===b?bQ.getKey(a):bQ.getKey(a,b)}catch(a){throw"init failed:"+a}if(!0===c.isPrivate)this.prvKey=c,this.state="SIGN";else if(!0===c.isPublic)this.pubKey=c,this.state="VERIFY";else throw"init failed.:"+c},this.updateString=function(a){this.md.updateString(a)},this.updateHex=function(a){this.md.updateHex(a)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==m.crypto.ECDSA&&(this.prvKey=new m.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof a3&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof a3&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof m.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof m.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(a){return this.updateString(a),this.sign()},this.signHex=function(a){return this.updateHex(a),this.sign()},this.verify=function(a){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==m.crypto.ECDSA&&(this.pubKey=new m.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof a3&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,a,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof a3&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(void 0!==m.crypto.ECDSA&&this.pubKey instanceof m.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(void 0!==m.crypto.DSA&&this.pubKey instanceof m.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(a,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(a){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(a){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(a){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(a){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=a,void 0!==a&&(void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov?this.provName=m.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==a.psssaltlen&&(this.pssSaltLen=a.psssaltlen),void 0!==a.prvkeypem))if(void 0!==a.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";else try{var b=bQ.getKey(a.prvkeypem);this.init(b)}catch(a){throw"fatal error to load pem private key: "+a}},m.crypto.Cipher=function(a){},m.crypto.Cipher.encrypt=function(a,b,c,d){if(void 0!=bO(d,"enclag")&&(c=d.encalg),"string"==typeof c&&"-CBC"==c.substr(-4)){var e,f=b;void 0!=bO(d,"key")&&(f=d.key),void 0!=bO(d,"enc")&&(hEnc=d.enc);var g=r.enc.Hex.parse(f),h=r.enc.Hex.parse(a),i=r.enc.Hex.parse(d.iv);if("des-EDE3-CBC"==c)e=r.TripleDES.encrypt(h,g,{iv:i});else if("aes128-CBC"==c||"aes256-CBC"==c)e=r.AES.encrypt(h,g,{iv:i});else throw Error("unsupported algorithm: "+c);return e+""}throw Error("Cipher.encrypt: unsupported key or algorithm")},m.crypto.Cipher.decrypt=function(a,b,c,d){if(void 0!=bO(d,"enclag")&&(c=d.encalg),"string"==typeof c&&"-CBC"==c.substr(-4)){var e,f=b,g=a;void 0!=bO(d,"key")&&(f=d.key),void 0!=bO(d,"enc")&&(g=d.enc);var h=r.enc.Hex.parse(f),i=r.enc.Hex.parse(g),j=r.enc.Hex.parse(d.iv);if("des-EDE3-CBC"==c)e=r.TripleDES.decrypt({ciphertext:i},h,{iv:j});else if("aes128-CBC"==c||"aes256-CBC"==c)e=r.AES.decrypt({ciphertext:i},h,{iv:j});else throw Error("unsupported algorithm: "+c);return r.enc.Hex.stringify(e)}throw Error("Cipher.decrypt: unsupported key or algorithm")},m.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==m&&m||(m={}),void 0!==m.crypto&&m.crypto||(m.crypto={}),m.crypto.ECDSA=function(a){var b=Error,c=m.crypto.ECDSA,d=m.crypto.ECParameterDB,e=c.getName,f=a8.getVbyListEx,g=a8.isASN1HEX,h=new a1;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(a){return new w(a.bitLength(),h).mod(a.subtract(w.ONE)).add(w.ONE)},this.setNamedCurve=function(a){this.ecparams=d.getByName(a),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=a},this.setPrivateKeyHex=function(a){this.isPrivate=!0,this.prvKeyHex=a},this.setPublicKeyHex=function(a){this.isPublic=!0,this.pubKeyHex=a},this.getPublicKeyXYHex=function(){var a=this.pubKeyHex;if("04"!==a.substr(0,2))throw"this method supports uncompressed format(04) only";var b=this.ecparams.keycharlen;if(a.length!==2+2*b)throw"malformed public key hex length";var c={};return c.x=a.substr(2,b),c.y=a.substr(2+b),c},this.getShortNISTPCurveName=function(){var a=this.curveName;return"secp256r1"===a||"NIST P-256"===a||"P-256"===a||"prime256v1"===a?"P-256":"secp384r1"===a||"NIST P-384"===a||"P-384"===a?"P-384":"secp521r1"===a||"NIST P-521"===a||"P-521"===a?"P-521":null},this.generateKeyPairHex=function(){var a=this.ecparams.n,b=this.getBigRandom(a),c=this.ecparams.keycharlen,d=("0000000000"+b.toString(16)).slice(-c);return this.setPrivateKeyHex(d),{ecprvhex:d,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var a=new w(this.prvKeyHex,16),b=this.ecparams.G.multiply(a),c=b.getX().toBigInteger(),d=b.getY().toBigInteger(),e=this.ecparams.keycharlen,f="04"+("0000000000"+c.toString(16)).slice(-e)+("0000000000"+d.toString(16)).slice(-e);return this.setPublicKeyHex(f),f},this.signWithMessageHash=function(a){return this.signHex(a,this.prvKeyHex)},this.signHex=function(a,b){var d=new w(b,16),e=this.ecparams.n,f=new w(a.substring(0,this.ecparams.keycharlen),16);do var g=this.getBigRandom(e),h=this.ecparams.G.multiply(g).getX().toBigInteger().mod(e);while(0>=h.compareTo(w.ZERO))var i=g.modInverse(e).multiply(f.add(d.multiply(h))).mod(e);return c.biRSSigToASN1Sig(h,i)},this.sign=function(a,b){var c=this.ecparams.n,d=w.fromByteArrayUnsigned(a);do var e=this.getBigRandom(c),f=this.ecparams.G.multiply(e).getX().toBigInteger().mod(c);while(0>=f.compareTo(w.ZERO))var g=e.modInverse(c).multiply(d.add(b.multiply(f))).mod(c);return this.serializeSig(f,g)},this.verifyWithMessageHash=function(a,b){return this.verifyHex(a,b,this.pubKeyHex)},this.verifyHex=function(a,b,d){try{var e,f,g=c.parseSigHex(b);e=g.r,f=g.s;var h=a5.decodeFromHex(this.ecparams.curve,d),i=new w(a.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(i,e,f,h)}catch(a){return!1}},this.verify=function(a,b,c){if(Bitcoin.Util.isArray(b)){var d,e,f,g=this.parseSig(b);d=g.r,e=g.s}else if("object"==typeof b&&b.r&&b.s)d=b.r,e=b.s;else throw"Invalid value for signature";if(c instanceof a5)f=c;else if(Bitcoin.Util.isArray(c))f=a5.decodeFrom(this.ecparams.curve,c);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var h=w.fromByteArrayUnsigned(a);return this.verifyRaw(h,d,e,f)},this.verifyRaw=function(a,b,c,d){var e=this.ecparams.n,f=this.ecparams.G;if(0>b.compareTo(w.ONE)||b.compareTo(e)>=0||0>c.compareTo(w.ONE)||c.compareTo(e)>=0)return!1;var g=c.modInverse(e),h=a.multiply(g).mod(e),i=b.multiply(g).mod(e);return f.multiply(h).add(d.multiply(i)).getX().toBigInteger().mod(e).equals(b)},this.serializeSig=function(a,b){var c=a.toByteArraySigned(),d=b.toByteArraySigned(),e=[];return e.push(2),e.push(c.length),(e=e.concat(c)).push(2),e.push(d.length),(e=e.concat(d)).unshift(e.length),e.unshift(48),e},this.parseSig=function(a){if(48!=a[0])throw Error("Signature not a valid DERSequence");if(2!=a[b=2])throw Error("First element in signature must be a DERInteger");var b,c=a.slice(b+2,b+2+a[b+1]);if(b+=2+a[b+1],2!=a[b])throw Error("Second element in signature must be a DERInteger");var d=a.slice(b+2,b+2+a[b+1]);return b+=2+a[b+1],{r:w.fromByteArrayUnsigned(c),s:w.fromByteArrayUnsigned(d)}},this.parseSigCompact=function(a){if(65!==a.length)throw"Signature has the wrong length";var b=a[0]-27;if(b<0||b>7)throw"Invalid signature type";var c=this.ecparams.n;return{r:w.fromByteArrayUnsigned(a.slice(1,33)).mod(c),s:w.fromByteArrayUnsigned(a.slice(33,65)).mod(c),i:b}},this.readPKCS5PrvKeyHex=function(a){var b,c,d;if(!1===g(a))throw Error("not ASN.1 hex string");try{b=f(a,0,["[0]",0],"06"),c=f(a,0,[1],"04");try{d=f(a,0,["[1]",0],"03")}catch(a){}}catch(a){throw Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=e(b),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(d),this.setPrivateKeyHex(c),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(a){var c,d,h;if(!1===g(a))throw new b("not ASN.1 hex string");try{f(a,0,[1,0],"06"),c=f(a,0,[1,1],"06"),d=f(a,0,[2,0,1],"04");try{h=f(a,0,[2,0,"[1]",0],"03")}catch(a){}}catch(a){throw new b("malformed PKCS#8 plain ECC private key")}if(this.curveName=e(c),void 0===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(h),this.setPrivateKeyHex(d),this.isPublic=!1},this.readPKCS8PubKeyHex=function(a){var c,d;if(!1===g(a))throw new b("not ASN.1 hex string");try{f(a,0,[0,0],"06"),c=f(a,0,[0,1],"06"),d=f(a,0,[1],"03")}catch(a){throw new b("malformed PKCS#8 ECC public key")}if(this.curveName=e(c),null===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(d)},this.readCertPubKeyHex=function(a,c){var d,h;if(!1===g(a))throw new b("not ASN.1 hex string");try{d=f(a,0,[0,5,0,1],"06"),h=f(a,0,[0,5,1],"03")}catch(a){throw new b("malformed X.509 certificate ECC public key")}if(this.curveName=e(d),null===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(h)},void 0!==a&&void 0!==a.curve&&(this.curveName=a.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==a&&(void 0!==a.prv&&this.setPrivateKeyHex(a.prv),void 0!==a.pub&&this.setPublicKeyHex(a.pub))},m.crypto.ECDSA.parseSigHex=function(a){var b=m.crypto.ECDSA.parseSigHexInHexRS(a);return{r:new w(b.r,16),s:new w(b.s,16)}},m.crypto.ECDSA.parseSigHexInHexRS=function(a){var b=a8.getChildIdx,c=a8.getV;if(a8.checkStrictDER(a,0),"30"!=a.substr(0,2))throw Error("signature is not a ASN.1 sequence");var d=b(a,0);if(2!=d.length)throw Error("signature shall have two elements");var e=d[0],f=d[1];if("02"!=a.substr(e,2))throw Error("1st item not ASN.1 integer");if("02"!=a.substr(f,2))throw Error("2nd item not ASN.1 integer");return{r:c(a,e),s:c(a,f)}},m.crypto.ECDSA.asn1SigToConcatSig=function(a){var b=m.crypto.ECDSA.parseSigHexInHexRS(a),c=b.r,d=b.s;if(c.length>=130&&c.length<=134){if(c.length%2!=0)throw Error("unknown ECDSA sig r length error");if(d.length%2!=0)throw Error("unknown ECDSA sig s length error");"00"==c.substr(0,2)&&(c=c.substr(2)),"00"==d.substr(0,2)&&(d=d.substr(2));var e=Math.max(c.length,d.length);return(c=("000000"+c).slice(-e))+(d=("000000"+d).slice(-e))}if("00"==c.substr(0,2)&&c.length%32==2&&(c=c.substr(2)),"00"==d.substr(0,2)&&d.length%32==2&&(d=d.substr(2)),c.length%32==30&&(c="00"+c),d.length%32==30&&(d="00"+d),c.length%32!=0)throw Error("unknown ECDSA sig r length error");if(d.length%32!=0)throw Error("unknown ECDSA sig s length error");return c+d},m.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var b=a.substr(0,a.length/2),c=a.substr(a.length/2);return m.crypto.ECDSA.hexRSSigToASN1Sig(b,c)},m.crypto.ECDSA.hexRSSigToASN1Sig=function(a,b){var c=new w(a,16),d=new w(b,16);return m.crypto.ECDSA.biRSSigToASN1Sig(c,d)},m.crypto.ECDSA.biRSSigToASN1Sig=function(a,b){var c=m.asn1,d=new c.DERInteger({bigint:a}),e=new c.DERInteger({bigint:b});return new c.DERSequence({array:[d,e]}).tohex()},m.crypto.ECDSA.getName=function(a){return"2b8104001f"===a?"secp192k1":"2a8648ce3d030107"===a?"secp256r1":"2b8104000a"===a?"secp256k1":"2b81040021"===a?"secp224r1":"2b81040022"===a?"secp384r1":"2b81040023"===a?"secp521r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)?"secp256r1":-1!=="|secp256k1|".indexOf(a)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(a)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(a)?"secp384r1":-1!=="|secp521r1|NIST P-521|P-521|".indexOf(a)?"secp521r1":null},void 0!==m&&m||(m={}),void 0!==m.crypto&&m.crypto||(m.crypto={}),m.crypto.ECParameterDB=new function(){var a={},b={};function c(a){return new w(a,16)}this.getByName=function(c){var d=c;if(void 0!==b[d]&&(d=b[c]),void 0!==a[d])return a[d];throw"unregistered EC curve name: "+d},this.regist=function(d,e,f,g,h,i,j,k,l,m,n,o){a[d]={};var p=c(f),q=c(g),r=c(h),s=c(i),t=c(j),u=new a6(p,q,r),v=u.decodePointHex("04"+k+l);a[d].name=d,a[d].keylen=e,a[d].keycharlen=2*Math.ceil(e/8),a[d].curve=u,a[d].G=v,a[d].n=s,a[d].h=t,a[d].oid=n,a[d].info=o;for(var w=0;w<m.length;w++)b[m[w]]=d}},m.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),m.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),m.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),m.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),m.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),m.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),m.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),m.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),m.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),m.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==m&&m||(m={}),void 0!==m.crypto&&m.crypto||(m.crypto={}),m.crypto.DSA=function(){a8.getVbyList;var a=a8.getVbyListEx,b=a8.isASN1HEX;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(a,b,c,d,e){this.isPrivate=!0,this.p=a,this.q=b,this.g=c,this.y=d,this.x=e},this.setPrivateHex=function(a,b,c,d,e){var f,g,h,i,j;f=new w(a,16),g=new w(b,16),h=new w(c,16),i="string"==typeof d&&d.length>1?new w(d,16):null,j=new w(e,16),this.setPrivate(f,g,h,i,j)},this.setPublic=function(a,b,c,d){this.isPublic=!0,this.p=a,this.q=b,this.g=c,this.y=d,this.x=null},this.setPublicHex=function(a,b,c,d){var e,f,g,h;e=new w(a,16),f=new w(b,16),g=new w(c,16),h=new w(d,16),this.setPublic(e,f,g,h)},this.signWithMessageHash=function(a){var b=this.p,c=this.q,d=this.g;this.y;var e=this.x,f=m.crypto.Util.getRandomBigIntegerMinToMax(w.ONE.add(w.ONE),c.subtract(w.ONE)),g=new w(a.substr(0,c.bitLength()/4),16),h=d.modPow(f,b).mod(c),i=f.modInverse(c).multiply(g.add(e.multiply(h))).mod(c);return m.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:h}},{int:{bigint:i}}]})},this.verifyWithMessageHash=function(a,b){var c=this.p,d=this.q,e=this.g,f=this.y,g=this.parseASN1Signature(b),h=g[0],i=g[1],j=new w(a.substr(0,d.bitLength()/4),16);if(w.ZERO.compareTo(h)>0||h.compareTo(d)>0||w.ZERO.compareTo(i)>=0||i.compareTo(d)>0)throw"invalid DSA signature";var k=i.modInverse(d),l=j.multiply(k).mod(d),m=h.multiply(k).mod(d);return 0==e.modPow(l,c).multiply(f.modPow(m,c)).mod(c).mod(d).compareTo(h)},this.parseASN1Signature=function(b){try{var c=new w(a(b,0,[0],"02"),16),d=new w(a(b,0,[1],"02"),16);return[c,d]}catch(a){throw Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(c){var d,e,f,g,h;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[1],"02"),e=a(c,0,[2],"02"),f=a(c,0,[3],"02"),g=a(c,0,[4],"02"),h=a(c,0,[5],"02")}catch(a){throw Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(d,e,f,g,h)},this.readPKCS8PrvKeyHex=function(c){var d,e,f,g;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[1,1,0],"02"),e=a(c,0,[1,1,1],"02"),f=a(c,0,[1,1,2],"02"),g=a(c,0,[2,0],"02")}catch(a){throw Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(d,e,f,null,g)},this.readPKCS8PubKeyHex=function(c){var d,e,f,g;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[0,1,0],"02"),e=a(c,0,[0,1,1],"02"),f=a(c,0,[0,1,2],"02"),g=a(c,0,[1,0],"02")}catch(a){throw Error("malformed PKCS#8 DSA public key")}this.setPublicHex(d,e,f,g)},this.readCertPubKeyHex=function(c,d){var e,f,g,h;if(!1===b(c))throw Error("not ASN.1 hex string");try{e=a(c,0,[0,5,0,1,0],"02"),f=a(c,0,[0,5,0,1,1],"02"),g=a(c,0,[0,5,0,1,2],"02"),h=a(c,0,[0,5,1,0],"02")}catch(a){throw Error("malformed X.509 certificate DSA public key")}this.setPublicHex(e,f,g,h)}};var bQ=(d=function(a,b,c){return e(r.AES,a,b,c)},e=function(a,b,c,d){var e=r.enc.Hex.parse(b),f=r.enc.Hex.parse(c),g=r.enc.Hex.parse(d),h={};h.key=f,h.iv=g,h.ciphertext=e;var i=a.decrypt(h,f,{iv:g});return r.enc.Hex.stringify(i)},f=function(a,b,c){return g(r.AES,a,b,c)},g=function(a,b,c,d){var e=r.enc.Hex.parse(b),f=r.enc.Hex.parse(c),g=r.enc.Hex.parse(d),h=a.encrypt(e,f,{iv:g}),i=r.enc.Hex.parse(h.toString());return r.enc.Base64.stringify(i)},h={"AES-256-CBC":{proc:d,eproc:f,keylen:32,ivlen:16},"AES-192-CBC":{proc:d,eproc:f,keylen:24,ivlen:16},"AES-128-CBC":{proc:d,eproc:f,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(a,b,c){return e(r.TripleDES,a,b,c)},eproc:function(a,b,c){return g(r.TripleDES,a,b,c)},keylen:24,ivlen:8},"DES-CBC":{proc:function(a,b,c){return e(r.DES,a,b,c)},eproc:function(a,b,c){return g(r.DES,a,b,c)},keylen:8,ivlen:8}},i=function(a){var b=r.lib.WordArray.random(a);return r.enc.Hex.stringify(b)},j=function(a){var b={},c=a.match(RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));c&&(b.cipher=c[1],b.ivsalt=c[2]);var d=a.match(RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));d&&(b.type=d[1]);var e=-1,f=0;-1!=a.indexOf("\r\n\r\n")&&(e=a.indexOf("\r\n\r\n"),f=2),-1!=a.indexOf("\n\n")&&(e=a.indexOf("\n\n"),f=1);var g=a.indexOf("-----END");if(-1!=e&&-1!=g){var h=a.substring(e+2*f,g-f);b.data=h=h.replace(/\s+/g,"")}return b},k=function(a,b,c){for(var d=c.substring(0,16),e=r.enc.Hex.parse(d),f=r.enc.Utf8.parse(b),g=h[a].keylen+h[a].ivlen,i="",j=null;;){var k=r.algo.MD5.create();if(null!=j&&k.update(j),k.update(f),k.update(e),j=k.finalize(),(i+=r.enc.Hex.stringify(j)).length>=2*g)break}var l={};return l.keyhex=i.substr(0,2*h[a].keylen),l.ivhex=i.substr(2*h[a].keylen,2*h[a].ivlen),l},l=function(a,b,c,d){var e=r.enc.Base64.parse(a),f=r.enc.Hex.stringify(e);return(0,h[b].proc)(f,c,d)},{version:"1.0.0",parsePKCS5PEM:function(a){return j(a)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(a,b,c){return k(a,b,c)},decryptKeyB64:function(a,b,c,d){return l(a,b,c,d)},getDecryptedKeyHex:function(a,b){var c=j(a);c.type;var d=c.cipher,e=c.ivsalt,f=c.data,g=k(d,b,e).keyhex;return l(f,d,g,e)},getEncryptedPKCS5PEMFromPrvKeyHex:function(a,b,c,d,e){var f,g,j="";if((void 0===d||null==d)&&(d="AES-256-CBC"),void 0===h[d])throw Error("KEYUTIL unsupported algorithm: "+d);(void 0===e||null==e)&&(e=i(h[d].ivlen).toUpperCase());var l=k(d,c,e).keyhex,m=(f=d,g=e,(0,h[f].eproc)(b,l,g)).replace(/(.{64})/g,"$1\r\n"),j="-----BEGIN "+a+" PRIVATE KEY-----\r\n";return j+="Proc-Type: 4,ENCRYPTED\r\n",j+="DEK-Info: "+d+","+e+"\r\n",j+="\r\n",j+=m,j+="\r\n-----END "+a+" PRIVATE KEY-----\r\n"},getEncryptedPKCS8PEM:function(a,b,c){return bn(this.getEncryptedPKCS8Hex(a,b,c),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(a,b,c){(d=void 0==c||null==c?{}:JSON.parse(JSON.stringify(c))).plain=a,this.initPBES2Param(d),this.encryptPBES2Param(d,b);var d,e=this.generatePBES2ASN1Param(d);return m.asn1.ASN1Util.newObject(e).tohex()},initPBES2Param:function(a){if(void 0==bO(a,"encalg")&&(a.encalg="aes256-CBC"),void 0==bO(a,"iter")&&(a.iter=2048),void 0==bO(a,"prf")&&(a.prf="hmacWithSHA256"),void 0==bO(a,"salt")&&(a.salt=r.enc.Hex.stringify(r.lib.WordArray.random(8))),void 0==bO(a,"enciv")){var b;"des-EDE3-CBC"==a.encalg&&(b=8),"aes128-CBC"==a.encalg&&(b=16),"aes256-CBC"==a.encalg&&(b=16),a.enciv=r.enc.Hex.stringify(r.lib.WordArray.random(b))}},encryptPBES2Param:function(a,b){var c=bQ.getDKFromPBES2Param(a,b);try{var d=m.crypto.Cipher.encrypt(a.plain,c,a.encalg,{iv:a.enciv})}catch(b){throw Error("encrypt error: "+a.plain+" "+c+" "+a.encalg+" "+a.enciv)}a.enc=d},generatePBES2ASN1Param:function(a){var b={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:a.salt}},{int:{hex:bH(a.iter)}}]}]},{seq:[{oid:a.encalg},{octstr:{hex:a.enciv}}]}]}]},{octstr:{hex:a.enc}}]};return"hmacWithSHA1"!=a.prf&&b.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:a.prf},{null:""}]}),b},parseHexOfEncryptedPKCS8:function(a){var b=a8.getChildIdx,c=a8.getV,d={},e=b(a,0);if(2!=e.length)throw Error("malformed format: SEQUENCE(0).items != 2: "+e.length);d.ciphertext=c(a,e[1]);var f=b(a,e[0]);if(2!=f.length)throw Error("malformed format: SEQUENCE(0.0).items != 2: "+f.length);if("2a864886f70d01050d"!=c(a,f[0]))throw Error("this only supports pkcs5PBES2");var g=b(a,f[1]);if(2!=f.length)throw Error("malformed format: SEQUENCE(0.0.1).items != 2: "+g.length);var h=b(a,g[1]);if(2!=h.length)throw Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+h.length);if("2a864886f70d0307"!=c(a,h[0]))throw"this only supports TripleDES";d.encryptionSchemeAlg="TripleDES",d.encryptionSchemeIV=c(a,h[1]);var i=b(a,g[0]);if(2!=i.length)throw Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+i.length);if("2a864886f70d01050c"!=c(a,i[0]))throw Error("this only supports pkcs5PBKDF2");var j=b(a,i[1]);if(j.length<2)throw Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+j.length);d.pbkdf2Salt=c(a,j[0]);var k=c(a,j[1]);try{d.pbkdf2Iter=parseInt(k,16)}catch(a){throw Error("malformed format pbkdf2Iter: "+k)}return d},getPBKDF2KeyHexFromParam:function(a,b){var c=r.enc.Hex.parse(a.pbkdf2Salt),d=a.pbkdf2Iter,e=r.PBKDF2(b,c,{keySize:6,iterations:d});return r.enc.Hex.stringify(e)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(a,b){var c=bo(a,"ENCRYPTED PRIVATE KEY"),d=this.parseHexOfEncryptedPKCS8(c),e=bQ.getPBKDF2KeyHexFromParam(d,b),f={};f.ciphertext=r.enc.Hex.parse(d.ciphertext);var g=r.enc.Hex.parse(e),h=r.enc.Hex.parse(d.encryptionSchemeIV),i=r.TripleDES.decrypt(f,g,{iv:h});return r.enc.Hex.stringify(i)},parsePBES2:function(a){var b=a8.parse(a);if("pkcs5PBES2"!=bO(b,"seq.0.seq.0.oid")||"pkcs5PBKDF2"!=bO(b,"seq.0.seq.1.seq.0.seq.0.oid"))throw Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var c=bO(b,"seq.0.seq.1.seq.0.seq.1.seq");if(void 0==c)throw Error("PBKDF2 parameter not found");var d=bO(c,"0.octstr.hex"),e=bO(c,"1.int.hex"),f=bO(c,"2.seq.0.oid","hmacWithSHA1"),g=-1;try{g=parseInt(e,16)}catch(a){throw Error("iter not proper value")}var h=bO(b,"seq.0.seq.1.seq.1.seq.0.oid"),i=bO(b,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),j=bO(b,"seq.1.octstr.hex");if(void 0==h||void 0==i||void 0==j)throw Error("encalg, enciv or enc is undefined");return{salt:d,iter:g,prf:f,encalg:h,enciv:i,enc:j}},getDKFromPBES2Param:function(a,b){var c={hmacWithSHA1:r.algo.SHA1,hmacWithSHA224:r.algo.SHA224,hmacWithSHA256:r.algo.SHA256,hmacWithSHA384:r.algo.SHA384,hmacWithSHA512:r.algo.SHA512}[a.prf];if(void 0==c)throw Error("unsupported prf");var d={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[a.encalg];if(void 0==d)throw Error("unsupported encalg");var e=r.enc.Hex.parse(a.salt),f=a.iter;try{var g=r.PBKDF2(b,e,{keySize:d,iterations:f,hasher:c});return r.enc.Hex.stringify(g)}catch(c){throw Error("PBKDF2 error: "+c+" "+JSON.stringify(a)+" "+b)}},getPlainHexFromEncryptedPKCS8PEM:function(a,b){if(-1==a.indexOf("BEGIN ENCRYPTED PRIVATE KEY"))throw Error("not Encrypted PKCS#8 PEM string");var c,d=bo(a);try{c=bQ.parsePBES2(d)}catch(a){throw Error("malformed PBES2 format: "+a.message)}var e=bQ.getDKFromPBES2Param(c,b);return m.crypto.Cipher.decrypt(c.enc,e,c.encalg,{iv:c.enciv})},getKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainHexFromEncryptedPKCS8PEM(a,b);return this.getKeyFromPlainPrivatePKCS8Hex(c)},parsePlainPrivatePKCS8Hex:function(a){var b=a8.getChildIdx,c=a8.getV,d={};if(d.algparam=null,"30"!=a.substr(0,2))throw Error("malformed plain PKCS8 private key(code:001)");var e=b(a,0);if(e.length<3)throw Error("malformed plain PKCS8 private key(code:002)");if("30"!=a.substr(e[1],2))throw Error("malformed PKCS8 private key(code:003)");var f=b(a,e[1]);if(2!=f.length)throw Error("malformed PKCS8 private key(code:004)");if("06"!=a.substr(f[0],2))throw Error("malformed PKCS8 private key(code:005)");if(d.algoid=c(a,f[0]),"06"==a.substr(f[1],2)&&(d.algparam=c(a,f[1])),"04"!=a.substr(e[2],2))throw Error("malformed PKCS8 private key(code:006)");return d.keyidx=a8.getVidx(a,e[2]),d},getKeyFromPlainPrivatePKCS8PEM:function(a){var b=bo(a,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(b)},getKeyFromPlainPrivatePKCS8Hex:function(a){var b,c=this.parsePlainPrivatePKCS8Hex(a);if("2a864886f70d010101"==c.algoid)b=new a3;else if("2a8648ce380401"==c.algoid)b=new m.crypto.DSA;else if("2a8648ce3d0201"==c.algoid)b=new m.crypto.ECDSA;else throw Error("unsupported private key algorithm");return b.readPKCS8PrvKeyHex(a),b},_getKeyFromPublicPKCS8Hex:function(a){var b,c=a8.getVbyList(a,0,[0,0],"06");if("2a864886f70d010101"===c)b=new a3;else if("2a8648ce380401"===c)b=new m.crypto.DSA;else if("2a8648ce3d0201"===c)b=new m.crypto.ECDSA;else throw Error("unsupported PKCS#8 public key hex");return b.readPKCS8PubKeyHex(a),b},parsePublicRawRSAKeyHex:function(a){var b=a8.getChildIdx,c=a8.getV,d={};if("30"!=a.substr(0,2))throw Error("malformed RSA key(code:001)");var e=b(a,0);if(2!=e.length)throw Error("malformed RSA key(code:002)");if("02"!=a.substr(e[0],2))throw Error("malformed RSA key(code:003)");if(d.n=c(a,e[0]),"02"!=a.substr(e[1],2))throw Error("malformed RSA key(code:004)");return d.e=c(a,e[1]),d},parsePublicPKCS8Hex:function(a){var b=a8.getChildIdx,c=a8.getV,d={};d.algparam=null;var e=b(a,0);if(2!=e.length)throw Error("outer DERSequence shall have 2 elements: "+e.length);var f=e[0];if("30"!=a.substr(f,2))throw Error("malformed PKCS8 public key(code:001)");var g=b(a,f);if(2!=g.length)throw Error("malformed PKCS8 public key(code:002)");if("06"!=a.substr(g[0],2))throw Error("malformed PKCS8 public key(code:003)");if(d.algoid=c(a,g[0]),"06"==a.substr(g[1],2)?d.algparam=c(a,g[1]):"30"==a.substr(g[1],2)&&(d.algparam={},d.algparam.p=a8.getVbyList(a,g[1],[0],"02"),d.algparam.q=a8.getVbyList(a,g[1],[1],"02"),d.algparam.g=a8.getVbyList(a,g[1],[2],"02")),"03"!=a.substr(e[1],2))throw Error("malformed PKCS8 public key(code:004)");return d.key=c(a,e[1]).substr(2),d}});function bR(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a}function bS(a,b,c){for(var d="",e=0;d.length<b;)d+=bj(c(bk(a+String.fromCharCode.apply(String,[(0xff000000&e)>>24,(0xff0000&e)>>16,(65280&e)>>8,255&e])))),e+=1;return d}function bT(a){for(var b in m.crypto.Util.DIGESTINFOHEAD){var c=m.crypto.Util.DIGESTINFOHEAD[b],d=c.length;if(a.substring(0,d)==c)return[b,a.substring(d)]}return[]}function bU(a){var b,c=a8.getChildIdx,d=a8.getV,e=(a8.dump,a8.parse),f=a8.getTLV,g=a8.getVbyList,h=a8.getVbyListEx,i=a8.getTLVbyList,j=a8.getTLVbyListEx,k=a8.getIdxbyList,l=a8.getIdxbyListEx,n=a8.getVidx,o=a8.getInt,p=a8.oidname,q=a8.hextooidstr,r=Error;try{b=m.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(a){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var a=i(this.hex,0,[0,0]);if("a0"!=a.substr(0,2))return this.version=1,this.foffset=-1,1;var b=o(i(a,0,[0]),0);if(b<0||2<b)throw Error("malformed version field");return this.version=b+1,this.version},this.getSerialNumberHex=function(){return h(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var a=j(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(a)},this.getAlgorithmIdentifierName=function(a){for(var c in b)if(a===b[c])return c;return p(h(a,0,[0],"06"))},this.getIssuer=function(a,b){return this.getX500Name(this.getIssuerHex(),a,b)},this.getIssuerHex=function(){return i(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(a,b){return this.getX500Name(this.getSubjectHex(),a,b)},this.getSubjectHex=function(){return i(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var a=g(this.hex,0,[0,4+this.foffset,0]);return decodeURIComponent(a=a.replace(/(..)/g,"%$1"))},this.getNotAfter=function(){var a=g(this.hex,0,[0,4+this.foffset,1]);return decodeURIComponent(a=a.replace(/(..)/g,"%$1"))},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return i(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var a=this.getSPKI();return null==a?null:g(a,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return k(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var a=this.getPublicKeyIdx();return k(this.hex,a,[1,0],"30")},this.getPublicKey=function(){return bQ.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var a=i(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(a)},this.getSignatureValueHex=function(){return g(this.hex,0,[2],"03",!0)},this.verifySignature=function(a){var b=this.getSignatureAlgorithmField(),c=this.getSignatureValueHex(),d=i(this.hex,0,[0],"30"),e=new m.crypto.Signature({alg:b});return e.init(a),e.updateHex(d),e.verify(c)},this.parseExt=function(a){var b,e,f;if(void 0===a){if(f=this.hex,3!==this.version)return -1;b=k(f,0,[0,7,0],"30"),e=c(f,b)}else{var h=k(f=bo(a),0,[0,3,0,0],"06");if("2a864886f70d01090e"!=d(f,h)){this.aExtInfo=[];return}b=k(f,0,[0,3,0,1,0],"30"),e=c(f,b),this.hex=f}this.aExtInfo=[];for(var i=0;i<e.length;i++){var j={};j.critical=!1;var l=c(f,e[i]),m=0;3===l.length&&(j.critical=!0,m=1),j.oid=a8.hextooidstr(g(f,e[i],[0],"06"));var o=k(f,e[i],[1+m]);j.vidx=n(f,o),this.aExtInfo.push(j)}},this.getExtInfo=function(a){var b=this.aExtInfo,c=a;if(a.match(/^[0-9.]+$/)||(c=m.asn1.x509.OID.name2oid(a)),""!==c){for(var d=0;d<b.length;d++)if(b[d].oid===c)return b[d]}},this.getCriticalExtV=function(a,b,c){if(void 0!=b)return[b,c];var d=this.getExtInfo(a);return void 0==d?[null,null]:[f(this.hex,d.vidx),d.critical]},this.getExtBasicConstraints=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("basicConstraints");if(void 0===c)return;a=f(this.hex,c.vidx),b=c.critical}var e={extname:"basicConstraints"};if(b&&(e.critical=!0),"3000"===a)return e;if("30030101ff"===a)return e.cA=!0,e;if("30060101ff02"===a.substr(0,12)){var g=parseInt(d(a,10),16);return e.cA=!0,e.pathLen=g,e}throw Error("hExtV parse error: "+a)},this.getExtNameConstraints=function(a,b){var d=this.getCriticalExtV("nameConstraints",a,b);if(a=d[0],b=d[1],null!=a){var e={extname:"nameConstraints"};b&&(e.critical=!0);for(var g=c(a,0),h=0;h<g.length;h++){for(var i=[],j=c(a,g[h]),k=0;k<j.length;k++){var l=f(a,j[k]),m=this.getGeneralSubtree(l);i.push(m)}var n=a.substr(g[h],2);"a0"==n?e.permit=i:"a1"==n&&(e.exclude=i)}return e}},this.getGeneralSubtree=function(a){var b=c(a,0),e=b.length;if(e<1||2<e)throw Error("wrong num elements");for(var g=this.getGeneralName(f(a,b[0])),h=1;h<e;h++){var i=a.substr(b[h],2),j=parseInt(d(a,b[h]),16);"80"==i&&(g.min=j),"81"==i&&(g.max=j)}return g},this.getExtKeyUsage=function(a,b){var c=this.getCriticalExtV("keyUsage",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"keyUsage"};return b&&(d.critical=!0),d.names=this.getExtKeyUsageString(a).split(","),d}},this.getExtKeyUsageBin=function(a){if(void 0===a){var b=this.getExtInfo("keyUsage");if(void 0===b)return"";a=f(this.hex,b.vidx)}if(8!=a.length&&10!=a.length)throw Error("malformed key usage value: "+a);var c="000000000000000"+parseInt(a.substr(6),16).toString(2);return 8==a.length&&(c=c.slice(-8)),10==a.length&&(c=c.slice(-16)),""==(c=c.replace(/0+$/,""))&&(c="0"),c},this.getExtKeyUsageString=function(a){for(var b=this.getExtKeyUsageBin(a),c=[],d=0;d<b.length;d++)"1"==b.substr(d,1)&&c.push(bU.KEYUSAGE_NAME[d]);return c.join(",")},this.getExtSubjectKeyIdentifier=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectKeyIdentifier");if(void 0===c)return;a=f(this.hex,c.vidx),b=c.critical}var e={extname:"subjectKeyIdentifier"};return b&&(e.critical=!0),e.kid={hex:d(a,0)},e},this.getExtAuthorityKeyIdentifier=function(a,b){if(void 0===a&&void 0===b){var e=this.getExtInfo("authorityKeyIdentifier");if(void 0===e)return;a=f(this.hex,e.vidx),b=e.critical}var g={extname:"authorityKeyIdentifier"};b&&(g.critical=!0);for(var h=c(a,0),i=0;i<h.length;i++){var j=a.substr(h[i],2);if("80"===j&&(g.kid={hex:d(a,h[i])}),"a1"===j){var k=f(a,h[i]);g.issuer=this.getGeneralNames(k)[0].dn}"82"===j&&(g.sn={hex:d(a,h[i])})}return g},this.getExtExtKeyUsage=function(a,b){if(void 0===a&&void 0===b){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return;a=f(this.hex,e.vidx),b=e.critical}var g={extname:"extKeyUsage",array:[]};b&&(g.critical=!0);for(var h=c(a,0),i=0;i<h.length;i++)g.array.push(p(d(a,h[i])));return g},this.getExtExtKeyUsageName=function(){var a=this.getExtInfo("extKeyUsage");if(void 0===a)return a;var b=[],e=f(this.hex,a.vidx);if(""===e)return b;for(var g=c(e,0),h=0;h<g.length;h++)b.push(p(d(e,g[h])));return b},this.getExtSubjectAltName=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectAltName");if(void 0===c)return;a=f(this.hex,c.vidx),b=c.critical}var d={extname:"subjectAltName",array:[]};return b&&(d.critical=!0),d.array=this.getGeneralNames(a),d},this.getExtIssuerAltName=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("issuerAltName");if(void 0===c)return;a=f(this.hex,c.vidx),b=c.critical}var d={extname:"issuerAltName",array:[]};return b&&(d.critical=!0),d.array=this.getGeneralNames(a),d},this.getGeneralNames=function(a){for(var b=c(a,0),d=[],e=0;e<b.length;e++){var g=this.getGeneralName(f(a,b[e]));void 0!==g&&d.push(g)}return d},this.getGeneralName=function(a){var b=a.substr(0,2),c=d(a,0),e=bj(c);return"81"==b?{rfc822:e}:"82"==b?{dns:e}:"86"==b?{uri:e}:"87"==b?{ip:bw(c)}:"a4"==b?{dn:this.getX500Name(c)}:"a0"==b?{other:this.getOtherName(a)}:void 0},this.getExtSubjectAltName2=function(){var a,b,e,g=this.getExtInfo("subjectAltName");if(void 0===g)return g;for(var h=[],i=f(this.hex,g.vidx),j=c(i,0),k=0;k<j.length;k++)e=i.substr(j[k],2),a=d(i,j[k]),"81"===e&&h.push(["MAIL",b=bi(a)]),"82"===e&&h.push(["DNS",b=bi(a)]),"84"===e&&h.push(["DN",b=bU.hex2dn(a,0)]),"86"===e&&h.push(["URI",b=bi(a)]),"87"===e&&h.push(["IP",b=bw(a)]);return h},this.getExtCRLDistributionPoints=function(a,b){if(void 0===a&&void 0===b){var d=this.getExtInfo("cRLDistributionPoints");if(void 0===d)return;a=f(this.hex,d.vidx),b=d.critical}var e={extname:"cRLDistributionPoints",array:[]};b&&(e.critical=!0);for(var g=c(a,0),h=0;h<g.length;h++){var i=f(a,g[h]);e.array.push(this.getDistributionPoint(i))}return e},this.getDistributionPoint=function(a){for(var b={},d=c(a,0),e=0;e<d.length;e++){var g=a.substr(d[e],2),h=f(a,d[e]);"a0"==g&&(b.dpname=this.getDistributionPointName(h))}return b},this.getDistributionPointName=function(a){for(var b={},d=c(a,0),e=0;e<d.length;e++){var g=a.substr(d[e],2),h=f(a,d[e]);"a0"==g&&(b.full=this.getGeneralNames(h))}return b},this.getExtCRLDistributionPointsURI=function(){var a=this.getExtCRLDistributionPoints();if(void 0==a)return a;for(var b=a.array,c=[],d=0;d<b.length;d++)try{void 0!=b[d].dpname.full[0].uri&&c.push(b[d].dpname.full[0].uri)}catch(a){}return c},this.getExtAIAInfo=function(){var a=this.getExtInfo("authorityInfoAccess");if(void 0===a)return a;for(var b={ocsp:[],caissuer:[]},d=c(this.hex,a.vidx),e=0;e<d.length;e++){var f=g(this.hex,d[e],[0],"06"),h=g(this.hex,d[e],[1],"86");"2b06010505073001"===f&&b.ocsp.push(bi(h)),"2b06010505073002"===f&&b.caissuer.push(bi(h))}return b},this.getExtAuthorityInfoAccess=function(a,b){if(void 0===a&&void 0===b){var d=this.getExtInfo("authorityInfoAccess");if(void 0===d)return;a=f(this.hex,d.vidx),b=d.critical}var e={extname:"authorityInfoAccess",array:[]};b&&(e.critical=!0);for(var i=c(a,0),j=0;j<i.length;j++){var k=h(a,i[j],[0],"06"),l=bi(g(a,i[j],[1],"86"));if("2b06010505073001"==k)e.array.push({ocsp:l});else if("2b06010505073002"==k)e.array.push({caissuer:l});else throw Error("unknown method: "+k)}return e},this.getExtCertificatePolicies=function(a,b){if(void 0===a&&void 0===b){var d=this.getExtInfo("certificatePolicies");if(void 0===d)return;a=f(this.hex,d.vidx),b=d.critical}var e={extname:"certificatePolicies",array:[]};b&&(e.critical=!0);for(var g=c(a,0),h=0;h<g.length;h++){var i=f(a,g[h]),j=this.getPolicyInformation(i);e.array.push(j)}return e},this.getPolicyInformation=function(a){var b={};b.policyoid=p(g(a,0,[0],"06"));var d=l(a,0,[1],"30");if(-1!=d){b.array=[];for(var e=c(a,d),h=0;h<e.length;h++){var i=f(a,e[h]),j=this.getPolicyQualifierInfo(i);b.array.push(j)}}return b},this.getOtherName=function(a){var b={},d=c(a,0),f=g(a,d[0],[],"06"),h=g(a,d[1],[]);return b.oid=p(f),b.value=e(h),b},this.getPolicyQualifierInfo=function(a){var b={},c=g(a,0,[0],"06");if("2b06010505070201"===c)b.cps=bj(h(a,0,[1],"16"));else if("2b06010505070202"===c){var d=i(a,0,[1],"30");b.unotice=this.getUserNotice(d)}return b},this.getUserNotice=function(a){var b=null;try{return b=a8.parse(a),this._asn1ToUnotice(b)}catch(a){return}},this._asn1ToUnotice=function(a){try{for(var b={},c=bO(a,"seq"),d=0;d<c.length;d++){var e=this._asn1ToNoticeRef(c[d]);void 0!=e&&(b.noticeref=e);var f=this.asn1ToDisplayText(c[d]);void 0!=f&&(b.exptext=f)}if(Object.keys(b).length>0)return b;return}catch(a){return}},this._asn1ToNoticeRef=function(a){try{for(var b={},c=bO(a,"seq"),d=0;d<c.length;d++){var e=this._asn1ToNoticeNum(c[d]);void 0!=e&&(b.noticenum=e);var f=this.asn1ToDisplayText(c[d]);void 0!=f&&(b.org=f)}if(Object.keys(b).length>0)return b;return}catch(a){return}},this._asn1ToNoticeNum=function(a){try{for(var b=bO(a,"seq"),c=[],d=0;d<b.length;d++){var e=b[d];c.push(parseInt(bO(e,"int.hex"),16))}return c}catch(a){return}},this.getDisplayText=function(a){var b={};return b.type=({"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"})[a.substr(0,2)],b.str=bj(d(a,0)),b},this.asn1ToDisplayText=function(a){return void 0!=a.utf8str?{type:"utf8",str:a.utf8str.str}:void 0!=a.ia5str?{type:"ia5",str:a.ia5str.str}:void 0!=a.visstr?{type:"vis",str:a.visstr.str}:void 0!=a.bmpstr?{type:"bmp",str:a.bmpstr.str}:void 0!=a.prnstr?{type:"prn",str:a.prnstr.str}:void 0},this.getExtPolicyMappings=function(a,b){var c=this.getCriticalExtV("policyMappings",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"policyMappings"};b&&(d.critical=!0);try{for(var f=e(a).seq,g=[],h=0;h<f.length;h++){var i=f[h].seq;g.push([i[0].oid,i[1].oid])}d.array=g}catch(a){throw new r("malformed policyMappings")}return d}},this.getExtPolicyConstraints=function(a,b){var c=this.getCriticalExtV("policyConstraints",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"policyConstraints"};b&&(d.critical=!0);var f=e(a);try{for(var g=f.seq,h=0;h<g.length;h++){var i=g[h].tag;!1==i.explicit&&("80"==i.tag&&(d.reqexp=parseInt(i.hex,16)),"81"==i.tag&&(d.inhibit=parseInt(i.hex,16)))}}catch(a){return new r("malformed policyConstraints value")}return d}},this.getExtInhibitAnyPolicy=function(a,b){var c=this.getCriticalExtV("inhibitAnyPolicy",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"inhibitAnyPolicy"};b&&(d.critical=!0);var e=o(a,0);return -1==e?new r("wrong value"):(d.skip=e,d)}},this.getExtCRLNumber=function(a,b){var c={extname:"cRLNumber"};if(b&&(c.critical=!0),"02"==a.substr(0,2))return c.num={hex:d(a,0)},c;throw new r("hExtV parse error: "+a)},this.getExtCRLReason=function(a,b){var c={extname:"cRLReason"};if(b&&(c.critical=!0),"0a"==a.substr(0,2))return c.code=parseInt(d(a,0),16),c;throw Error("hExtV parse error: "+a)},this.getExtOcspNonce=function(a,b){var c={extname:"ocspNonce"};return b&&(c.critical=!0),c.hex=d(a,0),c},this.getExtOcspNoCheck=function(a,b){var c={extname:"ocspNoCheck"};return b&&(c.critical=!0),c},this.getExtAdobeTimeStamp=function(a,b){if(void 0===a&&void 0===b){var d=this.getExtInfo("adobeTimeStamp");if(void 0===d)return;a=f(this.hex,d.vidx),b=d.critical}var e={extname:"adobeTimeStamp"};b&&(e.critical=!0);var g=c(a,0);if(g.length>1){var h=f(a,g[1]),i=this.getGeneralName(h);void 0!=i.uri&&(e.uri=i.uri)}if(g.length>2){var j=f(a,g[2]);"0101ff"==j&&(e.reqauth=!0),"010100"==j&&(e.reqauth=!1)}return e},this.getExtSubjectDirectoryAttributes=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectDirectoryAttributes");if(void 0===c)return;a=f(this.hex,c.vidx),b=c.critical}var d={extname:"subjectDirectoryAttributes"};b&&(d.critical=!0);try{for(var g=e(a),h=[],i=0;i<g.seq.length;i++){var j=g.seq[i],k=bO(j,"seq.0.oid"),l=bO(j,"seq.1.set");if(void 0==k||void 0==l)throw"error";h.push({attr:k,array:l})}return d.array=h,d}catch(a){throw Error("malformed subjectDirectoryAttributes extension value")}};var s=function(a){var b={};try{var c=a.seq[0].oid,d=m.asn1.x509.OID.name2oid(c);b.type=m.asn1.x509.OID.oid2atype(d);var e=a.seq[1];if(void 0!=e.utf8str)b.ds="utf8",b.value=e.utf8str.str;else if(void 0!=e.numstr)b.ds="num",b.value=e.numstr.str;else if(void 0!=e.telstr)b.ds="tel",b.value=e.telstr.str;else if(void 0!=e.prnstr)b.ds="prn",b.value=e.prnstr.str;else if(void 0!=e.ia5str)b.ds="ia5",b.value=e.ia5str.str;else if(void 0!=e.visstr)b.ds="vis",b.value=e.visstr.str;else if(void 0!=e.bmpstr)b.ds="bmp",b.value=e.bmpstr.str;else throw"error";return b}catch(a){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},t=function(a){try{return a.set.map(function(a){return s(a)})}catch(a){throw Error("improper ASN.1 parsed RDN: "+a)}},u=function(a){try{return a.seq.map(function(a){return t(a)})}catch(a){throw Error("improper ASN.1 parsed X500Name: "+a)}};this.getX500NameRule=function(a){for(var b=null,c=[],d=0;d<a.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(e[f]);for(var d=0;d<c.length;d++){var g=c[d],h=g.ds,i=g.value,j=g.type;if("prn"!=h&&"utf8"!=h&&"ia5"!=h)return"mixed";if("ia5"==h)if("CN"!=j)return"mixed";else if(!m.lang.String.isMail(i))return"mixed";else continue;if("C"==j)if("prn"==h)continue;else return"mixed";if(null==b)b=h;else if(b!==h)return"mixed"}return null==b?"prn":b},this.getAttrTypeAndValue=function(a){return s(e(a))},this.getRDN=function(a){return t(e(a))},this.getX500NameArray=function(a){return u(e(a))},this.getX500Name=function(a,b,c){var d=this.getX500NameArray(a),e={str:this.dnarraytostr(d)};return e.array=d,!0==c&&(e.hex=a),!0==b&&(e.canon=this.c14nRDNArray(d)),e},this.readCertPEM=function(a){this.readCertHex(bo(a))},this.readCertHex=function(a){this.hex=a,this.getVersion();try{k(this.hex,0,[0,7],"a3"),this.parseExt()}catch(a){}},this.getParam=function(a){var b={};return void 0==a&&(a={}),b.version=this.getVersion(),b.serial={hex:this.getSerialNumberHex()},b.sigalg=this.getSignatureAlgorithmField(),b.issuer=this.getIssuer(a.dncanon,a.dnhex),b.notbefore=this.getNotBefore(),b.notafter=this.getNotAfter(),b.subject=this.getSubject(a.dncanon,a.dnhex),b.sbjpubkey=bn(this.getPublicKeyHex(),"PUBLIC KEY"),void 0!=this.aExtInfo&&this.aExtInfo.length>0&&(b.ext=this.getExtParamArray()),b.sighex=this.getSignatureValueHex(),!0==a.tbshex&&(b.tbshex=i(this.hex,0,[0])),!0==a.nodnarray&&(delete b.issuer.array,delete b.subject.array),b},this.getExtParamArray=function(a){void 0==a&&-1!=l(this.hex,0,[0,"[3]"])&&(a=j(this.hex,0,[0,"[3]",0],"30"));for(var b=[],d=c(a,0),e=0;e<d.length;e++){var g=f(a,d[e]),h=this.getExtParam(g);null!=h&&b.push(h)}return b},this.getExtParam=function(a){var b=c(a,0).length;if(2!=b&&3!=b)throw Error("wrong number elements in Extension: "+b+" "+a);var d=q(g(a,0,[0],"06")),f=!1;3==b&&"0101ff"==i(a,0,[1])&&(f=!0);var h=i(a,0,[b-1,0]),j=void 0;if("2.5.29.14"==d?j=this.getExtSubjectKeyIdentifier(h,f):"2.5.29.15"==d?j=this.getExtKeyUsage(h,f):"2.5.29.17"==d?j=this.getExtSubjectAltName(h,f):"2.5.29.18"==d?j=this.getExtIssuerAltName(h,f):"2.5.29.19"==d?j=this.getExtBasicConstraints(h,f):"2.5.29.30"==d?j=this.getExtNameConstraints(h,f):"2.5.29.31"==d?j=this.getExtCRLDistributionPoints(h,f):"2.5.29.32"==d?j=this.getExtCertificatePolicies(h,f):"2.5.29.33"==d?j=this.getExtPolicyMappings(h,f):"2.5.29.35"==d?j=this.getExtAuthorityKeyIdentifier(h,f):"2.5.29.36"==d?j=this.getExtPolicyConstraints(h,f):"2.5.29.37"==d?j=this.getExtExtKeyUsage(h,f):"2.5.29.54"==d?j=this.getExtInhibitAnyPolicy(h,f):"1.3.6.1.5.5.7.1.1"==d?j=this.getExtAuthorityInfoAccess(h,f):"2.5.29.20"==d?j=this.getExtCRLNumber(h,f):"2.5.29.21"==d?j=this.getExtCRLReason(h,f):"2.5.29.9"==d?j=this.getExtSubjectDirectoryAttributes(h,f):"1.3.6.1.5.5.7.48.1.2"==d?j=this.getExtOcspNonce(h,f):"1.3.6.1.5.5.7.48.1.5"==d?j=this.getExtOcspNoCheck(h,f):"1.2.840.113583.1.1.9.1"==d?j=this.getExtAdobeTimeStamp(h,f):void 0!=bU.EXT_PARSER[d]&&(j=bU.EXT_PARSER[d](d,f,h)),void 0!=j)return j;var k={extname:d,extn:h};try{k.extn=e(h)}catch(a){}return f&&(k.critical=!0),k},this.findExt=function(a,b){for(var c=0;c<a.length;c++)if(a[c].extname==b)return a[c];return null},this.updateExtCDPFullURI=function(a,b){var c=this.findExt(a,"cRLDistributionPoints");if(null!=c&&void 0!=c.array){for(var d=c.array,e=0;e<d.length;e++)if(void 0!=d[e].dpname&&void 0!=d[e].dpname.full)for(var f=d[e].dpname.full,g=0;g<f.length;g++){var h=f[e];void 0!=h.uri&&(h.uri=b)}}},this.updateExtAIAOCSP=function(a,b){var c=this.findExt(a,"authorityInfoAccess");if(null!=c&&void 0!=c.array)for(var d=c.array,e=0;e<d.length;e++)void 0!=d[e].ocsp&&(d[e].ocsp=b)},this.updateExtAIACAIssuer=function(a,b){var c=this.findExt(a,"authorityInfoAccess");if(null!=c&&void 0!=c.array)for(var d=c.array,e=0;e<d.length;e++)void 0!=d[e].caissuer&&(d[e].caissuer=b)},this.dnarraytostr=function(a){return"/"+a.map(function(a){return a.map(function(a){var b;return((b=a).type+"="+b.value).replace(/\+/,"\\+")}).join("+").replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(a){var b;if(void 0!=a.str&&void 0==a.array){var c=new m.asn1.x509.X500Name({str:a.str}).tohex();b=this.getX500NameArray(c)}else b=a.array;void 0==a.canon&&(a.canon=this.c14nRDNArray(b))},this.c14nRDNArray=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=[],f=0;f<d.length;f++){var g=d[f],h=g.value;h=(h=(h=(h=h.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),e.push(g.type.toLowerCase()+"="+h)}b.push(e.join("+"))}return"/"+b.join("/")},this.getInfo=function(){var a,b,c;if(a="Basic Fields\n  serial number: "+this.getSerialNumberHex()+"\n"+("  signature algorithm: "+this.getSignatureAlgorithmField())+"\n"+("  issuer: "+this.getIssuerString())+"\n"+("  notBefore: "+this.getNotBefore())+"\n"+("  notAfter: "+this.getNotAfter())+"\n"+("  subject: "+this.getSubjectString())+"\n  subject public key info: \n"+("    key algorithm: "+(b=this.getPublicKey()).type+"\n"),"RSA"===b.type&&(a+="    n="+bE(b.n.toString(16)).substr(0,16)+"...\n",a+="    e="+bE(b.e.toString(16))+"\n"),null!=(c=this.aExtInfo)){a+="X509v3 Extensions:\n";for(var d=0;d<c.length;d++){var e=c[d],f=m.asn1.x509.OID.oid2name(e.oid);""===f&&(f=e.oid);var g="";if(!0===e.critical&&(g="CRITICAL"),a+="  "+f+" "+g+":\n","basicConstraints"===f){var h=this.getExtBasicConstraints();void 0===h.cA?a+="    {}\n":(a+="    cA=true",void 0!==h.pathLen&&(a+=", pathLen="+h.pathLen),a+="\n")}else if("policyMappings"==f)a+="    "+this.getExtPolicyMappings().array.map(function(a){return a[0]+":"+a[1]}).join(", ")+"\n";else if("policyConstraints"==f){var i=this.getExtPolicyConstraints();a+="    ",void 0!=i.reqexp&&(a+=" reqexp="+i.reqexp),void 0!=i.inhibit&&(a+=" inhibit="+i.inhibit),a+="\n"}else if("inhibitAnyPolicy"==f){var i=this.getExtInhibitAnyPolicy();a+="    skip="+i.skip+"\n"}else if("keyUsage"==f)a+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"==f)a+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"==f){var j=this.getExtAuthorityKeyIdentifier();void 0!==j.kid&&(a+="    kid="+j.kid.hex+"\n")}else"extKeyUsage"==f?a+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"==f?a+=function(a){for(var b="",c="    ",d=a.array,e=0;e<d.length;e++){var f=d[e];void 0!=f.dn&&(b+=c+"dn: "+f.dn.str+"\n"),void 0!=f.ip&&(b+=c+"ip: "+f.ip+"\n"),void 0!=f.rfc822&&(b+=c+"rfc822: "+f.rfc822+"\n"),void 0!=f.dns&&(b+=c+"dns: "+f.dns+"\n"),void 0!=f.uri&&(b+=c+"uri: "+f.uri+"\n"),void 0!=f.other&&(b+=c+"other: "+f.other.oid+"="+JSON.stringify(f.other.value).replace(/\"/g,"")+"\n")}return b.replace(/\n$/,"")}(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"==f?a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];try{void 0!==e.dpname.full[0].uri&&(b+="    "+e.dpname.full[0].uri+"\n")}catch(a){}try{void 0!==e.dname.full[0].dn.hex&&(b+="    "+bU.hex2dn(e.dpname.full[0].dn.hex)+"\n")}catch(a){}}return b}(this.getExtCRLDistributionPoints()):"authorityInfoAccess"==f?a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];void 0!==e.caissuer&&(b+="    caissuer: "+e.caissuer+"\n"),void 0!==e.ocsp&&(b+="    ocsp: "+e.ocsp+"\n")}return b}(this.getExtAuthorityInfoAccess()):"certificatePolicies"==f&&(a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];if(b+="    policy oid: "+e.policyoid+"\n",void 0!==e.array)for(var f=0;f<e.array.length;f++){var g=e.array[f];void 0!==g.cps&&(b+="    cps: "+g.cps+"\n")}}return b}(this.getExtCertificatePolicies()))}}return a+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",a+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?this.readCertPEM(a):m.lang.String.isHex(a)&&this.readCertHex(a))}bQ.getKey=function(a,b,c){var d=a8,e=d.getChildIdx,f=(d.getV,d.getVbyList),g=m.crypto,h=g.ECDSA,i=g.DSA,j=bo;if(a instanceof a3||void 0!==h&&a instanceof h||void 0!==i&&a instanceof i)return a;if(void 0!==a.curve&&void 0!==a.xy&&void 0===a.d)return new h({pub:a.xy,curve:a.curve});if(void 0!==a.curve&&void 0!==a.d)return new h({prv:a.d,curve:a.curve});if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0===a.d){var k=new a3;return k.setPublic(a.n,a.e),k}if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0!==a.p&&void 0!==a.q&&void 0!==a.dp&&void 0!==a.dq&&void 0!==a.co&&void 0===a.qi){var k=new a3;return k.setPrivateEx(a.n,a.e,a.d,a.p,a.q,a.dp,a.dq,a.co),k}if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0===a.p){var k=new a3;return k.setPrivate(a.n,a.e,a.d),k}if(void 0!==a.p&&void 0!==a.q&&void 0!==a.g&&void 0!==a.y&&void 0===a.x){var k=new i;return k.setPublic(a.p,a.q,a.g,a.y),k}if(void 0!==a.p&&void 0!==a.q&&void 0!==a.g&&void 0!==a.y&&void 0!==a.x){var k=new i;return k.setPrivate(a.p,a.q,a.g,a.y,a.x),k}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0===a.d){var k=new a3;return k.setPublic(bg(a.n),bg(a.e)),k}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0!==a.p&&void 0!==a.q&&void 0!==a.dp&&void 0!==a.dq&&void 0!==a.qi){var k=new a3;return k.setPrivateEx(bg(a.n),bg(a.e),bg(a.d),bg(a.p),bg(a.q),bg(a.dp),bg(a.dq),bg(a.qi)),k}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d){var k=new a3;return k.setPrivate(bg(a.n),bg(a.e),bg(a.d)),k}if("EC"===a.kty&&void 0!==a.crv&&void 0!==a.x&&void 0!==a.y&&void 0===a.d){var l=new h({curve:a.crv}),n=l.ecparams.keycharlen,o=("0000000000"+bg(a.x)).slice(-n),p=("0000000000"+bg(a.y)).slice(-n),q="04"+o+p;return l.setPublicKeyHex(q),l}if("EC"===a.kty&&void 0!==a.crv&&void 0!==a.x&&void 0!==a.y&&void 0!==a.d){var l=new h({curve:a.crv}),n=l.ecparams.keycharlen,o=("0000000000"+bg(a.x)).slice(-n),p=("0000000000"+bg(a.y)).slice(-n),q="04"+o+p,r=("0000000000"+bg(a.d)).slice(-n);return l.setPublicKeyHex(q),l.setPrivateKeyHex(r),l}if("pkcs5prv"===c){var s,k,d=a8;if(9===(s=e(a,0)).length)(k=new a3).readPKCS5PrvKeyHex(a);else if(6===s.length)(k=new i).readPKCS5PrvKeyHex(a);else if(s.length>2&&"04"===a.substr(s[1],2))(k=new h).readPKCS5PrvKeyHex(a);else throw Error("unsupported PKCS#1/5 hexadecimal key");return k}if("pkcs8prv"===c){var k=bQ.getKeyFromPlainPrivatePKCS8Hex(a);return k}if("pkcs8pub"===c)return bQ._getKeyFromPublicPKCS8Hex(a);if("x509pub"===c)return bU.getPublicKeyFromCertHex(a);if(-1!=a.indexOf("-END CERTIFICATE-",0)||-1!=a.indexOf("-END X509 CERTIFICATE-",0)||-1!=a.indexOf("-END TRUSTED CERTIFICATE-",0))return bU.getPublicKeyFromCertPEM(a);if(-1!=a.indexOf("-END PUBLIC KEY-")){var t=bo(a,"PUBLIC KEY");return bQ._getKeyFromPublicPKCS8Hex(t)}if(-1!=a.indexOf("-END RSA PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var u=j(a,"RSA PRIVATE KEY");return bQ.getKey(u,null,"pkcs5prv")}if(-1!=a.indexOf("-END DSA PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var v=j(a,"DSA PRIVATE KEY"),x=f(v,0,[1],"02"),y=f(v,0,[2],"02"),z=f(v,0,[3],"02"),A=f(v,0,[4],"02"),B=f(v,0,[5],"02"),k=new i;return k.setPrivate(new w(x,16),new w(y,16),new w(z,16),new w(A,16),new w(B,16)),k}if(-1!=a.indexOf("-END EC PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var u=j(a,"EC PRIVATE KEY");return bQ.getKey(u,null,"pkcs5prv")}if(-1!=a.indexOf("-END PRIVATE KEY-"))return bQ.getKeyFromPlainPrivatePKCS8PEM(a);if(-1!=a.indexOf("-END RSA PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var C=bQ.getDecryptedKeyHex(a,b),D=new a3;return D.readPKCS5PrvKeyHex(C),D}if(-1!=a.indexOf("-END EC PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var v=bQ.getDecryptedKeyHex(a,b),k=f(v,0,[1],"04"),E=f(v,0,[2,0],"06"),F=f(v,0,[3,0],"03").substr(2),G="";if(void 0!==m.crypto.OID.oidhex2name[E])G=m.crypto.OID.oidhex2name[E];else throw Error("undefined OID(hex) in KJUR.crypto.OID: "+E);var l=new h({curve:G});return l.setPublicKeyHex(F),l.setPrivateKeyHex(k),l.isPublic=!1,l}if(-1!=a.indexOf("-END DSA PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var v=bQ.getDecryptedKeyHex(a,b),x=f(v,0,[1],"02"),y=f(v,0,[2],"02"),z=f(v,0,[3],"02"),A=f(v,0,[4],"02"),B=f(v,0,[5],"02"),k=new i;return k.setPrivate(new w(x,16),new w(y,16),new w(z,16),new w(A,16),new w(B,16)),k}if(-1!=a.indexOf("-END ENCRYPTED PRIVATE KEY-"))return bQ.getKeyFromEncryptedPKCS8PEM(a,b);throw Error("not supported argument")},bQ.generateKeypair=function(a,b){if("RSA"==a){var c=new a3;c.generate(b,"10001"),c.isPrivate=!0,c.isPublic=!0;var d=new a3,e=c.n.toString(16),f=c.e.toString(16);d.setPublic(e,f),d.isPrivate=!1,d.isPublic=!0;var g={};return g.prvKeyObj=c,g.pubKeyObj=d,g}if("EC"==a){var h=new m.crypto.ECDSA({curve:b}).generateKeyPairHex(),c=new m.crypto.ECDSA({curve:b});c.setPublicKeyHex(h.ecpubhex),c.setPrivateKeyHex(h.ecprvhex),c.isPrivate=!0,c.isPublic=!1;var d=new m.crypto.ECDSA({curve:b});d.setPublicKeyHex(h.ecpubhex),d.isPrivate=!1,d.isPublic=!0;var g={};return g.prvKeyObj=c,g.pubKeyObj=d,g}throw Error("unknown algorithm: "+a)},bQ.getPEM=function(a,b,c,d,e,f){var g=m,h=g.asn1,i=h.DERObjectIdentifier,j=h.DERInteger,k=h.ASN1Util.newObject,l=h.x509.SubjectPublicKeyInfo,n=g.crypto,o=n.DSA,p=n.ECDSA;function q(a){return k({seq:[{int:0},{int:{bigint:a.n}},{int:a.e},{int:{bigint:a.d}},{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.dmp1}},{int:{bigint:a.dmq1}},{int:{bigint:a.coeff}}]})}function r(a){return k({seq:[{int:1},{octstr:{hex:a.prvKeyHex}},{tag:["a0",!0,{oid:{name:a.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]}]})}function s(a){return k({seq:[{int:0},{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}},{int:{bigint:a.y}},{int:{bigint:a.x}}]})}if((void 0!==a3&&a instanceof a3||void 0!==o&&a instanceof o||void 0!==p&&a instanceof p)&&!0==a.isPublic&&(void 0===b||"PKCS8PUB"==b)){var t=new l(a),u=t.tohex();return bn(u,"PUBLIC KEY")}if("PKCS1PRV"==b&&void 0!==a3&&a instanceof a3&&(void 0===c||null==c)&&!0==a.isPrivate){var t=q(a),u=t.tohex();return bn(u,"RSA PRIVATE KEY")}if("PKCS1PRV"==b&&void 0!==p&&a instanceof p&&(void 0===c||null==c)&&!0==a.isPrivate){var v=new i({name:a.curveName}).tohex(),w=r(a).tohex(),x="";return x+=bn(v,"EC PARAMETERS"),x+=bn(w,"EC PRIVATE KEY")}if("PKCS1PRV"==b&&void 0!==o&&a instanceof o&&(void 0===c||null==c)&&!0==a.isPrivate){var t=s(a),u=t.tohex();return bn(u,"DSA PRIVATE KEY")}if("PKCS5PRV"==b&&void 0!==a3&&a instanceof a3&&void 0!==c&&null!=c&&!0==a.isPrivate){var t=q(a),u=t.tohex();return void 0===d&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",u,c,d,f)}if("PKCS5PRV"==b&&void 0!==p&&a instanceof p&&void 0!==c&&null!=c&&!0==a.isPrivate){var t=r(a),u=t.tohex();return void 0===d&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",u,c,d,f)}if("PKCS5PRV"==b&&void 0!==o&&a instanceof o&&void 0!==c&&null!=c&&!0==a.isPrivate){var t=s(a),u=t.tohex();return void 0===d&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",u,c,d,f)}var y=function(a,b){if("string"==typeof b)return bQ.getEncryptedPKCS8PEM(a,b);if("object"==typeof b&&void 0!=bO(b,"passcode")){var c=JSON.parse(JSON.stringify(b)),d=c.passcode;return delete c.passcode,bQ.getEncryptedPKCS8PEM(a,d,c)}};if("PKCS8PRV"==b&&void 0!=a3&&a instanceof a3&&!0==a.isPrivate){var z=q(a),A=z.tohex(),t=k({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===c||null==c?bn(u,"PRIVATE KEY"):y(u,c)}if("PKCS8PRV"==b&&void 0!==p&&a instanceof p&&!0==a.isPrivate){var B={seq:[{int:1},{octstr:{hex:a.prvKeyHex}}]};"string"==typeof a.pubKeyHex&&B.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]});var z=new k(B),A=z.tohex(),t=k({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:a.curveName}}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===c||null==c?bn(u,"PRIVATE KEY"):y(u,c)}if("PKCS8PRV"==b&&void 0!==o&&a instanceof o&&!0==a.isPrivate){var z=new j({bigint:a.x}),A=z.tohex(),t=k({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===c||null==c?bn(u,"PRIVATE KEY"):y(u,c)}throw Error("unsupported object nor format")},bQ.getKeyFromCSRPEM=function(a){var b=bo(a,"CERTIFICATE REQUEST");return bQ.getKeyFromCSRHex(b)},bQ.getKeyFromCSRHex=function(a){var b=bQ.parseCSRHex(a);return bQ.getKey(b.p8pubkeyhex,null,"pkcs8pub")},bQ.parseCSRHex=function(a){var b=a8.getChildIdx,c=a8.getTLV,d={};if("30"!=a.substr(0,2))throw Error("malformed CSR(code:001)");var e=b(a,0);if(e.length<1)throw Error("malformed CSR(code:002)");if("30"!=a.substr(e[0],2))throw Error("malformed CSR(code:003)");var f=b(a,e[0]);if(f.length<3)throw Error("malformed CSR(code:004)");return d.p8pubkeyhex=c(a,f[2]),d},bQ.getKeyID=function(a){"string"==typeof a&&-1!=a.indexOf("BEGIN ")&&(a=bQ.getKey(a));var b=bo(bQ.getPEM(a)),c=a8.getIdxbyList(b,0,[1]),d=a8.getV(b,c).substring(2);return m.crypto.Util.hashHex(d,"sha1")},bQ.getJWK=function(a,b,c,d,e){var f,g,h={},i=m.crypto.Util.hashHex;if("string"==typeof a)f=bQ.getKey(a),-1!=a.indexOf("CERTIFICATE")&&(g=bo(a));else if("object"==typeof a)a instanceof bU?(f=a.getPublicKey(),g=a.hex):f=a;else throw Error("unsupported keyinfo type");if(f instanceof a3&&f.isPrivate)h.kty="RSA",h.n=bf(f.n.toString(16)),h.e=bf(f.e.toString(16)),h.d=bf(f.d.toString(16)),h.p=bf(f.p.toString(16)),h.q=bf(f.q.toString(16)),h.dp=bf(f.dmp1.toString(16)),h.dq=bf(f.dmq1.toString(16)),h.qi=bf(f.coeff.toString(16));else if(f instanceof a3&&f.isPublic)h.kty="RSA",h.n=bf(f.n.toString(16)),h.e=bf(f.e.toString(16));else if(f instanceof m.crypto.ECDSA&&f.isPrivate){var j=f.getShortNISTPCurveName();if("P-256"!==j&&"P-384"!==j&&"P-521"!==j)throw Error("unsupported curve name for JWT: "+j);var k=f.getPublicKeyXYHex();h.kty="EC",h.crv=j,h.x=bf(k.x),h.y=bf(k.y),h.d=bf(f.prvKeyHex)}else if(f instanceof m.crypto.ECDSA&&f.isPublic){var j=f.getShortNISTPCurveName();if("P-256"!==j&&"P-384"!==j&&"P-521"!==j)throw Error("unsupported curve name for JWT: "+j);var k=f.getPublicKeyXYHex();h.kty="EC",h.crv=j,h.x=bf(k.x),h.y=bf(k.y)}if(void 0==h.kty)throw Error("unsupported keyinfo");return f.isPrivate||!0==b||(h.kid=m.jws.JWS.getJWKthumbprint(h)),void 0!=g&&!0!=c&&(h.x5c=[t(g)]),void 0!=g&&!0!=d&&(h.x5t=bd(t(i(g,"sha1")))),void 0!=g&&!0!=e&&(h["x5t#S256"]=bd(t(i(g,"sha256")))),h},bQ.getJWKFromKey=function(a){return bQ.getJWK(a,!0,!0,!0,!0)},a3.getPosArrayOfChildrenFromHex=function(a){return a8.getChildIdx(a,0)},a3.getHexValueArrayOfChildrenFromHex=function(a){var b=a8.getV,c=a3.getPosArrayOfChildrenFromHex(a),d=b(a,c[0]),e=b(a,c[1]),f=b(a,c[2]),g=b(a,c[3]),h=b(a,c[4]),i=b(a,c[5]),j=b(a,c[6]),k=b(a,c[7]),l=b(a,c[8]),c=[];return c.push(d,e,f,g,h,i,j,k,l),c},a3.prototype.readPrivateKeyFromPEMString=function(a){var b=bo(a),c=a3.getHexValueArrayOfChildrenFromHex(b);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},a3.prototype.readPKCS5PrvKeyHex=function(a){var b=a3.getHexValueArrayOfChildrenFromHex(a);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])},a3.prototype.readPKCS8PrvKeyHex=function(a){var b,c,d,e,f,g,h,i,j=a8.getVbyListEx;if(!1===a8.isASN1HEX(a))throw Error("not ASN.1 hex string");try{b=j(a,0,[2,0,1],"02"),c=j(a,0,[2,0,2],"02"),d=j(a,0,[2,0,3],"02"),e=j(a,0,[2,0,4],"02"),f=j(a,0,[2,0,5],"02"),g=j(a,0,[2,0,6],"02"),h=j(a,0,[2,0,7],"02"),i=j(a,0,[2,0,8],"02")}catch(a){throw Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(b,c,d,e,f,g,h,i)},a3.prototype.readPKCS5PubKeyHex=function(a){var b=a8.getV;if(!1===a8.isASN1HEX(a))throw Error("keyHex is not ASN.1 hex string");var c=a8.getChildIdx(a,0);if(2!==c.length||"02"!==a.substr(c[0],2)||"02"!==a.substr(c[1],2))throw Error("wrong hex for PKCS#5 public key");var d=b(a,c[0]),e=b(a,c[1]);this.setPublic(d,e)},a3.prototype.readPKCS8PubKeyHex=function(a){if(!1===a8.isASN1HEX(a))throw Error("not ASN.1 hex string");if("06092a864886f70d010101"!==a8.getTLVbyListEx(a,0,[0,0]))throw Error("not PKCS8 RSA public key");var b=a8.getTLVbyListEx(a,0,[1,0]);this.readPKCS5PubKeyHex(b)},a3.prototype.readCertPubKeyHex=function(a,b){var c,d;(c=new bU).readCertHex(a),d=c.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)},RegExp("[^0-9a-f]","gi"),a3.prototype.sign=function(a,b){var c=m.crypto.Util.hashString(a,b);return this.signWithMessageHash(c,b)},a3.prototype.signWithMessageHash=function(a,b){var c=a2(m.crypto.Util.getPaddedDigestInfoHex(a,b,this.n.bitLength()),16);return bR(this.doPrivate(c).toString(16),this.n.bitLength())},a3.prototype.signPSS=function(a,b,c){var d,e=(d=bk(a),m.crypto.Util.hashHex(d,b));return void 0===c&&(c=-1),this.signWithMessageHashPSS(e,b,c)},a3.prototype.signWithMessageHashPSS=function(a,b,c){var d,e=bj(a),f=e.length,g=this.n.bitLength()-1,h=Math.ceil(g/8),i=function(a){return m.crypto.Util.hashHex(a,b)};if(-1===c||void 0===c)c=f;else if(-2===c)c=h-f-2;else if(c<-2)throw Error("invalid salt length");if(h<f+c+2)throw Error("data too long");var j="";c>0&&(j=Array(c),new a1().nextBytes(j),j=String.fromCharCode.apply(String,j));var k=bj(i(bk("\0\0\0\0\0\0\0\0"+e+j))),l=[];for(d=0;d<h-c-f-2;d+=1)l[d]=0;var n=String.fromCharCode.apply(String,l)+"\x01"+j,o=bS(k,n.length,i),p=[];for(d=0;d<n.length;d+=1)p[d]=n.charCodeAt(d)^o.charCodeAt(d);for(p[0]&=~(65280>>8*h-g&255),d=0;d<f;d++)p.push(k.charCodeAt(d));return p.push(188),bR(this.doPrivate(new w(p)).toString(16),this.n.bitLength())},a3.prototype.verify=function(a,b){if(null==(b=b.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var c=a2(b,16),d=this.n.bitLength();if(c.bitLength()>d)return!1;var e=this.doPublic(c).toString(16);if(e.length+3!=d/4)return!1;var f=bT(e.replace(/^1f+00/,""));if(0==f.length)return!1;var g=f[0];return f[1]==m.crypto.Util.hashString(a,g)},a3.prototype.verifyWithMessageHash=function(a,b){if(b.length!=Math.ceil(this.n.bitLength()/4))return!1;var c=a2(b,16);if(c.bitLength()>this.n.bitLength())return 0;var d=bT(this.doPublic(c).toString(16).replace(/^1f+00/,""));return 0!=d.length&&(d[0],d[1]==a)},a3.prototype.verifyPSS=function(a,b,c,d){var e,f=(e=bk(a),m.crypto.Util.hashHex(e,c));return void 0===d&&(d=-1),this.verifyWithMessageHashPSS(f,b,c,d)},a3.prototype.verifyWithMessageHashPSS=function(a,b,c,d){if(b.length!=Math.ceil(this.n.bitLength()/4))return!1;var e,f=new w(b,16),g=function(a){return m.crypto.Util.hashHex(a,c)},h=bj(a),i=h.length,j=this.n.bitLength()-1,k=Math.ceil(j/8);if(-1===d||void 0===d)d=i;else if(-2===d)d=k-i-2;else if(d<-2)throw Error("invalid salt length");if(k<i+d+2)throw Error("data too long");var l=this.doPublic(f).toByteArray();for(e=0;e<l.length;e+=1)l[e]&=255;for(;l.length<k;)l.unshift(0);if(188!==l[k-1])throw Error("encoded message does not end in 0xbc");var n=(l=String.fromCharCode.apply(String,l)).substr(0,k-i-1),o=l.substr(n.length,i),p=65280>>8*k-j&255;if((n.charCodeAt(0)&p)!=0)throw Error("bits beyond keysize not zero");var q=bS(o,n.length,g),r=[];for(e=0;e<n.length;e+=1)r[e]=n.charCodeAt(e)^q.charCodeAt(e);r[0]&=~p;var s=k-i-d-2;for(e=0;e<s;e+=1)if(0!==r[e])throw Error("leftmost octets not zero");if(1!==r[s])throw Error("0x01 marker not found");return o===bj(g(bk("\0\0\0\0\0\0\0\0"+h+String.fromCharCode.apply(String,r.slice(-d)))))},a3.SALT_LEN_HLEN=-1,a3.SALT_LEN_MAX=-2,a3.SALT_LEN_RECOVER=-2,bU.EXT_PARSER={},bU.registExtParser=function(a,b){bU.EXT_PARSER[a]=b},bU.hex2dn=function(a,b){void 0===b&&(b=0);var c=new bU;return a8.getTLV(a,b),c.getX500Name(a).str},bU.hex2rdn=function(a,b){if(void 0===b&&(b=0),"31"!==a.substr(b,2))throw Error("malformed RDN");for(var c=[],d=a8.getChildIdx(a,b),e=0;e<d.length;e++)c.push(bU.hex2attrTypeValue(a,d[e]));return(c=c.map(function(a){return a.replace("+","\\+")})).join("+")},bU.hex2attrTypeValue=function(a,b){var c=a8.getV;if(void 0===b&&(b=0),"30"!==a.substr(b,2))throw Error("malformed attribute type and value");var d=a8.getChildIdx(a,b);2!==d.length||a.substr(d[0],2);var e=c(a,d[0]),f=m.asn1.ASN1Util.oidHexToInt(e);return m.asn1.x509.OID.oid2atype(f)+"="+bj(c(a,d[1]))},bU.getPublicKeyFromCertHex=function(a){var b=new bU;return b.readCertHex(a),b.getPublicKey()},bU.getPublicKeyFromCertPEM=function(a){var b=new bU;return b.readCertPEM(a),b.getPublicKey()},bU.getPublicKeyInfoPropOfCertPEM=function(a){var b,c,d=a8.getVbyList,e={};return e.algparam=null,(b=new bU).readCertPEM(a),e.keyhex=d(c=b.getPublicKeyHex(),0,[1],"03").substr(2),e.algoid=d(c,0,[0,0],"06"),"2a8648ce3d0201"===e.algoid&&(e.algparam=d(c,0,[0,1],"06")),e},bU.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==m&&m||(m={}),void 0!==m.jws&&m.jws||(m.jws={}),m.jws.JWS=function(){var a=m.jws.JWS.isSafeJSONString;this.parseJWS=function(b,c){if(void 0===this.parsedJWS||!c&&void 0===this.parsedJWS.sigvalH){var d=b.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==d)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var e=d[1],f=d[2],g=d[3],h=e+"."+f;if(this.parsedJWS={},this.parsedJWS.headB64U=e,this.parsedJWS.payloadB64U=f,this.parsedJWS.sigvalB64U=g,this.parsedJWS.si=h,!c){var i=bg(g),j=a2(i,16);this.parsedJWS.sigvalH=i,this.parsedJWS.sigvalBI=j}var k=o(e),l=o(f);if(this.parsedJWS.headS=k,this.parsedJWS.payloadS=l,!a(k,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+k}}},m.jws.JWS.sign=function(a,b,c,d,e){var f,g,h,i=m,j=i.jws.JWS,k=j.readSafeJSONString,l=j.isSafeJSONString,o=i.crypto,p=(o.ECDSA,o.Mac),q=o.Signature,r=JSON;if("string"!=typeof b&&"object"!=typeof b)throw"spHeader must be JSON string or object: "+b;if("object"==typeof b&&(g=b,f=r.stringify(g)),"string"==typeof b){if(!l(f=b))throw"JWS Head is not safe JSON string: "+f;g=k(f)}if(h=c,"object"==typeof c&&(h=r.stringify(c)),(""==a||null==a)&&void 0!==g.alg&&(a=g.alg),""!=a&&null!=a&&void 0===g.alg&&(g.alg=a,f=r.stringify(g)),a!==g.alg)throw"alg and sHeader.alg doesn't match: "+a+"!="+g.alg;var s=null;if(void 0===j.jwsalg2sigalg[a])throw"unsupported alg name: "+a;s=j.jwsalg2sigalg[a];var t=n(f)+"."+n(h),u="";if("Hmac"==s.substr(0,4)){if(void 0===d)throw"mac key shall be specified for HS* alg";var v=new p({alg:s,prov:"cryptojs",pass:d});v.updateString(t),u=v.doFinal()}else if(-1!=s.indexOf("withECDSA")){var w=new q({alg:s});w.init(d,e),w.updateString(t);var x=w.sign();u=m.crypto.ECDSA.asn1SigToConcatSig(x)}else if("none"!=s){var w=new q({alg:s});w.init(d,e),w.updateString(t),u=w.sign()}return t+"."+bf(u)},m.jws.JWS.verify=function(a,b,c){var d=m,e=d.jws.JWS,f=e.readSafeJSONString,g=d.crypto,h=g.ECDSA,i=g.Mac,j=g.Signature;if(!bD(a))return!1;var k=a.split(".");if(3!==k.length)return!1;var l=k[0]+"."+k[1],n=bg(k[2]),p=f(o(k[0])),q=null,r=null;if(void 0===p.alg)throw"algorithm not specified in header";if(r=(q=p.alg).substr(0,2),null!=c&&"[object Array]"===Object.prototype.toString.call(c)&&c.length>0&&-1==(":"+c.join(":")+":").indexOf(":"+q+":"))throw"algorithm '"+q+"' not accepted in the list";if("none"!=q&&null===b)throw"key shall be specified to verify.";if("string"==typeof b&&-1!=b.indexOf("-----BEGIN ")&&(b=bQ.getKey(b)),("RS"==r||"PS"==r)&&!(b instanceof a3))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==r&&!(b instanceof h))throw"key shall be a ECDSA obj for ES* algs";var s=null;if(void 0===e.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+q;if("none"==(s=e.jwsalg2sigalg[q]))throw"not supported";if("Hmac"==s.substr(0,4)){if(void 0===b)throw"hexadecimal key shall be specified for HMAC";var t=new i({alg:s,pass:b});return t.updateString(l),n==t.doFinal()}if(-1!=s.indexOf("withECDSA")){var u=null;try{u=h.concatSigToASN1Sig(n)}catch(a){return!1}var v=new j({alg:s});return v.init(b),v.updateString(l),v.verify(u)}var v=new j({alg:s});return v.init(b),v.updateString(l),v.verify(n)},m.jws.JWS.parse=function(a){var b,c,d,e=a.split("."),f={};if(2!=e.length&&3!=e.length)throw"malformed sJWS: wrong number of '.' splitted elements";return b=e[0],c=e[1],3==e.length&&(d=e[2]),f.headerObj=m.jws.JWS.readSafeJSONString(o(b)),f.payloadObj=m.jws.JWS.readSafeJSONString(o(c)),f.headerPP=JSON.stringify(f.headerObj,null,"  "),null==f.payloadObj?f.payloadPP=o(c):f.payloadPP=JSON.stringify(f.payloadObj,null,"  "),void 0!==d&&(f.sigHex=bg(d)),f},m.jws.JWS.verifyJWT=function(a,b,c){var d=m.jws,e=d.JWS,f=e.readSafeJSONString,g=e.inArray,h=e.includedArray;if(!bD(a))return!1;var i=a.split(".");if(3!=i.length)return!1;var j=i[0],k=i[1];bg(i[2]);var l=f(o(j)),n=f(o(k));if(void 0===l.alg)return!1;if(void 0===c.alg)throw"acceptField.alg shall be specified";if(!g(l.alg,c.alg)||void 0!==n.iss&&"object"==typeof c.iss&&!g(n.iss,c.iss)||void 0!==n.sub&&"object"==typeof c.sub&&!g(n.sub,c.sub))return!1;if(void 0!==n.aud&&"object"==typeof c.aud){if("string"==typeof n.aud){if(!g(n.aud,c.aud))return!1}else if("object"==typeof n.aud&&!h(n.aud,c.aud))return!1}var p=d.IntDate.getNow();return void 0!==c.verifyAt&&"number"==typeof c.verifyAt&&(p=c.verifyAt),(void 0===c.gracePeriod||"number"!=typeof c.gracePeriod)&&(c.gracePeriod=0),(void 0===n.exp||"number"!=typeof n.exp||!(n.exp+c.gracePeriod<p))&&(void 0===n.nbf||"number"!=typeof n.nbf||!(p<n.nbf-c.gracePeriod))&&(void 0===n.iat||"number"!=typeof n.iat||!(p<n.iat-c.gracePeriod))&&(void 0===n.jti||void 0===c.jti||n.jti===c.jti)&&!!e.verify(a,b,c.alg)&&!0},m.jws.JWS.includedArray=function(a,b){var c=m.jws.JWS.inArray;if(null===a||"object"!=typeof a||"number"!=typeof a.length)return!1;for(var d=0;d<a.length;d++)if(!c(a[d],b))return!1;return!0},m.jws.JWS.inArray=function(a,b){if(null===b||"object"!=typeof b||"number"!=typeof b.length)return!1;for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1},m.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},m.jws.JWS.isSafeJSONString=function(a,b,c){var d=null;try{if(d=a7(a),"object"!=typeof d||d.constructor===Array)return 0;return b&&(b[c]=d),1}catch(a){return 0}},m.jws.JWS.readSafeJSONString=function(a){var b=null;try{if(b=a7(a),"object"!=typeof b||b.constructor===Array)return null;return b}catch(a){return null}},m.jws.JWS.getEncodedSignatureValueFromJWS=function(a){var b=a.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==b)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return b[1]},m.jws.JWS.getJWKthumbprint=function(a){if("RSA"!==a.kty&&"EC"!==a.kty&&"oct"!==a.kty)throw"unsupported algorithm for JWK Thumprint";var b="{";if("RSA"===a.kty){if("string"!=typeof a.n||"string"!=typeof a.e)throw"wrong n and e value for RSA key";b+='"e":"'+a.e+'",'+('"kty":"'+a.kty)+'",'+('"n":"'+a.n)+'"}'}else if("EC"===a.kty){if("string"!=typeof a.crv||"string"!=typeof a.x||"string"!=typeof a.y)throw"wrong crv, x and y value for EC key";b+='"crv":"'+a.crv+'",'+('"kty":"'+a.kty)+'",'+('"x":"'+a.x)+'",'+('"y":"'+a.y)+'"}'}else if("oct"===a.kty){if("string"!=typeof a.k)throw"wrong k value for oct(symmetric) key";b+='"kty":"'+a.kty+'",'+('"k":"'+a.k)+'"}'}var c=bk(b);return bf(m.crypto.Util.hashHex(c,"sha256"))},m.jws.IntDate={},m.jws.IntDate.get=function(a){var b=m.jws.IntDate,c=b.getNow,d=b.getZulu;if("now"==a)return c();if("now + 1hour"==a)return c()+3600;if("now + 1day"==a)return c()+86400;if("now + 1month"==a)return c()+2592e3;if("now + 1year"==a)return c()+31536e3;else if(a.match(/Z$/))return d(a);else if(a.match(/^[0-9]+$/))return parseInt(a);throw"unsupported format: "+a},m.jws.IntDate.getZulu=function(a){return bq(a)},m.jws.IntDate.getNow=function(){return~~(new Date/1e3)},m.jws.IntDate.intDate2UTCString=function(a){return new Date(1e3*a).toUTCString()},m.jws.IntDate.intDate2Zulu=function(a){var b=new Date(1e3*a);return("0000"+b.getUTCFullYear()).slice(-4)+("00"+(b.getUTCMonth()+1)).slice(-2)+("00"+b.getUTCDate()).slice(-2)+("00"+b.getUTCHours()).slice(-2)+("00"+b.getUTCMinutes()).slice(-2)+("00"+b.getUTCSeconds()).slice(-2)+"Z"},void 0!==m&&m||(m={}),void 0!==m.jws&&m.jws||(m.jws={}),m.jws.JWSJS=function(){var a=m.jws.JWS,b=a.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(a){this.init();var b=a.split(".");if(3!=b.length)throw"malformed input JWS";this.aHeader.push(b[0]),this.sPayload=b[1],this.aSignature.push(b[2])},this.addSignature=function(a,b,c,d){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var e=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var f=m.jws.JWS.sign(a,b,this.sPayload,c,d).split(".");f[0],f[2],this.aHeader.push(f[0]),this.aSignature.push(f[2])}catch(a){throw this.aHeader.length>e&&this.aHeader.pop(),this.aSignature.length>e&&this.aSignature.pop(),"addSignature failed: "+a}},this.verifyAll=function(a){if(this.aHeader.length!==a.length||this.aSignature.length!==a.length)return!1;for(var b=0;b<a.length;b++){var c=a[b];if(2!==c.length||!1===this.verifyNth(b,c[0],c[1]))return!1}return!0},this.verifyNth=function(b,c,d){if(this.aHeader.length<=b||this.aSignature.length<=b)return!1;var e=this.aHeader[b],f=this.aSignature[b],g=e+"."+this.sPayload+"."+f,h=!1;try{h=a.verify(g,c,d)}catch(a){return!1}return h},this.readJWSJS=function(a){if("string"==typeof a){var c=b(a);if(null==c)throw"argument is not safe JSON object string";this.aHeader=c.headers,this.sPayload=c.payload,this.aSignature=c.signatures}else try{if(a.headers.length>0)this.aHeader=a.headers;else throw"malformed header";if("string"==typeof a.payload)this.sPayload=a.payload;else throw"malformed signatures";if(a.signatures.length>0)this.aSignature=a.signatures;else throw"malformed signatures"}catch(a){throw"malformed JWS-JS JSON object: "+a}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return+(0==this.aHeader.length)}},c.SecureRandom=a1,c.rng_seed_time=P,c.BigInteger=w,c.RSAKey=a3,c.ECDSA=m.crypto.ECDSA,c.DSA=m.crypto.DSA,c.Signature=m.crypto.Signature,c.MessageDigest=m.crypto.MessageDigest,c.Mac=m.crypto.Mac,c.KEYUTIL=bQ,c.ASN1HEX=a8,c.X509=bU,c.X509CRL=function(a){var b=m.lang.String.isHex,c=a8.getV,d=a8.getTLV,e=a8.getVbyList,f=a8.getTLVbyList,g=a8.getTLVbyListEx,h=a8.getIdxbyList,i=a8.getIdxbyListEx,j=a8.getChildIdx,k=new bU;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var a,b=h(this.hex,0,[0,0]),c=this.hex.substr(b,2);if("02"==c)this.posSigAlg=1;else if("30"==c)this.posSigAlg=0;else throw Error("malformed 1st item of TBSCertList: "+c);var d=h(this.hex,0,[0,this.posSigAlg+3]),e=this.hex.substr(d,2);if("17"==e||"18"==e)a=h(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,-1!=a&&"30"==this.hex.substr(a,2)&&(this.posRevCert=this.posSigAlg+4);else if("30"==e)this.posRevCert=this.posSigAlg+3;else if("a0"==e)this.posRevCert=null;else throw Error("malformed nextUpdate or revCert tag: "+e)},this.getVersion=function(){return 0==this.posSigAlg?null:parseInt(e(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var a=f(this.hex,0,[0,this.posSigAlg],"30");return k.getAlgorithmIdentifierName(a)},this.getIssuer=function(){return k.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return f(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){return result=bj(e(this.hex,0,[0,this.posSigAlg+2]))},this.getNextUpdate=function(){var a=h(this.hex,0,[0,this.posSigAlg+3]),b=this.hex.substr(a,2);return"17"!=b&&"18"!=b?null:bj(c(this.hex,a))},this.getRevCertArray=function(){if(null==this.posRevCert)return null;for(var a=[],b=h(this.hex,0,[0,this.posRevCert]),c=j(this.hex,b),e=0;e<c.length;e++){var f=d(this.hex,c[e]);a.push(this.getRevCert(f))}return a},this.getRevCert=function(a){var b={},c=j(a,0);return b.sn={hex:e(a,0,[0],"02")},b.date=bj(e(a,0,[1])),3==c.length&&(b.ext=k.getExtParamArray(f(a,0,[2]))),b},this.findRevCert=function(a){var b=new bU(a).getSerialNumberHex();return this.findRevCertBySN(b)},this.findRevCertBySN=function(a){if(null==this.parsed&&this.getParam(),null==this.parsed.revcert)return null;for(var b=this.parsed.revcert,c=0;c<b.length;c++)if(a==b[c].sn.hex)return b[c];return null},this.getSignatureValueHex=function(){return e(this.hex,0,[2],"03",!0)},this.verifySignature=function(a){var b=this.getSignatureAlgorithmField(),c=this.getSignatureValueHex(),d=f(this.hex,0,[0],"30"),e=new m.crypto.Signature({alg:b});return e.init(a),e.updateHex(d),e.verify(c)},this.getParam=function(a){var b={},c=this.getVersion();null!=c&&(b.version=c),b.sigalg=this.getSignatureAlgorithmField(),b.issuer=this.getIssuer(),b.thisupdate=this.getThisUpdate();var d=this.getNextUpdate();null!=d&&(b.nextupdate=d);var e=this.getRevCertArray();if(null!=e&&(b.revcert=e),-1!=i(this.hex,0,[0,"[0]"])){var h=g(this.hex,0,[0,"[0]",0]);b.ext=k.getExtParamArray(h)}return b.sighex=this.getSignatureValueHex(),this.parsed=b,"object"==typeof a&&(!0==a.tbshex&&(b.tbshex=f(this.hex,0,[0])),!0==a.nodnarray&&delete b.issuer.array),b},"string"==typeof a&&(b(a)?this.hex=a:a.match(/-----BEGIN X509 CRL/)&&(this.hex=bo(a)),this._setPos())},c.CryptoJS=r,c.b64tohex=u,c.b64toBA=v,c.ECFieldElementFp=a4,c.ECPointFp=a5,c.ECCurveFp=a6,c.stoBA=a9,c.BAtos=ba,c.BAtohex=bb,c.stohex=bc,c.stob64=function(a){return t(bc(a))},c.stob64u=function(a){return bd(t(bc(a)))},c.b64utos=function(a){return ba(v(be(a)))},c.b64tob64u=bd,c.b64utob64=be,c.hex2b64=t,c.hextob64u=bf,c.b64utohex=bg,c.utf8tob64u=n,c.b64utoutf8=o,c.utf8tob64=function(a){return t(bs(bB(a)))},c.b64toutf8=function(a){return decodeURIComponent(bt(u(a)))},c.utf8tohex=bh,c.hextoutf8=bi,c.hextorstr=bj,c.rstrtohex=bk,c.hextob64=function(a){return t(a)},c.hextob64nl=function(a){return bl(t(a),64)},c.b64nltohex=bm,c.hextopem=bn,c.pemtohex=bo,c.hextoArrayBuffer=function(a){if(a.length%2!=0)throw"input is not even length";if(null==a.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var b=new ArrayBuffer(a.length/2),c=new DataView(b),d=0;d<a.length/2;d++)c.setUint8(d,parseInt(a.substr(2*d,2),16));return b},c.ArrayBuffertohex=function(a){for(var b="",c=new DataView(a),d=0;d<a.byteLength;d++)b+=("00"+c.getUint8(d).toString(16)).slice(-2);return b},c.zulutomsec=bp,c.msectozulu=function(a){var b=new Date(a),c=("0000"+b.getUTCFullYear()).slice(-4),d=("00"+(b.getUTCMonth()+1)).slice(-2),e=("00"+b.getUTCDate()).slice(-2),f=("00"+b.getUTCHours()).slice(-2),g=("00"+b.getUTCMinutes()).slice(-2),h=("00"+b.getUTCSeconds()).slice(-2),i=("000"+b.getUTCMilliseconds()).slice(-3);return c+d+e+f+g+h+(i=""!=(i=i.replace(/0+$/,""))?"."+i:i)+"Z"},c.zulutosec=bq,c.zulutodate=function(a){return new Date(bp(a))},c.datetozulu=function(a,b,c){var d,e=a.getUTCFullYear();if(b){if(e<1950||2049<e)throw"not proper year for UTCTime: "+e;d=(""+e).slice(-2)}else d=("000"+e).slice(-4);if(d+=("0"+(a.getUTCMonth()+1)).slice(-2),d+=("0"+a.getUTCDate()).slice(-2),d+=("0"+a.getUTCHours()).slice(-2),d+=("0"+a.getUTCMinutes()).slice(-2),d+=("0"+a.getUTCSeconds()).slice(-2),c){var f=a.getUTCMilliseconds();0!==f&&(d+="."+(f=(f=("00"+f).slice(-3)).replace(/0+$/g,"")))}return d+"Z"},c.uricmptohex=bs,c.hextouricmp=bt,c.ipv6tohex=bu,c.hextoipv6=bv,c.hextoip=bw,c.iptohex=by,c.ucs2hextoutf8=bA,c.encodeURIComponentAll=bB,c.newline_toUnix=function(a){return a.replace(/\r\n/mg,"\n")},c.newline_toDos=function(a){return(a=a.replace(/\r\n/mg,"\n")).replace(/\n/mg,"\r\n")},c.hextoposhex=bE,c.intarystrtohex=function(a){a=(a=(a=a.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return a.split(/,/).map(function(a,b,c){var d=parseInt(a);if(d<0||255<d)throw"integer not in range 0-255";return("00"+d.toString(16)).slice(-2)}).join("")}catch(a){throw"malformed integer array string: "+a}},c.strdiffidx=function(a,b){var c=a.length;a.length>b.length&&(c=b.length);for(var d=0;d<c;d++)if(a.charCodeAt(d)!=b.charCodeAt(d))return d;return a.length!=b.length?c:-1},c.oidtohex=bF,c.hextooid=bG,c.strpad=bJ,c.bitstrtoint=bK,c.inttobitstr=bL,c.bitstrtobinstr=bM,c.binstrtobitstr=function(a){if("string"!=typeof a||null==a.match(/^[01]+$/))return null;try{var b=parseInt(a,2);return bL(b)}catch(a){return null}},c.isBase64URLDot=bD,c.namearraytobinstr=bN,c.extendClass=bP,c.foldnl=bl,c.b64topem=function(a,b){return"-----BEGIN "+b+"-----\r\n"+bl(a,64)+"\r\n-----END "+b+"-----\r\n"},c.pemtob64=function(a){return -1==a.indexOf("-----BEGIN ")||-1==a.indexOf("-----END ")?null:(a=(a=(a=a.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,"")).replace(/-----END [\s\S]+$/m,"")).replace(/\s+/g,"")).match(/^[0-9a-zA-Z+/=]+$/)?a:null},c.timeogen=br,c.aryval=bO,c.inttohex=bH,c.twoscompl=bI,c.KJUR=m,c.crypto=m.crypto,c.asn1=m.asn1,c.jws=m.jws,c.lang=m.lang,c.VERSION="11.1.0",c.VERSION_FULL="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license"},7565,a=>{"use strict";a.s(["createBlob",()=>r,"createCommit",()=>n,"createInstallationToken",()=>i,"createTree",()=>m,"getInstallationId",()=>h,"getRef",()=>l,"listRepoFilesRecursive",()=>q,"putFile",()=>k,"readTextFileFromRepo",()=>p,"signAppJwt",()=>g,"toBase64Utf8",()=>f,"updateRef",()=>o]);var b=a.i(47507),c=a.i(8364);let d="https://api.github.com";function e(){if("undefined"!=typeof sessionStorage)try{b.useAuthStore.getState().clearAuth()}catch(a){console.error("Failed to clear auth cache:",a)}}function f(a){return btoa(unescape(encodeURIComponent(a)))}function g(a,b){let d=Math.floor(Date.now()/1e3),e=c.KEYUTIL.getKey(b);return c.KJUR.jws.JWS.sign("RS256",JSON.stringify({alg:"RS256",typ:"JWT"}),JSON.stringify({iat:d-60,exp:d+480,iss:a}),e)}async function h(a,b,c){let f=await fetch(`${d}/repos/${b}/${c}/installation`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===f.status&&e(),!f.ok)throw Error(`installation lookup failed: ${f.status}`);return(await f.json()).id}async function i(a,b){let c=await fetch(`${d}/app/installations/${b}/access_tokens`,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===c.status&&e(),!c.ok)throw Error(`create token failed: ${c.status}`);return(await c.json()).token}async function j(a,b,c,f,g){let h=await fetch(`${d}/repos/${b}/${c}/contents/${encodeURIComponent(f)}?ref=${encodeURIComponent(g)}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===h.status&&e(),404===h.status)return;if(!h.ok)throw Error(`get file sha failed: ${h.status}`);let i=await h.json();return i&&i.sha||void 0}async function k(a,b,c,f,g,h,i){let k=await j(a,b,c,f,i),l=await fetch(`${d}/repos/${b}/${c}/contents/${encodeURIComponent(f)}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:JSON.stringify({message:h,content:g,branch:i,...k?{sha:k}:{}})});if(401===l.status&&e(),!l.ok)throw Error(`put file failed: ${l.status}`);return l.json()}async function l(a,b,c,f){let g=await fetch(`${d}/repos/${b}/${c}/git/ref/${encodeURIComponent(f)}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===g.status&&e(),!g.ok)throw Error(`get ref failed: ${g.status}`);return{sha:(await g.json()).object.sha}}async function m(a,b,c,f,g){let h=await fetch(`${d}/repos/${b}/${c}/git/trees`,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:JSON.stringify({tree:f,base_tree:g})});if(401===h.status&&e(),!h.ok)throw Error(`create tree failed: ${h.status}`);return{sha:(await h.json()).sha}}async function n(a,b,c,f,g,h){let i=await fetch(`${d}/repos/${b}/${c}/git/commits`,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:JSON.stringify({message:f,tree:g,parents:h})});if(401===i.status&&e(),!i.ok)throw Error(`create commit failed: ${i.status}`);return{sha:(await i.json()).sha}}async function o(a,b,c,f,g,h=!1){let i=await fetch(`${d}/repos/${b}/${c}/git/refs/${encodeURIComponent(f)}`,{method:"PATCH",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:JSON.stringify({sha:g,force:h})});if(401===i.status&&e(),!i.ok)throw Error(`update ref failed: ${i.status}`)}async function p(a,b,c,f,g){let h=await fetch(`${d}/repos/${b}/${c}/contents/${encodeURIComponent(f)}?ref=${encodeURIComponent(g)}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===h.status&&e(),404===h.status)return null;if(!h.ok)throw Error(`read file failed: ${h.status}`);let i=await h.json();if(Array.isArray(i)||!i.content)return null;try{return decodeURIComponent(escape(atob(i.content)))}catch{return atob(i.content)}}async function q(a,b,c,f,g){async function h(f){let i=await fetch(`${d}/repos/${b}/${c}/contents/${encodeURIComponent(f)}?ref=${encodeURIComponent(g)}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}});if(401===i.status&&e(),404===i.status)return[];if(!i.ok)throw Error(`read directory failed: ${i.status}`);let j=await i.json();if(Array.isArray(j)){let a=[];for(let b of j)if("file"===b.type)a.push(b.path);else if("dir"===b.type){let c=await h(b.path);a.push(...c)}return a}return j?.type==="file"?[j.path]:j?.type==="dir"?h(j.path):[]}return h(f)}async function r(a,b,c,f,g="base64"){let h=await fetch(`${d}/repos/${b}/${c}/git/blobs`,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28","Content-Type":"application/json"},body:JSON.stringify({content:f,encoding:g})});if(401===h.status&&e(),!h.ok)throw Error(`create blob failed: ${h.status}`);return{sha:(await h.json()).sha}}}];

//# sourceMappingURL=_771c667a._.js.map